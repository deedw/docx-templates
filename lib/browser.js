var commonjsGlobal=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},buffer$1={},base64Js={};base64Js.byteLength=byteLength,base64Js.toByteArray=toByteArray,base64Js.fromByteArray=fromByteArray;for(var lookup=[],revLookup=[],Arr=typeof Uint8Array!="undefined"?Uint8Array:Array,code="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i$2=0,len=code.length;i$2<len;++i$2)lookup[i$2]=code[i$2],revLookup[code.charCodeAt(i$2)]=i$2;revLookup[45]=62,revLookup[95]=63;function getLens(t){var E=t.length;if(E%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=E);var v=r===E?0:4-r%4;return[r,v]}function byteLength(t){var E=getLens(t),r=E[0],v=E[1];return(r+v)*3/4-v}function _byteLength(t,E,r){return(E+r)*3/4-r}function toByteArray(t){var E,r=getLens(t),v=r[0],T=r[1],N=new Arr(_byteLength(t,v,T)),k=0,x=T>0?v-4:v,ce;for(ce=0;ce<x;ce+=4)E=revLookup[t.charCodeAt(ce)]<<18|revLookup[t.charCodeAt(ce+1)]<<12|revLookup[t.charCodeAt(ce+2)]<<6|revLookup[t.charCodeAt(ce+3)],N[k++]=E>>16&255,N[k++]=E>>8&255,N[k++]=E&255;return T===2&&(E=revLookup[t.charCodeAt(ce)]<<2|revLookup[t.charCodeAt(ce+1)]>>4,N[k++]=E&255),T===1&&(E=revLookup[t.charCodeAt(ce)]<<10|revLookup[t.charCodeAt(ce+1)]<<4|revLookup[t.charCodeAt(ce+2)]>>2,N[k++]=E>>8&255,N[k++]=E&255),N}function tripletToBase64(t){return lookup[t>>18&63]+lookup[t>>12&63]+lookup[t>>6&63]+lookup[t&63]}function encodeChunk(t,E,r){for(var v,T=[],N=E;N<r;N+=3)v=(t[N]<<16&16711680)+(t[N+1]<<8&65280)+(t[N+2]&255),T.push(tripletToBase64(v));return T.join("")}function fromByteArray(t){for(var E,r=t.length,v=r%3,T=[],N=16383,k=0,x=r-v;k<x;k+=N)T.push(encodeChunk(t,k,k+N>x?x:k+N));return v===1?(E=t[r-1],T.push(lookup[E>>2]+lookup[E<<4&63]+"==")):v===2&&(E=(t[r-2]<<8)+t[r-1],T.push(lookup[E>>10]+lookup[E>>4&63]+lookup[E<<2&63]+"=")),T.join("")}var ieee754={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */ieee754.read=function(t,E,r,v,T){var N,k,x=T*8-v-1,ce=(1<<x)-1,ue=ce>>1,Z=-7,$e=r?T-1:0,Ee=r?-1:1,ge=t[E+$e];for($e+=Ee,N=ge&(1<<-Z)-1,ge>>=-Z,Z+=x;Z>0;N=N*256+t[E+$e],$e+=Ee,Z-=8);for(k=N&(1<<-Z)-1,N>>=-Z,Z+=v;Z>0;k=k*256+t[E+$e],$e+=Ee,Z-=8);if(N===0)N=1-ue;else{if(N===ce)return k?NaN:(ge?-1:1)*(1/0);k=k+Math.pow(2,v),N=N-ue}return(ge?-1:1)*k*Math.pow(2,N-v)},ieee754.write=function(t,E,r,v,T,N){var k,x,ce,ue=N*8-T-1,Z=(1<<ue)-1,$e=Z>>1,Ee=T===23?Math.pow(2,-24)-Math.pow(2,-77):0,ge=v?0:N-1,ye=v?1:-1,Te=E<0||E===0&&1/E<0?1:0;for(E=Math.abs(E),isNaN(E)||E===1/0?(x=isNaN(E)?1:0,k=Z):(k=Math.floor(Math.log(E)/Math.LN2),E*(ce=Math.pow(2,-k))<1&&(k--,ce*=2),k+$e>=1?E+=Ee/ce:E+=Ee*Math.pow(2,1-$e),E*ce>=2&&(k++,ce/=2),k+$e>=Z?(x=0,k=Z):k+$e>=1?(x=(E*ce-1)*Math.pow(2,T),k=k+$e):(x=E*Math.pow(2,$e-1)*Math.pow(2,T),k=0));T>=8;t[r+ge]=x&255,ge+=ye,x/=256,T-=8);for(k=k<<T|x,ue+=T;ue>0;t[r+ge]=k&255,ge+=ye,k/=256,ue-=8);t[r+ge-ye]|=Te*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(t){const E=base64Js,r=ieee754,v=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=x,t.SlowBuffer=Ae,t.INSPECT_MAX_BYTES=50;const T=2147483647;t.kMaxLength=T,x.TYPED_ARRAY_SUPPORT=N(),!x.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function N(){try{const M=new Uint8Array(1),y={foo:function(){return 42}};return Object.setPrototypeOf(y,Uint8Array.prototype),Object.setPrototypeOf(M,y),M.foo()===42}catch(M){return!1}}Object.defineProperty(x.prototype,"parent",{enumerable:!0,get:function(){if(x.isBuffer(this))return this.buffer}}),Object.defineProperty(x.prototype,"offset",{enumerable:!0,get:function(){if(x.isBuffer(this))return this.byteOffset}});function k(M){if(M>T)throw new RangeError('The value "'+M+'" is invalid for option "size"');const y=new Uint8Array(M);return Object.setPrototypeOf(y,x.prototype),y}function x(M,y,I){if(typeof M=="number"){if(typeof y=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return $e(M)}return ce(M,y,I)}x.poolSize=8192;function ce(M,y,I){if(typeof M=="string")return Ee(M,y);if(ArrayBuffer.isView(M))return ye(M);if(M==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof M);if(it(M,ArrayBuffer)||M&&it(M.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(it(M,SharedArrayBuffer)||M&&it(M.buffer,SharedArrayBuffer)))return Te(M,y,I);if(typeof M=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const _e=M.valueOf&&M.valueOf();if(_e!=null&&_e!==M)return x.from(_e,y,I);const we=Se(M);if(we)return we;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof M[Symbol.toPrimitive]=="function")return x.from(M[Symbol.toPrimitive]("string"),y,I);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof M)}x.from=function(M,y,I){return ce(M,y,I)},Object.setPrototypeOf(x.prototype,Uint8Array.prototype),Object.setPrototypeOf(x,Uint8Array);function ue(M){if(typeof M!="number")throw new TypeError('"size" argument must be of type number');if(M<0)throw new RangeError('The value "'+M+'" is invalid for option "size"')}function Z(M,y,I){return ue(M),M<=0?k(M):y!==void 0?typeof I=="string"?k(M).fill(y,I):k(M).fill(y):k(M)}x.alloc=function(M,y,I){return Z(M,y,I)};function $e(M){return ue(M),k(M<0?0:Ie(M)|0)}x.allocUnsafe=function(M){return $e(M)},x.allocUnsafeSlow=function(M){return $e(M)};function Ee(M,y){if((typeof y!="string"||y==="")&&(y="utf8"),!x.isEncoding(y))throw new TypeError("Unknown encoding: "+y);const I=Re(M,y)|0;let _e=k(I);const we=_e.write(M,y);return we!==I&&(_e=_e.slice(0,we)),_e}function ge(M){const y=M.length<0?0:Ie(M.length)|0,I=k(y);for(let _e=0;_e<y;_e+=1)I[_e]=M[_e]&255;return I}function ye(M){if(it(M,Uint8Array)){const y=new Uint8Array(M);return Te(y.buffer,y.byteOffset,y.byteLength)}return ge(M)}function Te(M,y,I){if(y<0||M.byteLength<y)throw new RangeError('"offset" is outside of buffer bounds');if(M.byteLength<y+(I||0))throw new RangeError('"length" is outside of buffer bounds');let _e;return y===void 0&&I===void 0?_e=new Uint8Array(M):I===void 0?_e=new Uint8Array(M,y):_e=new Uint8Array(M,y,I),Object.setPrototypeOf(_e,x.prototype),_e}function Se(M){if(x.isBuffer(M)){const y=Ie(M.length)|0,I=k(y);return I.length===0||M.copy(I,0,0,y),I}if(M.length!==void 0)return typeof M.length!="number"||Et(M.length)?k(0):ge(M);if(M.type==="Buffer"&&Array.isArray(M.data))return ge(M.data)}function Ie(M){if(M>=T)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+T.toString(16)+" bytes");return M|0}function Ae(M){return+M!=M&&(M=0),x.alloc(+M)}x.isBuffer=function(y){return y!=null&&y._isBuffer===!0&&y!==x.prototype},x.compare=function(y,I){if(it(y,Uint8Array)&&(y=x.from(y,y.offset,y.byteLength)),it(I,Uint8Array)&&(I=x.from(I,I.offset,I.byteLength)),!x.isBuffer(y)||!x.isBuffer(I))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(y===I)return 0;let _e=y.length,we=I.length;for(let be=0,Ne=Math.min(_e,we);be<Ne;++be)if(y[be]!==I[be]){_e=y[be],we=I[be];break}return _e<we?-1:we<_e?1:0},x.isEncoding=function(y){switch(String(y).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},x.concat=function(y,I){if(!Array.isArray(y))throw new TypeError('"list" argument must be an Array of Buffers');if(y.length===0)return x.alloc(0);let _e;if(I===void 0)for(I=0,_e=0;_e<y.length;++_e)I+=y[_e].length;const we=x.allocUnsafe(I);let be=0;for(_e=0;_e<y.length;++_e){let Ne=y[_e];if(it(Ne,Uint8Array))be+Ne.length>we.length?(x.isBuffer(Ne)||(Ne=x.from(Ne)),Ne.copy(we,be)):Uint8Array.prototype.set.call(we,Ne,be);else if(x.isBuffer(Ne))Ne.copy(we,be);else throw new TypeError('"list" argument must be an Array of Buffers');be+=Ne.length}return we};function Re(M,y){if(x.isBuffer(M))return M.length;if(ArrayBuffer.isView(M)||it(M,ArrayBuffer))return M.byteLength;if(typeof M!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof M);const I=M.length,_e=arguments.length>2&&arguments[2]===!0;if(!_e&&I===0)return 0;let we=!1;for(;;)switch(y){case"ascii":case"latin1":case"binary":return I;case"utf8":case"utf-8":return Ve(M).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I*2;case"hex":return I>>>1;case"base64":return pt(M).length;default:if(we)return _e?-1:Ve(M).length;y=(""+y).toLowerCase(),we=!0}}x.byteLength=Re;function ke(M,y,I){let _e=!1;if((y===void 0||y<0)&&(y=0),y>this.length||((I===void 0||I>this.length)&&(I=this.length),I<=0)||(I>>>=0,y>>>=0,I<=y))return"";for(M||(M="utf8");;)switch(M){case"hex":return ut(this,y,I);case"utf8":case"utf-8":return et(this,y,I);case"ascii":return Ue(this,y,I);case"latin1":case"binary":return at(this,y,I);case"base64":return Je(this,y,I);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ct(this,y,I);default:if(_e)throw new TypeError("Unknown encoding: "+M);M=(M+"").toLowerCase(),_e=!0}}x.prototype._isBuffer=!0;function De(M,y,I){const _e=M[y];M[y]=M[I],M[I]=_e}x.prototype.swap16=function(){const y=this.length;if(y%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let I=0;I<y;I+=2)De(this,I,I+1);return this},x.prototype.swap32=function(){const y=this.length;if(y%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let I=0;I<y;I+=4)De(this,I,I+3),De(this,I+1,I+2);return this},x.prototype.swap64=function(){const y=this.length;if(y%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let I=0;I<y;I+=8)De(this,I,I+7),De(this,I+1,I+6),De(this,I+2,I+5),De(this,I+3,I+4);return this},x.prototype.toString=function(){const y=this.length;return y===0?"":arguments.length===0?et(this,0,y):ke.apply(this,arguments)},x.prototype.toLocaleString=x.prototype.toString,x.prototype.equals=function(y){if(!x.isBuffer(y))throw new TypeError("Argument must be a Buffer");return this===y?!0:x.compare(this,y)===0},x.prototype.inspect=function(){let y="";const I=t.INSPECT_MAX_BYTES;return y=this.toString("hex",0,I).replace(/(.{2})/g,"$1 ").trim(),this.length>I&&(y+=" ... "),"<Buffer "+y+">"},v&&(x.prototype[v]=x.prototype.inspect),x.prototype.compare=function(y,I,_e,we,be){if(it(y,Uint8Array)&&(y=x.from(y,y.offset,y.byteLength)),!x.isBuffer(y))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof y);if(I===void 0&&(I=0),_e===void 0&&(_e=y?y.length:0),we===void 0&&(we=0),be===void 0&&(be=this.length),I<0||_e>y.length||we<0||be>this.length)throw new RangeError("out of range index");if(we>=be&&I>=_e)return 0;if(we>=be)return-1;if(I>=_e)return 1;if(I>>>=0,_e>>>=0,we>>>=0,be>>>=0,this===y)return 0;let Ne=be-we,Pe=_e-I;const Xe=Math.min(Ne,Pe),Ge=this.slice(we,be),Ke=y.slice(I,_e);for(let He=0;He<Xe;++He)if(Ge[He]!==Ke[He]){Ne=Ge[He],Pe=Ke[He];break}return Ne<Pe?-1:Pe<Ne?1:0};function Le(M,y,I,_e,we){if(M.length===0)return-1;if(typeof I=="string"?(_e=I,I=0):I>2147483647?I=2147483647:I<-2147483648&&(I=-2147483648),I=+I,Et(I)&&(I=we?0:M.length-1),I<0&&(I=M.length+I),I>=M.length){if(we)return-1;I=M.length-1}else if(I<0)if(we)I=0;else return-1;if(typeof y=="string"&&(y=x.from(y,_e)),x.isBuffer(y))return y.length===0?-1:Be(M,y,I,_e,we);if(typeof y=="number")return y=y&255,typeof Uint8Array.prototype.indexOf=="function"?we?Uint8Array.prototype.indexOf.call(M,y,I):Uint8Array.prototype.lastIndexOf.call(M,y,I):Be(M,[y],I,_e,we);throw new TypeError("val must be string, number or Buffer")}function Be(M,y,I,_e,we){let be=1,Ne=M.length,Pe=y.length;if(_e!==void 0&&(_e=String(_e).toLowerCase(),_e==="ucs2"||_e==="ucs-2"||_e==="utf16le"||_e==="utf-16le")){if(M.length<2||y.length<2)return-1;be=2,Ne/=2,Pe/=2,I/=2}function Xe(Ke,He){return be===1?Ke[He]:Ke.readUInt16BE(He*be)}let Ge;if(we){let Ke=-1;for(Ge=I;Ge<Ne;Ge++)if(Xe(M,Ge)===Xe(y,Ke===-1?0:Ge-Ke)){if(Ke===-1&&(Ke=Ge),Ge-Ke+1===Pe)return Ke*be}else Ke!==-1&&(Ge-=Ge-Ke),Ke=-1}else for(I+Pe>Ne&&(I=Ne-Pe),Ge=I;Ge>=0;Ge--){let Ke=!0;for(let He=0;He<Pe;He++)if(Xe(M,Ge+He)!==Xe(y,He)){Ke=!1;break}if(Ke)return Ge}return-1}x.prototype.includes=function(y,I,_e){return this.indexOf(y,I,_e)!==-1},x.prototype.indexOf=function(y,I,_e){return Le(this,y,I,_e,!0)},x.prototype.lastIndexOf=function(y,I,_e){return Le(this,y,I,_e,!1)};function Fe(M,y,I,_e){I=Number(I)||0;const we=M.length-I;_e?(_e=Number(_e),_e>we&&(_e=we)):_e=we;const be=y.length;_e>be/2&&(_e=be/2);let Ne;for(Ne=0;Ne<_e;++Ne){const Pe=parseInt(y.substr(Ne*2,2),16);if(Et(Pe))return Ne;M[I+Ne]=Pe}return Ne}function ve(M,y,I,_e){return lt(Ve(y,M.length-I),M,I,_e)}function Ze(M,y,I,_e){return lt(nt(y),M,I,_e)}function Oe(M,y,I,_e){return lt(pt(y),M,I,_e)}function Me(M,y,I,_e){return lt(gt(y,M.length-I),M,I,_e)}x.prototype.write=function(y,I,_e,we){if(I===void 0)we="utf8",_e=this.length,I=0;else if(_e===void 0&&typeof I=="string")we=I,_e=this.length,I=0;else if(isFinite(I))I=I>>>0,isFinite(_e)?(_e=_e>>>0,we===void 0&&(we="utf8")):(we=_e,_e=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const be=this.length-I;if((_e===void 0||_e>be)&&(_e=be),y.length>0&&(_e<0||I<0)||I>this.length)throw new RangeError("Attempt to write outside buffer bounds");we||(we="utf8");let Ne=!1;for(;;)switch(we){case"hex":return Fe(this,y,I,_e);case"utf8":case"utf-8":return ve(this,y,I,_e);case"ascii":case"latin1":case"binary":return Ze(this,y,I,_e);case"base64":return Oe(this,y,I,_e);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Me(this,y,I,_e);default:if(Ne)throw new TypeError("Unknown encoding: "+we);we=(""+we).toLowerCase(),Ne=!0}},x.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Je(M,y,I){return y===0&&I===M.length?E.fromByteArray(M):E.fromByteArray(M.slice(y,I))}function et(M,y,I){I=Math.min(M.length,I);const _e=[];let we=y;for(;we<I;){const be=M[we];let Ne=null,Pe=be>239?4:be>223?3:be>191?2:1;if(we+Pe<=I){let Xe,Ge,Ke,He;switch(Pe){case 1:be<128&&(Ne=be);break;case 2:Xe=M[we+1],(Xe&192)===128&&(He=(be&31)<<6|Xe&63,He>127&&(Ne=He));break;case 3:Xe=M[we+1],Ge=M[we+2],(Xe&192)===128&&(Ge&192)===128&&(He=(be&15)<<12|(Xe&63)<<6|Ge&63,He>2047&&(He<55296||He>57343)&&(Ne=He));break;case 4:Xe=M[we+1],Ge=M[we+2],Ke=M[we+3],(Xe&192)===128&&(Ge&192)===128&&(Ke&192)===128&&(He=(be&15)<<18|(Xe&63)<<12|(Ge&63)<<6|Ke&63,He>65535&&He<1114112&&(Ne=He))}}Ne===null?(Ne=65533,Pe=1):Ne>65535&&(Ne-=65536,_e.push(Ne>>>10&1023|55296),Ne=56320|Ne&1023),_e.push(Ne),we+=Pe}return ot(_e)}const rt=4096;function ot(M){const y=M.length;if(y<=rt)return String.fromCharCode.apply(String,M);let I="",_e=0;for(;_e<y;)I+=String.fromCharCode.apply(String,M.slice(_e,_e+=rt));return I}function Ue(M,y,I){let _e="";I=Math.min(M.length,I);for(let we=y;we<I;++we)_e+=String.fromCharCode(M[we]&127);return _e}function at(M,y,I){let _e="";I=Math.min(M.length,I);for(let we=y;we<I;++we)_e+=String.fromCharCode(M[we]);return _e}function ut(M,y,I){const _e=M.length;(!y||y<0)&&(y=0),(!I||I<0||I>_e)&&(I=_e);let we="";for(let be=y;be<I;++be)we+=vt[M[be]];return we}function ct(M,y,I){const _e=M.slice(y,I);let we="";for(let be=0;be<_e.length-1;be+=2)we+=String.fromCharCode(_e[be]+_e[be+1]*256);return we}x.prototype.slice=function(y,I){const _e=this.length;y=~~y,I=I===void 0?_e:~~I,y<0?(y+=_e,y<0&&(y=0)):y>_e&&(y=_e),I<0?(I+=_e,I<0&&(I=0)):I>_e&&(I=_e),I<y&&(I=y);const we=this.subarray(y,I);return Object.setPrototypeOf(we,x.prototype),we};function je(M,y,I){if(M%1!==0||M<0)throw new RangeError("offset is not uint");if(M+y>I)throw new RangeError("Trying to access beyond buffer length")}x.prototype.readUintLE=x.prototype.readUIntLE=function(y,I,_e){y=y>>>0,I=I>>>0,_e||je(y,I,this.length);let we=this[y],be=1,Ne=0;for(;++Ne<I&&(be*=256);)we+=this[y+Ne]*be;return we},x.prototype.readUintBE=x.prototype.readUIntBE=function(y,I,_e){y=y>>>0,I=I>>>0,_e||je(y,I,this.length);let we=this[y+--I],be=1;for(;I>0&&(be*=256);)we+=this[y+--I]*be;return we},x.prototype.readUint8=x.prototype.readUInt8=function(y,I){return y=y>>>0,I||je(y,1,this.length),this[y]},x.prototype.readUint16LE=x.prototype.readUInt16LE=function(y,I){return y=y>>>0,I||je(y,2,this.length),this[y]|this[y+1]<<8},x.prototype.readUint16BE=x.prototype.readUInt16BE=function(y,I){return y=y>>>0,I||je(y,2,this.length),this[y]<<8|this[y+1]},x.prototype.readUint32LE=x.prototype.readUInt32LE=function(y,I){return y=y>>>0,I||je(y,4,this.length),(this[y]|this[y+1]<<8|this[y+2]<<16)+this[y+3]*16777216},x.prototype.readUint32BE=x.prototype.readUInt32BE=function(y,I){return y=y>>>0,I||je(y,4,this.length),this[y]*16777216+(this[y+1]<<16|this[y+2]<<8|this[y+3])},x.prototype.readBigUInt64LE=ft(function(y){y=y>>>0,We(y,"offset");const I=this[y],_e=this[y+7];(I===void 0||_e===void 0)&&qe(y,this.length-8);const we=I+this[++y]*2**8+this[++y]*2**16+this[++y]*2**24,be=this[++y]+this[++y]*2**8+this[++y]*2**16+_e*2**24;return BigInt(we)+(BigInt(be)<<BigInt(32))}),x.prototype.readBigUInt64BE=ft(function(y){y=y>>>0,We(y,"offset");const I=this[y],_e=this[y+7];(I===void 0||_e===void 0)&&qe(y,this.length-8);const we=I*2**24+this[++y]*2**16+this[++y]*2**8+this[++y],be=this[++y]*2**24+this[++y]*2**16+this[++y]*2**8+_e;return(BigInt(we)<<BigInt(32))+BigInt(be)}),x.prototype.readIntLE=function(y,I,_e){y=y>>>0,I=I>>>0,_e||je(y,I,this.length);let we=this[y],be=1,Ne=0;for(;++Ne<I&&(be*=256);)we+=this[y+Ne]*be;return be*=128,we>=be&&(we-=Math.pow(2,8*I)),we},x.prototype.readIntBE=function(y,I,_e){y=y>>>0,I=I>>>0,_e||je(y,I,this.length);let we=I,be=1,Ne=this[y+--we];for(;we>0&&(be*=256);)Ne+=this[y+--we]*be;return be*=128,Ne>=be&&(Ne-=Math.pow(2,8*I)),Ne},x.prototype.readInt8=function(y,I){return y=y>>>0,I||je(y,1,this.length),this[y]&128?(255-this[y]+1)*-1:this[y]},x.prototype.readInt16LE=function(y,I){y=y>>>0,I||je(y,2,this.length);const _e=this[y]|this[y+1]<<8;return _e&32768?_e|4294901760:_e},x.prototype.readInt16BE=function(y,I){y=y>>>0,I||je(y,2,this.length);const _e=this[y+1]|this[y]<<8;return _e&32768?_e|4294901760:_e},x.prototype.readInt32LE=function(y,I){return y=y>>>0,I||je(y,4,this.length),this[y]|this[y+1]<<8|this[y+2]<<16|this[y+3]<<24},x.prototype.readInt32BE=function(y,I){return y=y>>>0,I||je(y,4,this.length),this[y]<<24|this[y+1]<<16|this[y+2]<<8|this[y+3]},x.prototype.readBigInt64LE=ft(function(y){y=y>>>0,We(y,"offset");const I=this[y],_e=this[y+7];(I===void 0||_e===void 0)&&qe(y,this.length-8);const we=this[y+4]+this[y+5]*2**8+this[y+6]*2**16+(_e<<24);return(BigInt(we)<<BigInt(32))+BigInt(I+this[++y]*2**8+this[++y]*2**16+this[++y]*2**24)}),x.prototype.readBigInt64BE=ft(function(y){y=y>>>0,We(y,"offset");const I=this[y],_e=this[y+7];(I===void 0||_e===void 0)&&qe(y,this.length-8);const we=(I<<24)+this[++y]*2**16+this[++y]*2**8+this[++y];return(BigInt(we)<<BigInt(32))+BigInt(this[++y]*2**24+this[++y]*2**16+this[++y]*2**8+_e)}),x.prototype.readFloatLE=function(y,I){return y=y>>>0,I||je(y,4,this.length),r.read(this,y,!0,23,4)},x.prototype.readFloatBE=function(y,I){return y=y>>>0,I||je(y,4,this.length),r.read(this,y,!1,23,4)},x.prototype.readDoubleLE=function(y,I){return y=y>>>0,I||je(y,8,this.length),r.read(this,y,!0,52,8)},x.prototype.readDoubleBE=function(y,I){return y=y>>>0,I||je(y,8,this.length),r.read(this,y,!1,52,8)};function Qe(M,y,I,_e,we,be){if(!x.isBuffer(M))throw new TypeError('"buffer" argument must be a Buffer instance');if(y>we||y<be)throw new RangeError('"value" argument is out of bounds');if(I+_e>M.length)throw new RangeError("Index out of range")}x.prototype.writeUintLE=x.prototype.writeUIntLE=function(y,I,_e,we){if(y=+y,I=I>>>0,_e=_e>>>0,!we){const Pe=Math.pow(2,8*_e)-1;Qe(this,y,I,_e,Pe,0)}let be=1,Ne=0;for(this[I]=y&255;++Ne<_e&&(be*=256);)this[I+Ne]=y/be&255;return I+_e},x.prototype.writeUintBE=x.prototype.writeUIntBE=function(y,I,_e,we){if(y=+y,I=I>>>0,_e=_e>>>0,!we){const Pe=Math.pow(2,8*_e)-1;Qe(this,y,I,_e,Pe,0)}let be=_e-1,Ne=1;for(this[I+be]=y&255;--be>=0&&(Ne*=256);)this[I+be]=y/Ne&255;return I+_e},x.prototype.writeUint8=x.prototype.writeUInt8=function(y,I,_e){return y=+y,I=I>>>0,_e||Qe(this,y,I,1,255,0),this[I]=y&255,I+1},x.prototype.writeUint16LE=x.prototype.writeUInt16LE=function(y,I,_e){return y=+y,I=I>>>0,_e||Qe(this,y,I,2,65535,0),this[I]=y&255,this[I+1]=y>>>8,I+2},x.prototype.writeUint16BE=x.prototype.writeUInt16BE=function(y,I,_e){return y=+y,I=I>>>0,_e||Qe(this,y,I,2,65535,0),this[I]=y>>>8,this[I+1]=y&255,I+2},x.prototype.writeUint32LE=x.prototype.writeUInt32LE=function(y,I,_e){return y=+y,I=I>>>0,_e||Qe(this,y,I,4,4294967295,0),this[I+3]=y>>>24,this[I+2]=y>>>16,this[I+1]=y>>>8,this[I]=y&255,I+4},x.prototype.writeUint32BE=x.prototype.writeUInt32BE=function(y,I,_e){return y=+y,I=I>>>0,_e||Qe(this,y,I,4,4294967295,0),this[I]=y>>>24,this[I+1]=y>>>16,this[I+2]=y>>>8,this[I+3]=y&255,I+4};function ht(M,y,I,_e,we){Ye(y,_e,we,M,I,7);let be=Number(y&BigInt(4294967295));M[I++]=be,be=be>>8,M[I++]=be,be=be>>8,M[I++]=be,be=be>>8,M[I++]=be;let Ne=Number(y>>BigInt(32)&BigInt(4294967295));return M[I++]=Ne,Ne=Ne>>8,M[I++]=Ne,Ne=Ne>>8,M[I++]=Ne,Ne=Ne>>8,M[I++]=Ne,I}function dt(M,y,I,_e,we){Ye(y,_e,we,M,I,7);let be=Number(y&BigInt(4294967295));M[I+7]=be,be=be>>8,M[I+6]=be,be=be>>8,M[I+5]=be,be=be>>8,M[I+4]=be;let Ne=Number(y>>BigInt(32)&BigInt(4294967295));return M[I+3]=Ne,Ne=Ne>>8,M[I+2]=Ne,Ne=Ne>>8,M[I+1]=Ne,Ne=Ne>>8,M[I]=Ne,I+8}x.prototype.writeBigUInt64LE=ft(function(y,I=0){return ht(this,y,I,BigInt(0),BigInt("0xffffffffffffffff"))}),x.prototype.writeBigUInt64BE=ft(function(y,I=0){return dt(this,y,I,BigInt(0),BigInt("0xffffffffffffffff"))}),x.prototype.writeIntLE=function(y,I,_e,we){if(y=+y,I=I>>>0,!we){const Xe=Math.pow(2,8*_e-1);Qe(this,y,I,_e,Xe-1,-Xe)}let be=0,Ne=1,Pe=0;for(this[I]=y&255;++be<_e&&(Ne*=256);)y<0&&Pe===0&&this[I+be-1]!==0&&(Pe=1),this[I+be]=(y/Ne>>0)-Pe&255;return I+_e},x.prototype.writeIntBE=function(y,I,_e,we){if(y=+y,I=I>>>0,!we){const Xe=Math.pow(2,8*_e-1);Qe(this,y,I,_e,Xe-1,-Xe)}let be=_e-1,Ne=1,Pe=0;for(this[I+be]=y&255;--be>=0&&(Ne*=256);)y<0&&Pe===0&&this[I+be+1]!==0&&(Pe=1),this[I+be]=(y/Ne>>0)-Pe&255;return I+_e},x.prototype.writeInt8=function(y,I,_e){return y=+y,I=I>>>0,_e||Qe(this,y,I,1,127,-128),y<0&&(y=255+y+1),this[I]=y&255,I+1},x.prototype.writeInt16LE=function(y,I,_e){return y=+y,I=I>>>0,_e||Qe(this,y,I,2,32767,-32768),this[I]=y&255,this[I+1]=y>>>8,I+2},x.prototype.writeInt16BE=function(y,I,_e){return y=+y,I=I>>>0,_e||Qe(this,y,I,2,32767,-32768),this[I]=y>>>8,this[I+1]=y&255,I+2},x.prototype.writeInt32LE=function(y,I,_e){return y=+y,I=I>>>0,_e||Qe(this,y,I,4,2147483647,-2147483648),this[I]=y&255,this[I+1]=y>>>8,this[I+2]=y>>>16,this[I+3]=y>>>24,I+4},x.prototype.writeInt32BE=function(y,I,_e){return y=+y,I=I>>>0,_e||Qe(this,y,I,4,2147483647,-2147483648),y<0&&(y=4294967295+y+1),this[I]=y>>>24,this[I+1]=y>>>16,this[I+2]=y>>>8,this[I+3]=y&255,I+4},x.prototype.writeBigInt64LE=ft(function(y,I=0){return ht(this,y,I,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),x.prototype.writeBigInt64BE=ft(function(y,I=0){return dt(this,y,I,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function _t(M,y,I,_e,we,be){if(I+_e>M.length)throw new RangeError("Index out of range");if(I<0)throw new RangeError("Index out of range")}function mt(M,y,I,_e,we){return y=+y,I=I>>>0,we||_t(M,y,I,4),r.write(M,y,I,_e,23,4),I+4}x.prototype.writeFloatLE=function(y,I,_e){return mt(this,y,I,!0,_e)},x.prototype.writeFloatBE=function(y,I,_e){return mt(this,y,I,!1,_e)};function he(M,y,I,_e,we){return y=+y,I=I>>>0,we||_t(M,y,I,8),r.write(M,y,I,_e,52,8),I+8}x.prototype.writeDoubleLE=function(y,I,_e){return he(this,y,I,!0,_e)},x.prototype.writeDoubleBE=function(y,I,_e){return he(this,y,I,!1,_e)},x.prototype.copy=function(y,I,_e,we){if(!x.isBuffer(y))throw new TypeError("argument should be a Buffer");if(_e||(_e=0),!we&&we!==0&&(we=this.length),I>=y.length&&(I=y.length),I||(I=0),we>0&&we<_e&&(we=_e),we===_e||y.length===0||this.length===0)return 0;if(I<0)throw new RangeError("targetStart out of bounds");if(_e<0||_e>=this.length)throw new RangeError("Index out of range");if(we<0)throw new RangeError("sourceEnd out of bounds");we>this.length&&(we=this.length),y.length-I<we-_e&&(we=y.length-I+_e);const be=we-_e;return this===y&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(I,_e,we):Uint8Array.prototype.set.call(y,this.subarray(_e,we),I),be},x.prototype.fill=function(y,I,_e,we){if(typeof y=="string"){if(typeof I=="string"?(we=I,I=0,_e=this.length):typeof _e=="string"&&(we=_e,_e=this.length),we!==void 0&&typeof we!="string")throw new TypeError("encoding must be a string");if(typeof we=="string"&&!x.isEncoding(we))throw new TypeError("Unknown encoding: "+we);if(y.length===1){const Ne=y.charCodeAt(0);(we==="utf8"&&Ne<128||we==="latin1")&&(y=Ne)}}else typeof y=="number"?y=y&255:typeof y=="boolean"&&(y=Number(y));if(I<0||this.length<I||this.length<_e)throw new RangeError("Out of range index");if(_e<=I)return this;I=I>>>0,_e=_e===void 0?this.length:_e>>>0,y||(y=0);let be;if(typeof y=="number")for(be=I;be<_e;++be)this[be]=y;else{const Ne=x.isBuffer(y)?y:x.from(y,we),Pe=Ne.length;if(Pe===0)throw new TypeError('The value "'+y+'" is invalid for argument "value"');for(be=0;be<_e-I;++be)this[be+I]=Ne[be%Pe]}return this};const O={};function Ce(M,y,I){O[M]=class extends I{constructor(){super(),Object.defineProperty(this,"message",{value:y.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${M}]`,this.stack,delete this.name}get code(){return M}set code(we){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:we,writable:!0})}toString(){return`${this.name} [${M}]: ${this.message}`}}}Ce("ERR_BUFFER_OUT_OF_BOUNDS",function(M){return M?`${M} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Ce("ERR_INVALID_ARG_TYPE",function(M,y){return`The "${M}" argument must be of type number. Received type ${typeof y}`},TypeError),Ce("ERR_OUT_OF_RANGE",function(M,y,I){let _e=`The value of "${M}" is out of range.`,we=I;return Number.isInteger(I)&&Math.abs(I)>2**32?we=xe(String(I)):typeof I=="bigint"&&(we=String(I),(I>BigInt(2)**BigInt(32)||I<-(BigInt(2)**BigInt(32)))&&(we=xe(we)),we+="n"),_e+=` It must be ${y}. Received ${we}`,_e},RangeError);function xe(M){let y="",I=M.length;const _e=M[0]==="-"?1:0;for(;I>=_e+4;I-=3)y=`_${M.slice(I-3,I)}${y}`;return`${M.slice(0,I)}${y}`}function ze(M,y,I){We(y,"offset"),(M[y]===void 0||M[y+I]===void 0)&&qe(y,M.length-(I+1))}function Ye(M,y,I,_e,we,be){if(M>I||M<y){const Ne=typeof y=="bigint"?"n":"";let Pe;throw be>3?y===0||y===BigInt(0)?Pe=`>= 0${Ne} and < 2${Ne} ** ${(be+1)*8}${Ne}`:Pe=`>= -(2${Ne} ** ${(be+1)*8-1}${Ne}) and < 2 ** ${(be+1)*8-1}${Ne}`:Pe=`>= ${y}${Ne} and <= ${I}${Ne}`,new O.ERR_OUT_OF_RANGE("value",Pe,M)}ze(_e,we,be)}function We(M,y){if(typeof M!="number")throw new O.ERR_INVALID_ARG_TYPE(y,"number",M)}function qe(M,y,I){throw Math.floor(M)!==M?(We(M,I),new O.ERR_OUT_OF_RANGE(I||"offset","an integer",M)):y<0?new O.ERR_BUFFER_OUT_OF_BOUNDS:new O.ERR_OUT_OF_RANGE(I||"offset",`>= ${I?1:0} and <= ${y}`,M)}const tt=/[^+/0-9A-Za-z-_]/g;function st(M){if(M=M.split("=")[0],M=M.trim().replace(tt,""),M.length<2)return"";for(;M.length%4!==0;)M=M+"=";return M}function Ve(M,y){y=y||1/0;let I;const _e=M.length;let we=null;const be=[];for(let Ne=0;Ne<_e;++Ne){if(I=M.charCodeAt(Ne),I>55295&&I<57344){if(!we){if(I>56319){(y-=3)>-1&&be.push(239,191,189);continue}else if(Ne+1===_e){(y-=3)>-1&&be.push(239,191,189);continue}we=I;continue}if(I<56320){(y-=3)>-1&&be.push(239,191,189),we=I;continue}I=(we-55296<<10|I-56320)+65536}else we&&(y-=3)>-1&&be.push(239,191,189);if(we=null,I<128){if((y-=1)<0)break;be.push(I)}else if(I<2048){if((y-=2)<0)break;be.push(I>>6|192,I&63|128)}else if(I<65536){if((y-=3)<0)break;be.push(I>>12|224,I>>6&63|128,I&63|128)}else if(I<1114112){if((y-=4)<0)break;be.push(I>>18|240,I>>12&63|128,I>>6&63|128,I&63|128)}else throw new Error("Invalid code point")}return be}function nt(M){const y=[];for(let I=0;I<M.length;++I)y.push(M.charCodeAt(I)&255);return y}function gt(M,y){let I,_e,we;const be=[];for(let Ne=0;Ne<M.length&&!((y-=2)<0);++Ne)I=M.charCodeAt(Ne),_e=I>>8,we=I%256,be.push(we),be.push(_e);return be}function pt(M){return E.toByteArray(st(M))}function lt(M,y,I,_e){let we;for(we=0;we<_e&&!(we+I>=y.length||we>=M.length);++we)y[we+I]=M[we];return we}function it(M,y){return M instanceof y||M!=null&&M.constructor!=null&&M.constructor.name!=null&&M.constructor.name===y.name}function Et(M){return M!==M}const vt=function(){const M="0123456789abcdef",y=new Array(256);for(let I=0;I<16;++I){const _e=I*16;for(let we=0;we<16;++we)y[_e+we]=M[I]+M[we]}return y}();function ft(M){return typeof BigInt=="undefined"?wt:M}function wt(){throw new Error("BigInt not supported")}})(buffer$1),globalThis.Buffer=buffer$1.Buffer;var utf8$5={},utils$r={},support$5={},nodestream,blob;if(support$5.base64=!0,support$5.array=!0,support$5.string=!0,support$5.arraybuffer=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined",support$5.nodebuffer=typeof Buffer!="undefined",support$5.uint8array=typeof Uint8Array!="undefined",typeof ArrayBuffer=="undefined")blob=support$5.blob=!1;else{var buffer=new ArrayBuffer(0);try{blob=support$5.blob=new Blob([buffer],{type:"application/zip"}).size===0}catch(t){try{var Builder=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,builder=new Builder;builder.append(buffer),blob=support$5.blob=builder.getBlob("application/zip").size===0}catch(E){blob=support$5.blob=!1}}}try{nodestream=support$5.nodestream=!!require("readable-stream").Readable}catch(t){nodestream=support$5.nodestream=!1}var base64$1={},utils$q=utils$r,support$4=support$5,_keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";base64$1.encode=function(t){for(var E=[],r,v,T,N,k,x,ce,ue=0,Z=t.length,$e=Z,Ee=utils$q.getTypeOf(t)!=="string";ue<t.length;)$e=Z-ue,Ee?(r=t[ue++],v=ue<Z?t[ue++]:0,T=ue<Z?t[ue++]:0):(r=t.charCodeAt(ue++),v=ue<Z?t.charCodeAt(ue++):0,T=ue<Z?t.charCodeAt(ue++):0),N=r>>2,k=(r&3)<<4|v>>4,x=$e>1?(v&15)<<2|T>>6:64,ce=$e>2?T&63:64,E.push(_keyStr.charAt(N)+_keyStr.charAt(k)+_keyStr.charAt(x)+_keyStr.charAt(ce));return E.join("")},base64$1.decode=function(t){var E,r,v,T,N,k,x,ce=0,ue=0,Z="data:";if(t.substr(0,Z.length)===Z)throw new Error("Invalid base64 input, it looks like a data url.");t=t.replace(/[^A-Za-z0-9+/=]/g,"");var $e=t.length*3/4;if(t.charAt(t.length-1)===_keyStr.charAt(64)&&$e--,t.charAt(t.length-2)===_keyStr.charAt(64)&&$e--,$e%1!==0)throw new Error("Invalid base64 input, bad content length.");var Ee;for(support$4.uint8array?Ee=new Uint8Array($e|0):Ee=new Array($e|0);ce<t.length;)T=_keyStr.indexOf(t.charAt(ce++)),N=_keyStr.indexOf(t.charAt(ce++)),k=_keyStr.indexOf(t.charAt(ce++)),x=_keyStr.indexOf(t.charAt(ce++)),E=T<<2|N>>4,r=(N&15)<<4|k>>2,v=(k&3)<<6|x,Ee[ue++]=E,k!==64&&(Ee[ue++]=r),x!==64&&(Ee[ue++]=v);return Ee};var nodejsUtils$2={isNode:typeof Buffer!="undefined",newBufferFrom:function(t,E){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(t,E);if(typeof t=="number")throw new Error('The "data" argument must not be a number');return new Buffer(t,E)},allocBuffer:function(t){if(Buffer.alloc)return Buffer.alloc(t);var E=new Buffer(t);return E.fill(0),E},isBuffer:function(t){return Buffer.isBuffer(t)},isStream:function(t){return t&&typeof t.on=="function"&&typeof t.pause=="function"&&typeof t.resume=="function"}},Mutation=commonjsGlobal.MutationObserver||commonjsGlobal.WebKitMutationObserver,scheduleDrain;if(Mutation){var called=0,observer=new Mutation(nextTick),element=commonjsGlobal.document.createTextNode("");observer.observe(element,{characterData:!0}),scheduleDrain=function(){element.data=called=++called%2}}else if(!commonjsGlobal.setImmediate&&typeof commonjsGlobal.MessageChannel!="undefined"){var channel=new commonjsGlobal.MessageChannel;channel.port1.onmessage=nextTick,scheduleDrain=function(){channel.port2.postMessage(0)}}else"document"in commonjsGlobal&&"onreadystatechange"in commonjsGlobal.document.createElement("script")?scheduleDrain=function(){var t=commonjsGlobal.document.createElement("script");t.onreadystatechange=function(){nextTick(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},commonjsGlobal.document.documentElement.appendChild(t)}:scheduleDrain=function(){setTimeout(nextTick,0)};var draining,queue=[];function nextTick(){draining=!0;for(var t,E,r=queue.length;r;){for(E=queue,queue=[],t=-1;++t<r;)E[t]();r=queue.length}draining=!1}var lib$2=immediate$1;function immediate$1(t){queue.push(t)===1&&!draining&&scheduleDrain()}var immediate=lib$2;function INTERNAL(){}var handlers={},REJECTED=["REJECTED"],FULFILLED=["FULFILLED"],PENDING=["PENDING"],lib$1=Promise$1;function Promise$1(t){if(typeof t!="function")throw new TypeError("resolver must be a function");this.state=PENDING,this.queue=[],this.outcome=void 0,t!==INTERNAL&&safelyResolveThenable(this,t)}Promise$1.prototype.finally=function(t){if(typeof t!="function")return this;var E=this.constructor;return this.then(r,v);function r(T){function N(){return T}return E.resolve(t()).then(N)}function v(T){function N(){throw T}return E.resolve(t()).then(N)}},Promise$1.prototype.catch=function(t){return this.then(null,t)},Promise$1.prototype.then=function(t,E){if(typeof t!="function"&&this.state===FULFILLED||typeof E!="function"&&this.state===REJECTED)return this;var r=new this.constructor(INTERNAL);if(this.state!==PENDING){var v=this.state===FULFILLED?t:E;unwrap(r,v,this.outcome)}else this.queue.push(new QueueItem(r,t,E));return r};function QueueItem(t,E,r){this.promise=t,typeof E=="function"&&(this.onFulfilled=E,this.callFulfilled=this.otherCallFulfilled),typeof r=="function"&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}QueueItem.prototype.callFulfilled=function(t){handlers.resolve(this.promise,t)},QueueItem.prototype.otherCallFulfilled=function(t){unwrap(this.promise,this.onFulfilled,t)},QueueItem.prototype.callRejected=function(t){handlers.reject(this.promise,t)},QueueItem.prototype.otherCallRejected=function(t){unwrap(this.promise,this.onRejected,t)};function unwrap(t,E,r){immediate(function(){var v;try{v=E(r)}catch(T){return handlers.reject(t,T)}v===t?handlers.reject(t,new TypeError("Cannot resolve promise with itself")):handlers.resolve(t,v)})}handlers.resolve=function(t,E){var r=tryCatch(getThen,E);if(r.status==="error")return handlers.reject(t,r.value);var v=r.value;if(v)safelyResolveThenable(t,v);else{t.state=FULFILLED,t.outcome=E;for(var T=-1,N=t.queue.length;++T<N;)t.queue[T].callFulfilled(E)}return t},handlers.reject=function(t,E){t.state=REJECTED,t.outcome=E;for(var r=-1,v=t.queue.length;++r<v;)t.queue[r].callRejected(E);return t};function getThen(t){var E=t&&t.then;if(t&&(typeof t=="object"||typeof t=="function")&&typeof E=="function")return function(){E.apply(t,arguments)}}function safelyResolveThenable(t,E){var r=!1;function v(x){r||(r=!0,handlers.reject(t,x))}function T(x){r||(r=!0,handlers.resolve(t,x))}function N(){E(T,v)}var k=tryCatch(N);k.status==="error"&&v(k.value)}function tryCatch(t,E){var r={};try{r.value=t(E),r.status="success"}catch(v){r.status="error",r.value=v}return r}Promise$1.resolve=resolve;function resolve(t){return t instanceof this?t:handlers.resolve(new this(INTERNAL),t)}Promise$1.reject=reject;function reject(t){var E=new this(INTERNAL);return handlers.reject(E,t)}Promise$1.all=all;function all(t){var E=this;if(Object.prototype.toString.call(t)!=="[object Array]")return this.reject(new TypeError("must be an array"));var r=t.length,v=!1;if(!r)return this.resolve([]);for(var T=new Array(r),N=0,k=-1,x=new this(INTERNAL);++k<r;)ce(t[k],k);return x;function ce(ue,Z){E.resolve(ue).then($e,function(Ee){v||(v=!0,handlers.reject(x,Ee))});function $e(Ee){T[Z]=Ee,++N===r&&!v&&(v=!0,handlers.resolve(x,T))}}}Promise$1.race=race;function race(t){var E=this;if(Object.prototype.toString.call(t)!=="[object Array]")return this.reject(new TypeError("must be an array"));var r=t.length,v=!1;if(!r)return this.resolve([]);for(var T=-1,N=new this(INTERNAL);++T<r;)k(t[T]);return N;function k(x){E.resolve(x).then(function(ce){v||(v=!0,handlers.resolve(N,ce))},function(ce){v||(v=!0,handlers.reject(N,ce))})}}var ES6Promise=null;typeof Promise!="undefined"?ES6Promise=Promise:ES6Promise=lib$1;var external$3={Promise:ES6Promise};(function(t,E){if(t.setImmediate)return;var r=1,v={},T=!1,N=t.document,k;function x(Ae){typeof Ae!="function"&&(Ae=new Function(""+Ae));for(var Re=new Array(arguments.length-1),ke=0;ke<Re.length;ke++)Re[ke]=arguments[ke+1];var De={callback:Ae,args:Re};return v[r]=De,k(r),r++}function ce(Ae){delete v[Ae]}function ue(Ae){var Re=Ae.callback,ke=Ae.args;switch(ke.length){case 0:Re();break;case 1:Re(ke[0]);break;case 2:Re(ke[0],ke[1]);break;case 3:Re(ke[0],ke[1],ke[2]);break;default:Re.apply(E,ke);break}}function Z(Ae){if(T)setTimeout(Z,0,Ae);else{var Re=v[Ae];if(Re){T=!0;try{ue(Re)}finally{ce(Ae),T=!1}}}}function $e(){k=function(Ae){setTimeout(function(){Z(Ae)})}}function Ee(){if(t.postMessage&&!t.importScripts){var Ae=!0,Re=t.onmessage;return t.onmessage=function(){Ae=!1},t.postMessage("","*"),t.onmessage=Re,Ae}}function ge(){var Ae="setImmediate$"+Math.random()+"$",Re=function(ke){ke.source===t&&typeof ke.data=="string"&&ke.data.indexOf(Ae)===0&&Z(+ke.data.slice(Ae.length))};t.addEventListener?t.addEventListener("message",Re,!1):t.attachEvent("onmessage",Re),k=function(ke){t.postMessage(Ae+ke,"*")}}function ye(){var Ae=new MessageChannel;Ae.port1.onmessage=function(Re){var ke=Re.data;Z(ke)},k=function(Re){Ae.port2.postMessage(Re)}}function Te(){var Ae=N.documentElement;k=function(Re){var ke=N.createElement("script");ke.onreadystatechange=function(){Z(Re),ke.onreadystatechange=null,Ae.removeChild(ke),ke=null},Ae.appendChild(ke)}}function Se(){k=function(Ae){setTimeout(Z,0,Ae)}}var Ie=Object.getPrototypeOf&&Object.getPrototypeOf(t);Ie=Ie&&Ie.setTimeout?Ie:t,{}.toString.call(t.undefined)==="[object undefined]"?$e():Ee()?ge():t.MessageChannel?ye():N&&"onreadystatechange"in N.createElement("script")?Te():Se(),Ie.setImmediate=x,Ie.clearImmediate=ce})(typeof self=="undefined"?commonjsGlobal:self),function(t){var E=support$5,r=base64$1,v=nodejsUtils$2,T=external$3;function N(Ee){var ge=null;return E.uint8array?ge=new Uint8Array(Ee.length):ge=new Array(Ee.length),x(Ee,ge)}t.newBlob=function(Ee,ge){t.checkSupport("blob");try{return new Blob([Ee],{type:ge})}catch(Se){try{var ye=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,Te=new ye;return Te.append(Ee),Te.getBlob(ge)}catch(Ie){throw new Error("Bug : can't construct the Blob.")}}};function k(Ee){return Ee}function x(Ee,ge){for(var ye=0;ye<Ee.length;++ye)ge[ye]=Ee.charCodeAt(ye)&255;return ge}var ce={stringifyByChunk:function(Ee,ge,ye){var Te=[],Se=0,Ie=Ee.length;if(Ie<=ye)return String.fromCharCode.apply(null,Ee);for(;Se<Ie;)ge==="array"||ge==="nodebuffer"?Te.push(String.fromCharCode.apply(null,Ee.slice(Se,Math.min(Se+ye,Ie)))):Te.push(String.fromCharCode.apply(null,Ee.subarray(Se,Math.min(Se+ye,Ie)))),Se+=ye;return Te.join("")},stringifyByChar:function(Ee){for(var ge="",ye=0;ye<Ee.length;ye++)ge+=String.fromCharCode(Ee[ye]);return ge},applyCanBeUsed:{uint8array:function(){try{return E.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch(Ee){return!1}}(),nodebuffer:function(){try{return E.nodebuffer&&String.fromCharCode.apply(null,v.allocBuffer(1)).length===1}catch(Ee){return!1}}()}};function ue(Ee){var ge=65536,ye=t.getTypeOf(Ee),Te=!0;if(ye==="uint8array"?Te=ce.applyCanBeUsed.uint8array:ye==="nodebuffer"&&(Te=ce.applyCanBeUsed.nodebuffer),Te)for(;ge>1;)try{return ce.stringifyByChunk(Ee,ye,ge)}catch(Se){ge=Math.floor(ge/2)}return ce.stringifyByChar(Ee)}t.applyFromCharCode=ue;function Z(Ee,ge){for(var ye=0;ye<Ee.length;ye++)ge[ye]=Ee[ye];return ge}var $e={};$e.string={string:k,array:function(Ee){return x(Ee,new Array(Ee.length))},arraybuffer:function(Ee){return $e.string.uint8array(Ee).buffer},uint8array:function(Ee){return x(Ee,new Uint8Array(Ee.length))},nodebuffer:function(Ee){return x(Ee,v.allocBuffer(Ee.length))}},$e.array={string:ue,array:k,arraybuffer:function(Ee){return new Uint8Array(Ee).buffer},uint8array:function(Ee){return new Uint8Array(Ee)},nodebuffer:function(Ee){return v.newBufferFrom(Ee)}},$e.arraybuffer={string:function(Ee){return ue(new Uint8Array(Ee))},array:function(Ee){return Z(new Uint8Array(Ee),new Array(Ee.byteLength))},arraybuffer:k,uint8array:function(Ee){return new Uint8Array(Ee)},nodebuffer:function(Ee){return v.newBufferFrom(new Uint8Array(Ee))}},$e.uint8array={string:ue,array:function(Ee){return Z(Ee,new Array(Ee.length))},arraybuffer:function(Ee){return Ee.buffer},uint8array:k,nodebuffer:function(Ee){return v.newBufferFrom(Ee)}},$e.nodebuffer={string:ue,array:function(Ee){return Z(Ee,new Array(Ee.length))},arraybuffer:function(Ee){return $e.nodebuffer.uint8array(Ee).buffer},uint8array:function(Ee){return Z(Ee,new Uint8Array(Ee.length))},nodebuffer:k},t.transformTo=function(Ee,ge){if(ge||(ge=""),!Ee)return ge;t.checkSupport(Ee);var ye=t.getTypeOf(ge),Te=$e[ye][Ee](ge);return Te},t.resolve=function(Ee){for(var ge=Ee.split("/"),ye=[],Te=0;Te<ge.length;Te++){var Se=ge[Te];Se==="."||Se===""&&Te!==0&&Te!==ge.length-1||(Se===".."?ye.pop():ye.push(Se))}return ye.join("/")},t.getTypeOf=function(Ee){if(typeof Ee=="string")return"string";if(Object.prototype.toString.call(Ee)==="[object Array]")return"array";if(E.nodebuffer&&v.isBuffer(Ee))return"nodebuffer";if(E.uint8array&&Ee instanceof Uint8Array)return"uint8array";if(E.arraybuffer&&Ee instanceof ArrayBuffer)return"arraybuffer"},t.checkSupport=function(Ee){var ge=E[Ee.toLowerCase()];if(!ge)throw new Error(Ee+" is not supported by this platform")},t.MAX_VALUE_16BITS=65535,t.MAX_VALUE_32BITS=-1,t.pretty=function(Ee){var ge="",ye,Te;for(Te=0;Te<(Ee||"").length;Te++)ye=Ee.charCodeAt(Te),ge+="\\x"+(ye<16?"0":"")+ye.toString(16).toUpperCase();return ge},t.delay=function(Ee,ge,ye){setImmediate(function(){Ee.apply(ye||null,ge||[])})},t.inherits=function(Ee,ge){var ye=function(){};ye.prototype=ge.prototype,Ee.prototype=new ye},t.extend=function(){var Ee={},ge,ye;for(ge=0;ge<arguments.length;ge++)for(ye in arguments[ge])Object.prototype.hasOwnProperty.call(arguments[ge],ye)&&typeof Ee[ye]=="undefined"&&(Ee[ye]=arguments[ge][ye]);return Ee},t.prepareContent=function(Ee,ge,ye,Te,Se){var Ie=T.Promise.resolve(ge).then(function(Ae){var Re=E.blob&&(Ae instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(Ae))!==-1);return Re&&typeof FileReader!="undefined"?new T.Promise(function(ke,De){var Le=new FileReader;Le.onload=function(Be){ke(Be.target.result)},Le.onerror=function(Be){De(Be.target.error)},Le.readAsArrayBuffer(Ae)}):Ae});return Ie.then(function(Ae){var Re=t.getTypeOf(Ae);return Re?(Re==="arraybuffer"?Ae=t.transformTo("uint8array",Ae):Re==="string"&&(Se?Ae=r.decode(Ae):ye&&Te!==!0&&(Ae=N(Ae))),Ae):T.Promise.reject(new Error("Can't read the data of '"+Ee+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}}(utils$r);function GenericWorker$b(t){this.name=t||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}GenericWorker$b.prototype={push:function(t){this.emit("data",t)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(t){this.emit("error",t)}return!0},error:function(t){return this.isFinished?!1:(this.isPaused?this.generatedError=t:(this.isFinished=!0,this.emit("error",t),this.previous&&this.previous.error(t),this.cleanUp()),!0)},on:function(t,E){return this._listeners[t].push(E),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(t,E){if(this._listeners[t])for(var r=0;r<this._listeners[t].length;r++)this._listeners[t][r].call(this,E)},pipe:function(t){return t.registerPrevious(this)},registerPrevious:function(t){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=t.streamInfo,this.mergeStreamInfo(),this.previous=t;var E=this;return t.on("data",function(r){E.processChunk(r)}),t.on("end",function(){E.end()}),t.on("error",function(r){E.error(r)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var t=!1;return this.generatedError&&(this.error(this.generatedError),t=!0),this.previous&&this.previous.resume(),!t},flush:function(){},processChunk:function(t){this.push(t)},withStreamInfo:function(t,E){return this.extraStreamInfo[t]=E,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var t in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,t)&&(this.streamInfo[t]=this.extraStreamInfo[t])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var t="Worker "+this.name;return this.previous?this.previous+" -> "+t:t}};var GenericWorker_1=GenericWorker$b;(function(t){for(var E=utils$r,r=support$5,v=nodejsUtils$2,T=GenericWorker_1,N=new Array(256),k=0;k<256;k++)N[k]=k>=252?6:k>=248?5:k>=240?4:k>=224?3:k>=192?2:1;N[254]=N[254]=1;var x=function(Ee){var ge,ye,Te,Se,Ie,Ae=Ee.length,Re=0;for(Se=0;Se<Ae;Se++)ye=Ee.charCodeAt(Se),(ye&64512)===55296&&Se+1<Ae&&(Te=Ee.charCodeAt(Se+1),(Te&64512)===56320&&(ye=65536+(ye-55296<<10)+(Te-56320),Se++)),Re+=ye<128?1:ye<2048?2:ye<65536?3:4;for(r.uint8array?ge=new Uint8Array(Re):ge=new Array(Re),Ie=0,Se=0;Ie<Re;Se++)ye=Ee.charCodeAt(Se),(ye&64512)===55296&&Se+1<Ae&&(Te=Ee.charCodeAt(Se+1),(Te&64512)===56320&&(ye=65536+(ye-55296<<10)+(Te-56320),Se++)),ye<128?ge[Ie++]=ye:ye<2048?(ge[Ie++]=192|ye>>>6,ge[Ie++]=128|ye&63):ye<65536?(ge[Ie++]=224|ye>>>12,ge[Ie++]=128|ye>>>6&63,ge[Ie++]=128|ye&63):(ge[Ie++]=240|ye>>>18,ge[Ie++]=128|ye>>>12&63,ge[Ie++]=128|ye>>>6&63,ge[Ie++]=128|ye&63);return ge},ce=function(Ee,ge){var ye;for(ge=ge||Ee.length,ge>Ee.length&&(ge=Ee.length),ye=ge-1;ye>=0&&(Ee[ye]&192)===128;)ye--;return ye<0||ye===0?ge:ye+N[Ee[ye]]>ge?ye:ge},ue=function(Ee){var ge,ye,Te,Se,Ie=Ee.length,Ae=new Array(Ie*2);for(ye=0,ge=0;ge<Ie;){if(Te=Ee[ge++],Te<128){Ae[ye++]=Te;continue}if(Se=N[Te],Se>4){Ae[ye++]=65533,ge+=Se-1;continue}for(Te&=Se===2?31:Se===3?15:7;Se>1&&ge<Ie;)Te=Te<<6|Ee[ge++]&63,Se--;if(Se>1){Ae[ye++]=65533;continue}Te<65536?Ae[ye++]=Te:(Te-=65536,Ae[ye++]=55296|Te>>10&1023,Ae[ye++]=56320|Te&1023)}return Ae.length!==ye&&(Ae.subarray?Ae=Ae.subarray(0,ye):Ae.length=ye),E.applyFromCharCode(Ae)};t.utf8encode=function(ge){return r.nodebuffer?v.newBufferFrom(ge,"utf-8"):x(ge)},t.utf8decode=function(ge){return r.nodebuffer?E.transformTo("nodebuffer",ge).toString("utf-8"):(ge=E.transformTo(r.uint8array?"uint8array":"array",ge),ue(ge))};function Z(){T.call(this,"utf-8 decode"),this.leftOver=null}E.inherits(Z,T),Z.prototype.processChunk=function(Ee){var ge=E.transformTo(r.uint8array?"uint8array":"array",Ee.data);if(this.leftOver&&this.leftOver.length){if(r.uint8array){var ye=ge;ge=new Uint8Array(ye.length+this.leftOver.length),ge.set(this.leftOver,0),ge.set(ye,this.leftOver.length)}else ge=this.leftOver.concat(ge);this.leftOver=null}var Te=ce(ge),Se=ge;Te!==ge.length&&(r.uint8array?(Se=ge.subarray(0,Te),this.leftOver=ge.subarray(Te,ge.length)):(Se=ge.slice(0,Te),this.leftOver=ge.slice(Te,ge.length))),this.push({data:t.utf8decode(Se),meta:Ee.meta})},Z.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:t.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},t.Utf8DecodeWorker=Z;function $e(){T.call(this,"utf-8 encode")}E.inherits($e,T),$e.prototype.processChunk=function(Ee){this.push({data:t.utf8encode(Ee.data),meta:Ee.meta})},t.Utf8EncodeWorker=$e})(utf8$5);var GenericWorker$a=GenericWorker_1,utils$p=utils$r;function ConvertWorker$1(t){GenericWorker$a.call(this,"ConvertWorker to "+t),this.destType=t}utils$p.inherits(ConvertWorker$1,GenericWorker$a),ConvertWorker$1.prototype.processChunk=function(t){this.push({data:utils$p.transformTo(this.destType,t.data),meta:t.meta})};var ConvertWorker_1=ConvertWorker$1,utils$o=utils$r,ConvertWorker=ConvertWorker_1,GenericWorker$9=GenericWorker_1,base64=base64$1,support$3=support$5,external$2=external$3,NodejsStreamOutputAdapter=null;if(support$3.nodestream)try{NodejsStreamOutputAdapter=require("../nodejs/NodejsStreamOutputAdapter")}catch(t){}function transformZipOutput(t,E,r){switch(t){case"blob":return utils$o.newBlob(utils$o.transformTo("arraybuffer",E),r);case"base64":return base64.encode(E);default:return utils$o.transformTo(t,E)}}function concat(t,E){var r,v=0,T=null,N=0;for(r=0;r<E.length;r++)N+=E[r].length;switch(t){case"string":return E.join("");case"array":return Array.prototype.concat.apply([],E);case"uint8array":for(T=new Uint8Array(N),r=0;r<E.length;r++)T.set(E[r],v),v+=E[r].length;return T;case"nodebuffer":return Buffer.concat(E);default:throw new Error("concat : unsupported type '"+t+"'")}}function accumulate(t,E){return new external$2.Promise(function(r,v){var T=[],N=t._internalType,k=t._outputType,x=t._mimeType;t.on("data",function(ce,ue){T.push(ce),E&&E(ue)}).on("error",function(ce){T=[],v(ce)}).on("end",function(){try{var ce=transformZipOutput(k,concat(N,T),x);r(ce)}catch(ue){v(ue)}T=[]}).resume()})}function StreamHelper$2(t,E,r){var v=E;switch(E){case"blob":case"arraybuffer":v="uint8array";break;case"base64":v="string";break}try{this._internalType=v,this._outputType=E,this._mimeType=r,utils$o.checkSupport(v),this._worker=t.pipe(new ConvertWorker(v)),t.lock()}catch(T){this._worker=new GenericWorker$9("error"),this._worker.error(T)}}StreamHelper$2.prototype={accumulate:function(t){return accumulate(this,t)},on:function(t,E){var r=this;return t==="data"?this._worker.on(t,function(v){E.call(r,v.data,v.meta)}):this._worker.on(t,function(){utils$o.delay(E,arguments,r)}),this},resume:function(){return utils$o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(t){if(utils$o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new NodejsStreamOutputAdapter(this,{objectMode:this._outputType!=="nodebuffer"},t)}};var StreamHelper_1=StreamHelper$2,defaults$1={};defaults$1.base64=!1,defaults$1.binary=!1,defaults$1.dir=!1,defaults$1.createFolders=!0,defaults$1.date=null,defaults$1.compression=null,defaults$1.compressionOptions=null,defaults$1.comment=null,defaults$1.unixPermissions=null,defaults$1.dosPermissions=null;var utils$n=utils$r,GenericWorker$8=GenericWorker_1,DEFAULT_BLOCK_SIZE=16*1024;function DataWorker$2(t){GenericWorker$8.call(this,"DataWorker");var E=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,t.then(function(r){E.dataIsReady=!0,E.data=r,E.max=r&&r.length||0,E.type=utils$n.getTypeOf(r),E.isPaused||E._tickAndRepeat()},function(r){E.error(r)})}utils$n.inherits(DataWorker$2,GenericWorker$8),DataWorker$2.prototype.cleanUp=function(){GenericWorker$8.prototype.cleanUp.call(this),this.data=null},DataWorker$2.prototype.resume=function(){return GenericWorker$8.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,utils$n.delay(this._tickAndRepeat,[],this)),!0):!1},DataWorker$2.prototype._tickAndRepeat=function(){this._tickScheduled=!1,!(this.isPaused||this.isFinished)&&(this._tick(),this.isFinished||(utils$n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},DataWorker$2.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var t=DEFAULT_BLOCK_SIZE,E=null,r=Math.min(this.max,this.index+t);if(this.index>=this.max)return this.end();switch(this.type){case"string":E=this.data.substring(this.index,r);break;case"uint8array":E=this.data.subarray(this.index,r);break;case"array":case"nodebuffer":E=this.data.slice(this.index,r);break}return this.index=r,this.push({data:E,meta:{percent:this.max?this.index/this.max*100:0}})};var DataWorker_1=DataWorker$2,utils$m=utils$r;function makeTable$1(){for(var t,E=[],r=0;r<256;r++){t=r;for(var v=0;v<8;v++)t=t&1?3988292384^t>>>1:t>>>1;E[r]=t}return E}var crcTable$1=makeTable$1();function crc32$5(t,E,r,v){var T=crcTable$1,N=v+r;t=t^-1;for(var k=v;k<N;k++)t=t>>>8^T[(t^E[k])&255];return t^-1}function crc32str(t,E,r,v){var T=crcTable$1,N=v+r;t=t^-1;for(var k=v;k<N;k++)t=t>>>8^T[(t^E.charCodeAt(k))&255];return t^-1}var crc32_1$1=function(E,r){if(typeof E=="undefined"||!E.length)return 0;var v=utils$m.getTypeOf(E)!=="string";return v?crc32$5(r|0,E,E.length,0):crc32str(r|0,E,E.length,0)},GenericWorker$7=GenericWorker_1,crc32$4=crc32_1$1,utils$l=utils$r;function Crc32Probe$2(){GenericWorker$7.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}utils$l.inherits(Crc32Probe$2,GenericWorker$7),Crc32Probe$2.prototype.processChunk=function(t){this.streamInfo.crc32=crc32$4(t.data,this.streamInfo.crc32||0),this.push(t)};var Crc32Probe_1=Crc32Probe$2,utils$k=utils$r,GenericWorker$6=GenericWorker_1;function DataLengthProbe$1(t){GenericWorker$6.call(this,"DataLengthProbe for "+t),this.propName=t,this.withStreamInfo(t,0)}utils$k.inherits(DataLengthProbe$1,GenericWorker$6),DataLengthProbe$1.prototype.processChunk=function(t){if(t){var E=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=E+t.data.length}GenericWorker$6.prototype.processChunk.call(this,t)};var DataLengthProbe_1=DataLengthProbe$1,external$1=external$3,DataWorker$1=DataWorker_1,Crc32Probe$1=Crc32Probe_1,DataLengthProbe=DataLengthProbe_1;function CompressedObject$3(t,E,r,v,T){this.compressedSize=t,this.uncompressedSize=E,this.crc32=r,this.compression=v,this.compressedContent=T}CompressedObject$3.prototype={getContentWorker:function(){var t=new DataWorker$1(external$1.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new DataLengthProbe("data_length")),E=this;return t.on("end",function(){if(this.streamInfo.data_length!==E.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),t},getCompressedWorker:function(){return new DataWorker$1(external$1.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},CompressedObject$3.createWorkerFrom=function(t,E,r){return t.pipe(new Crc32Probe$1).pipe(new DataLengthProbe("uncompressedSize")).pipe(E.compressWorker(r)).pipe(new DataLengthProbe("compressedSize")).withStreamInfo("compression",E)};var compressedObject=CompressedObject$3,StreamHelper$1=StreamHelper_1,DataWorker=DataWorker_1,utf8$4=utf8$5,CompressedObject$2=compressedObject,GenericWorker$5=GenericWorker_1,ZipObject$1=function(t,E,r){this.name=t,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=E,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}};ZipObject$1.prototype={internalStream:function(t){var E=null,r="string";try{if(!t)throw new Error("No output type specified.");r=t.toLowerCase();var v=r==="string"||r==="text";(r==="binarystring"||r==="text")&&(r="string"),E=this._decompressWorker();var T=!this._dataBinary;T&&!v&&(E=E.pipe(new utf8$4.Utf8EncodeWorker)),!T&&v&&(E=E.pipe(new utf8$4.Utf8DecodeWorker))}catch(N){E=new GenericWorker$5("error"),E.error(N)}return new StreamHelper$1(E,r,"")},async:function(t,E){return this.internalStream(t).accumulate(E)},nodeStream:function(t,E){return this.internalStream(t||"nodebuffer").toNodejsStream(E)},_compressWorker:function(t,E){if(this._data instanceof CompressedObject$2&&this._data.compression.magic===t.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new utf8$4.Utf8EncodeWorker)),CompressedObject$2.createWorkerFrom(r,t,E)},_decompressWorker:function(){return this._data instanceof CompressedObject$2?this._data.getContentWorker():this._data instanceof GenericWorker$5?this._data:new DataWorker(this._data)}};for(var removedMethods=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],removedFn=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},i$1=0;i$1<removedMethods.length;i$1++)ZipObject$1.prototype[removedMethods[i$1]]=removedFn;var zipObject=ZipObject$1,generate$1={},compressions$2={},flate={},common={};(function(t){var E=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";function r(N,k){return Object.prototype.hasOwnProperty.call(N,k)}t.assign=function(N){for(var k=Array.prototype.slice.call(arguments,1);k.length;){var x=k.shift();if(x){if(typeof x!="object")throw new TypeError(x+"must be non-object");for(var ce in x)r(x,ce)&&(N[ce]=x[ce])}}return N},t.shrinkBuf=function(N,k){return N.length===k?N:N.subarray?N.subarray(0,k):(N.length=k,N)};var v={arraySet:function(N,k,x,ce,ue){if(k.subarray&&N.subarray){N.set(k.subarray(x,x+ce),ue);return}for(var Z=0;Z<ce;Z++)N[ue+Z]=k[x+Z]},flattenChunks:function(N){var k,x,ce,ue,Z,$e;for(ce=0,k=0,x=N.length;k<x;k++)ce+=N[k].length;for($e=new Uint8Array(ce),ue=0,k=0,x=N.length;k<x;k++)Z=N[k],$e.set(Z,ue),ue+=Z.length;return $e}},T={arraySet:function(N,k,x,ce,ue){for(var Z=0;Z<ce;Z++)N[ue+Z]=k[x+Z]},flattenChunks:function(N){return[].concat.apply([],N)}};t.setTyped=function(N){N?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,v)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,T))},t.setTyped(E)})(common);var deflate$4={},deflate$3={},trees$1={},utils$j=common,Z_FIXED$1=4,Z_BINARY=0,Z_TEXT=1,Z_UNKNOWN$1=2;function zero$1(t){for(var E=t.length;--E>=0;)t[E]=0}var STORED_BLOCK=0,STATIC_TREES=1,DYN_TREES=2,MIN_MATCH$1=3,MAX_MATCH$1=258,LENGTH_CODES$1=29,LITERALS$1=256,L_CODES$1=LITERALS$1+1+LENGTH_CODES$1,D_CODES$1=30,BL_CODES$1=19,HEAP_SIZE$1=2*L_CODES$1+1,MAX_BITS$1=15,Buf_size=16,MAX_BL_BITS=7,END_BLOCK=256,REP_3_6=16,REPZ_3_10=17,REPZ_11_138=18,extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],DIST_CODE_LEN=512,static_ltree=new Array((L_CODES$1+2)*2);zero$1(static_ltree);var static_dtree=new Array(D_CODES$1*2);zero$1(static_dtree);var _dist_code=new Array(DIST_CODE_LEN);zero$1(_dist_code);var _length_code=new Array(MAX_MATCH$1-MIN_MATCH$1+1);zero$1(_length_code);var base_length=new Array(LENGTH_CODES$1);zero$1(base_length);var base_dist=new Array(D_CODES$1);zero$1(base_dist);function StaticTreeDesc(t,E,r,v,T){this.static_tree=t,this.extra_bits=E,this.extra_base=r,this.elems=v,this.max_length=T,this.has_stree=t&&t.length}var static_l_desc,static_d_desc,static_bl_desc;function TreeDesc(t,E){this.dyn_tree=t,this.max_code=0,this.stat_desc=E}function d_code(t){return t<256?_dist_code[t]:_dist_code[256+(t>>>7)]}function put_short(t,E){t.pending_buf[t.pending++]=E&255,t.pending_buf[t.pending++]=E>>>8&255}function send_bits(t,E,r){t.bi_valid>Buf_size-r?(t.bi_buf|=E<<t.bi_valid&65535,put_short(t,t.bi_buf),t.bi_buf=E>>Buf_size-t.bi_valid,t.bi_valid+=r-Buf_size):(t.bi_buf|=E<<t.bi_valid&65535,t.bi_valid+=r)}function send_code(t,E,r){send_bits(t,r[E*2],r[E*2+1])}function bi_reverse(t,E){var r=0;do r|=t&1,t>>>=1,r<<=1;while(--E>0);return r>>>1}function bi_flush(t){t.bi_valid===16?(put_short(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=t.bi_buf&255,t.bi_buf>>=8,t.bi_valid-=8)}function gen_bitlen(t,E){var r=E.dyn_tree,v=E.max_code,T=E.stat_desc.static_tree,N=E.stat_desc.has_stree,k=E.stat_desc.extra_bits,x=E.stat_desc.extra_base,ce=E.stat_desc.max_length,ue,Z,$e,Ee,ge,ye,Te=0;for(Ee=0;Ee<=MAX_BITS$1;Ee++)t.bl_count[Ee]=0;for(r[t.heap[t.heap_max]*2+1]=0,ue=t.heap_max+1;ue<HEAP_SIZE$1;ue++)Z=t.heap[ue],Ee=r[r[Z*2+1]*2+1]+1,Ee>ce&&(Ee=ce,Te++),r[Z*2+1]=Ee,!(Z>v)&&(t.bl_count[Ee]++,ge=0,Z>=x&&(ge=k[Z-x]),ye=r[Z*2],t.opt_len+=ye*(Ee+ge),N&&(t.static_len+=ye*(T[Z*2+1]+ge)));if(Te!==0){do{for(Ee=ce-1;t.bl_count[Ee]===0;)Ee--;t.bl_count[Ee]--,t.bl_count[Ee+1]+=2,t.bl_count[ce]--,Te-=2}while(Te>0);for(Ee=ce;Ee!==0;Ee--)for(Z=t.bl_count[Ee];Z!==0;)$e=t.heap[--ue],!($e>v)&&(r[$e*2+1]!==Ee&&(t.opt_len+=(Ee-r[$e*2+1])*r[$e*2],r[$e*2+1]=Ee),Z--)}}function gen_codes(t,E,r){var v=new Array(MAX_BITS$1+1),T=0,N,k;for(N=1;N<=MAX_BITS$1;N++)v[N]=T=T+r[N-1]<<1;for(k=0;k<=E;k++){var x=t[k*2+1];x!==0&&(t[k*2]=bi_reverse(v[x]++,x))}}function tr_static_init(){var t,E,r,v,T,N=new Array(MAX_BITS$1+1);for(r=0,v=0;v<LENGTH_CODES$1-1;v++)for(base_length[v]=r,t=0;t<1<<extra_lbits[v];t++)_length_code[r++]=v;for(_length_code[r-1]=v,T=0,v=0;v<16;v++)for(base_dist[v]=T,t=0;t<1<<extra_dbits[v];t++)_dist_code[T++]=v;for(T>>=7;v<D_CODES$1;v++)for(base_dist[v]=T<<7,t=0;t<1<<extra_dbits[v]-7;t++)_dist_code[256+T++]=v;for(E=0;E<=MAX_BITS$1;E++)N[E]=0;for(t=0;t<=143;)static_ltree[t*2+1]=8,t++,N[8]++;for(;t<=255;)static_ltree[t*2+1]=9,t++,N[9]++;for(;t<=279;)static_ltree[t*2+1]=7,t++,N[7]++;for(;t<=287;)static_ltree[t*2+1]=8,t++,N[8]++;for(gen_codes(static_ltree,L_CODES$1+1,N),t=0;t<D_CODES$1;t++)static_dtree[t*2+1]=5,static_dtree[t*2]=bi_reverse(t,5);static_l_desc=new StaticTreeDesc(static_ltree,extra_lbits,LITERALS$1+1,L_CODES$1,MAX_BITS$1),static_d_desc=new StaticTreeDesc(static_dtree,extra_dbits,0,D_CODES$1,MAX_BITS$1),static_bl_desc=new StaticTreeDesc(new Array(0),extra_blbits,0,BL_CODES$1,MAX_BL_BITS)}function init_block(t){var E;for(E=0;E<L_CODES$1;E++)t.dyn_ltree[E*2]=0;for(E=0;E<D_CODES$1;E++)t.dyn_dtree[E*2]=0;for(E=0;E<BL_CODES$1;E++)t.bl_tree[E*2]=0;t.dyn_ltree[END_BLOCK*2]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function bi_windup(t){t.bi_valid>8?put_short(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function copy_block(t,E,r,v){bi_windup(t),v&&(put_short(t,r),put_short(t,~r)),utils$j.arraySet(t.pending_buf,t.window,E,r,t.pending),t.pending+=r}function smaller(t,E,r,v){var T=E*2,N=r*2;return t[T]<t[N]||t[T]===t[N]&&v[E]<=v[r]}function pqdownheap(t,E,r){for(var v=t.heap[r],T=r<<1;T<=t.heap_len&&(T<t.heap_len&&smaller(E,t.heap[T+1],t.heap[T],t.depth)&&T++,!smaller(E,v,t.heap[T],t.depth));)t.heap[r]=t.heap[T],r=T,T<<=1;t.heap[r]=v}function compress_block(t,E,r){var v,T,N=0,k,x;if(t.last_lit!==0)do v=t.pending_buf[t.d_buf+N*2]<<8|t.pending_buf[t.d_buf+N*2+1],T=t.pending_buf[t.l_buf+N],N++,v===0?send_code(t,T,E):(k=_length_code[T],send_code(t,k+LITERALS$1+1,E),x=extra_lbits[k],x!==0&&(T-=base_length[k],send_bits(t,T,x)),v--,k=d_code(v),send_code(t,k,r),x=extra_dbits[k],x!==0&&(v-=base_dist[k],send_bits(t,v,x)));while(N<t.last_lit);send_code(t,END_BLOCK,E)}function build_tree(t,E){var r=E.dyn_tree,v=E.stat_desc.static_tree,T=E.stat_desc.has_stree,N=E.stat_desc.elems,k,x,ce=-1,ue;for(t.heap_len=0,t.heap_max=HEAP_SIZE$1,k=0;k<N;k++)r[k*2]!==0?(t.heap[++t.heap_len]=ce=k,t.depth[k]=0):r[k*2+1]=0;for(;t.heap_len<2;)ue=t.heap[++t.heap_len]=ce<2?++ce:0,r[ue*2]=1,t.depth[ue]=0,t.opt_len--,T&&(t.static_len-=v[ue*2+1]);for(E.max_code=ce,k=t.heap_len>>1;k>=1;k--)pqdownheap(t,r,k);ue=N;do k=t.heap[1],t.heap[1]=t.heap[t.heap_len--],pqdownheap(t,r,1),x=t.heap[1],t.heap[--t.heap_max]=k,t.heap[--t.heap_max]=x,r[ue*2]=r[k*2]+r[x*2],t.depth[ue]=(t.depth[k]>=t.depth[x]?t.depth[k]:t.depth[x])+1,r[k*2+1]=r[x*2+1]=ue,t.heap[1]=ue++,pqdownheap(t,r,1);while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],gen_bitlen(t,E),gen_codes(r,ce,t.bl_count)}function scan_tree(t,E,r){var v,T=-1,N,k=E[0*2+1],x=0,ce=7,ue=4;for(k===0&&(ce=138,ue=3),E[(r+1)*2+1]=65535,v=0;v<=r;v++)N=k,k=E[(v+1)*2+1],!(++x<ce&&N===k)&&(x<ue?t.bl_tree[N*2]+=x:N!==0?(N!==T&&t.bl_tree[N*2]++,t.bl_tree[REP_3_6*2]++):x<=10?t.bl_tree[REPZ_3_10*2]++:t.bl_tree[REPZ_11_138*2]++,x=0,T=N,k===0?(ce=138,ue=3):N===k?(ce=6,ue=3):(ce=7,ue=4))}function send_tree(t,E,r){var v,T=-1,N,k=E[0*2+1],x=0,ce=7,ue=4;for(k===0&&(ce=138,ue=3),v=0;v<=r;v++)if(N=k,k=E[(v+1)*2+1],!(++x<ce&&N===k)){if(x<ue)do send_code(t,N,t.bl_tree);while(--x!==0);else N!==0?(N!==T&&(send_code(t,N,t.bl_tree),x--),send_code(t,REP_3_6,t.bl_tree),send_bits(t,x-3,2)):x<=10?(send_code(t,REPZ_3_10,t.bl_tree),send_bits(t,x-3,3)):(send_code(t,REPZ_11_138,t.bl_tree),send_bits(t,x-11,7));x=0,T=N,k===0?(ce=138,ue=3):N===k?(ce=6,ue=3):(ce=7,ue=4)}}function build_bl_tree(t){var E;for(scan_tree(t,t.dyn_ltree,t.l_desc.max_code),scan_tree(t,t.dyn_dtree,t.d_desc.max_code),build_tree(t,t.bl_desc),E=BL_CODES$1-1;E>=3&&t.bl_tree[bl_order[E]*2+1]===0;E--);return t.opt_len+=3*(E+1)+5+5+4,E}function send_all_trees(t,E,r,v){var T;for(send_bits(t,E-257,5),send_bits(t,r-1,5),send_bits(t,v-4,4),T=0;T<v;T++)send_bits(t,t.bl_tree[bl_order[T]*2+1],3);send_tree(t,t.dyn_ltree,E-1),send_tree(t,t.dyn_dtree,r-1)}function detect_data_type(t){var E=4093624447,r;for(r=0;r<=31;r++,E>>>=1)if(E&1&&t.dyn_ltree[r*2]!==0)return Z_BINARY;if(t.dyn_ltree[9*2]!==0||t.dyn_ltree[10*2]!==0||t.dyn_ltree[13*2]!==0)return Z_TEXT;for(r=32;r<LITERALS$1;r++)if(t.dyn_ltree[r*2]!==0)return Z_TEXT;return Z_BINARY}var static_init_done=!1;function _tr_init(t){static_init_done||(tr_static_init(),static_init_done=!0),t.l_desc=new TreeDesc(t.dyn_ltree,static_l_desc),t.d_desc=new TreeDesc(t.dyn_dtree,static_d_desc),t.bl_desc=new TreeDesc(t.bl_tree,static_bl_desc),t.bi_buf=0,t.bi_valid=0,init_block(t)}function _tr_stored_block(t,E,r,v){send_bits(t,(STORED_BLOCK<<1)+(v?1:0),3),copy_block(t,E,r,!0)}function _tr_align(t){send_bits(t,STATIC_TREES<<1,3),send_code(t,END_BLOCK,static_ltree),bi_flush(t)}function _tr_flush_block(t,E,r,v){var T,N,k=0;t.level>0?(t.strm.data_type===Z_UNKNOWN$1&&(t.strm.data_type=detect_data_type(t)),build_tree(t,t.l_desc),build_tree(t,t.d_desc),k=build_bl_tree(t),T=t.opt_len+3+7>>>3,N=t.static_len+3+7>>>3,N<=T&&(T=N)):T=N=r+5,r+4<=T&&E!==-1?_tr_stored_block(t,E,r,v):t.strategy===Z_FIXED$1||N===T?(send_bits(t,(STATIC_TREES<<1)+(v?1:0),3),compress_block(t,static_ltree,static_dtree)):(send_bits(t,(DYN_TREES<<1)+(v?1:0),3),send_all_trees(t,t.l_desc.max_code+1,t.d_desc.max_code+1,k+1),compress_block(t,t.dyn_ltree,t.dyn_dtree)),init_block(t),v&&bi_windup(t)}function _tr_tally(t,E,r){return t.pending_buf[t.d_buf+t.last_lit*2]=E>>>8&255,t.pending_buf[t.d_buf+t.last_lit*2+1]=E&255,t.pending_buf[t.l_buf+t.last_lit]=r&255,t.last_lit++,E===0?t.dyn_ltree[r*2]++:(t.matches++,E--,t.dyn_ltree[(_length_code[r]+LITERALS$1+1)*2]++,t.dyn_dtree[d_code(E)*2]++),t.last_lit===t.lit_bufsize-1}trees$1._tr_init=_tr_init,trees$1._tr_stored_block=_tr_stored_block,trees$1._tr_flush_block=_tr_flush_block,trees$1._tr_tally=_tr_tally,trees$1._tr_align=_tr_align;function adler32$2(t,E,r,v){for(var T=t&65535|0,N=t>>>16&65535|0,k=0;r!==0;){k=r>2e3?2e3:r,r-=k;do T=T+E[v++]|0,N=N+T|0;while(--k);T%=65521,N%=65521}return T|N<<16|0}var adler32_1=adler32$2;function makeTable(){for(var t,E=[],r=0;r<256;r++){t=r;for(var v=0;v<8;v++)t=t&1?3988292384^t>>>1:t>>>1;E[r]=t}return E}var crcTable=makeTable();function crc32$3(t,E,r,v){var T=crcTable,N=v+r;t^=-1;for(var k=v;k<N;k++)t=t>>>8^T[(t^E[k])&255];return t^-1}var crc32_1=crc32$3,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},utils$i=common,trees=trees$1,adler32$1=adler32_1,crc32$2=crc32_1,msg$2=messages,Z_NO_FLUSH$1=0,Z_PARTIAL_FLUSH=1,Z_FULL_FLUSH=3,Z_FINISH$2=4,Z_BLOCK$1=5,Z_OK$2=0,Z_STREAM_END$2=1,Z_STREAM_ERROR$1=-2,Z_DATA_ERROR$1=-3,Z_BUF_ERROR$1=-5,Z_DEFAULT_COMPRESSION$1=-1,Z_FILTERED=1,Z_HUFFMAN_ONLY=2,Z_RLE=3,Z_FIXED=4,Z_DEFAULT_STRATEGY$1=0,Z_UNKNOWN=2,Z_DEFLATED$2=8,MAX_MEM_LEVEL=9,MAX_WBITS$1=15,DEF_MEM_LEVEL=8,LENGTH_CODES=29,LITERALS=256,L_CODES=LITERALS+1+LENGTH_CODES,D_CODES=30,BL_CODES=19,HEAP_SIZE=2*L_CODES+1,MAX_BITS=15,MIN_MATCH=3,MAX_MATCH=258,MIN_LOOKAHEAD=MAX_MATCH+MIN_MATCH+1,PRESET_DICT=32,INIT_STATE=42,EXTRA_STATE=69,NAME_STATE=73,COMMENT_STATE=91,HCRC_STATE=103,BUSY_STATE=113,FINISH_STATE=666,BS_NEED_MORE=1,BS_BLOCK_DONE=2,BS_FINISH_STARTED=3,BS_FINISH_DONE=4,OS_CODE=3;function err(t,E){return t.msg=msg$2[E],E}function rank(t){return(t<<1)-(t>4?9:0)}function zero(t){for(var E=t.length;--E>=0;)t[E]=0}function flush_pending(t){var E=t.state,r=E.pending;r>t.avail_out&&(r=t.avail_out),r!==0&&(utils$i.arraySet(t.output,E.pending_buf,E.pending_out,r,t.next_out),t.next_out+=r,E.pending_out+=r,t.total_out+=r,t.avail_out-=r,E.pending-=r,E.pending===0&&(E.pending_out=0))}function flush_block_only(t,E){trees._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,E),t.block_start=t.strstart,flush_pending(t.strm)}function put_byte(t,E){t.pending_buf[t.pending++]=E}function putShortMSB(t,E){t.pending_buf[t.pending++]=E>>>8&255,t.pending_buf[t.pending++]=E&255}function read_buf(t,E,r,v){var T=t.avail_in;return T>v&&(T=v),T===0?0:(t.avail_in-=T,utils$i.arraySet(E,t.input,t.next_in,T,r),t.state.wrap===1?t.adler=adler32$1(t.adler,E,T,r):t.state.wrap===2&&(t.adler=crc32$2(t.adler,E,T,r)),t.next_in+=T,t.total_in+=T,T)}function longest_match(t,E){var r=t.max_chain_length,v=t.strstart,T,N,k=t.prev_length,x=t.nice_match,ce=t.strstart>t.w_size-MIN_LOOKAHEAD?t.strstart-(t.w_size-MIN_LOOKAHEAD):0,ue=t.window,Z=t.w_mask,$e=t.prev,Ee=t.strstart+MAX_MATCH,ge=ue[v+k-1],ye=ue[v+k];t.prev_length>=t.good_match&&(r>>=2),x>t.lookahead&&(x=t.lookahead);do if(T=E,!(ue[T+k]!==ye||ue[T+k-1]!==ge||ue[T]!==ue[v]||ue[++T]!==ue[v+1])){v+=2,T++;do;while(ue[++v]===ue[++T]&&ue[++v]===ue[++T]&&ue[++v]===ue[++T]&&ue[++v]===ue[++T]&&ue[++v]===ue[++T]&&ue[++v]===ue[++T]&&ue[++v]===ue[++T]&&ue[++v]===ue[++T]&&v<Ee);if(N=MAX_MATCH-(Ee-v),v=Ee-MAX_MATCH,N>k){if(t.match_start=E,k=N,N>=x)break;ge=ue[v+k-1],ye=ue[v+k]}}while((E=$e[E&Z])>ce&&--r!==0);return k<=t.lookahead?k:t.lookahead}function fill_window(t){var E=t.w_size,r,v,T,N,k;do{if(N=t.window_size-t.lookahead-t.strstart,t.strstart>=E+(E-MIN_LOOKAHEAD)){utils$i.arraySet(t.window,t.window,E,E,0),t.match_start-=E,t.strstart-=E,t.block_start-=E,v=t.hash_size,r=v;do T=t.head[--r],t.head[r]=T>=E?T-E:0;while(--v);v=E,r=v;do T=t.prev[--r],t.prev[r]=T>=E?T-E:0;while(--v);N+=E}if(t.strm.avail_in===0)break;if(v=read_buf(t.strm,t.window,t.strstart+t.lookahead,N),t.lookahead+=v,t.lookahead+t.insert>=MIN_MATCH)for(k=t.strstart-t.insert,t.ins_h=t.window[k],t.ins_h=(t.ins_h<<t.hash_shift^t.window[k+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[k+MIN_MATCH-1])&t.hash_mask,t.prev[k&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=k,k++,t.insert--,!(t.lookahead+t.insert<MIN_MATCH)););}while(t.lookahead<MIN_LOOKAHEAD&&t.strm.avail_in!==0)}function deflate_stored(t,E){var r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(fill_window(t),t.lookahead===0&&E===Z_NO_FLUSH$1)return BS_NEED_MORE;if(t.lookahead===0)break}t.strstart+=t.lookahead,t.lookahead=0;var v=t.block_start+r;if((t.strstart===0||t.strstart>=v)&&(t.lookahead=t.strstart-v,t.strstart=v,flush_block_only(t,!1),t.strm.avail_out===0)||t.strstart-t.block_start>=t.w_size-MIN_LOOKAHEAD&&(flush_block_only(t,!1),t.strm.avail_out===0))return BS_NEED_MORE}return t.insert=0,E===Z_FINISH$2?(flush_block_only(t,!0),t.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):(t.strstart>t.block_start&&(flush_block_only(t,!1),t.strm.avail_out===0),BS_NEED_MORE)}function deflate_fast(t,E){for(var r,v;;){if(t.lookahead<MIN_LOOKAHEAD){if(fill_window(t),t.lookahead<MIN_LOOKAHEAD&&E===Z_NO_FLUSH$1)return BS_NEED_MORE;if(t.lookahead===0)break}if(r=0,t.lookahead>=MIN_MATCH&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+MIN_MATCH-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),r!==0&&t.strstart-r<=t.w_size-MIN_LOOKAHEAD&&(t.match_length=longest_match(t,r)),t.match_length>=MIN_MATCH)if(v=trees._tr_tally(t,t.strstart-t.match_start,t.match_length-MIN_MATCH),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=MIN_MATCH){t.match_length--;do t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+MIN_MATCH-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart;while(--t.match_length!==0);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else v=trees._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(v&&(flush_block_only(t,!1),t.strm.avail_out===0))return BS_NEED_MORE}return t.insert=t.strstart<MIN_MATCH-1?t.strstart:MIN_MATCH-1,E===Z_FINISH$2?(flush_block_only(t,!0),t.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):t.last_lit&&(flush_block_only(t,!1),t.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_slow(t,E){for(var r,v,T;;){if(t.lookahead<MIN_LOOKAHEAD){if(fill_window(t),t.lookahead<MIN_LOOKAHEAD&&E===Z_NO_FLUSH$1)return BS_NEED_MORE;if(t.lookahead===0)break}if(r=0,t.lookahead>=MIN_MATCH&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+MIN_MATCH-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=MIN_MATCH-1,r!==0&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-MIN_LOOKAHEAD&&(t.match_length=longest_match(t,r),t.match_length<=5&&(t.strategy===Z_FILTERED||t.match_length===MIN_MATCH&&t.strstart-t.match_start>4096)&&(t.match_length=MIN_MATCH-1)),t.prev_length>=MIN_MATCH&&t.match_length<=t.prev_length){T=t.strstart+t.lookahead-MIN_MATCH,v=trees._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-MIN_MATCH),t.lookahead-=t.prev_length-1,t.prev_length-=2;do++t.strstart<=T&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+MIN_MATCH-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart);while(--t.prev_length!==0);if(t.match_available=0,t.match_length=MIN_MATCH-1,t.strstart++,v&&(flush_block_only(t,!1),t.strm.avail_out===0))return BS_NEED_MORE}else if(t.match_available){if(v=trees._tr_tally(t,0,t.window[t.strstart-1]),v&&flush_block_only(t,!1),t.strstart++,t.lookahead--,t.strm.avail_out===0)return BS_NEED_MORE}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(v=trees._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<MIN_MATCH-1?t.strstart:MIN_MATCH-1,E===Z_FINISH$2?(flush_block_only(t,!0),t.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):t.last_lit&&(flush_block_only(t,!1),t.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_rle(t,E){for(var r,v,T,N,k=t.window;;){if(t.lookahead<=MAX_MATCH){if(fill_window(t),t.lookahead<=MAX_MATCH&&E===Z_NO_FLUSH$1)return BS_NEED_MORE;if(t.lookahead===0)break}if(t.match_length=0,t.lookahead>=MIN_MATCH&&t.strstart>0&&(T=t.strstart-1,v=k[T],v===k[++T]&&v===k[++T]&&v===k[++T])){N=t.strstart+MAX_MATCH;do;while(v===k[++T]&&v===k[++T]&&v===k[++T]&&v===k[++T]&&v===k[++T]&&v===k[++T]&&v===k[++T]&&v===k[++T]&&T<N);t.match_length=MAX_MATCH-(N-T),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=MIN_MATCH?(r=trees._tr_tally(t,1,t.match_length-MIN_MATCH),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=trees._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(flush_block_only(t,!1),t.strm.avail_out===0))return BS_NEED_MORE}return t.insert=0,E===Z_FINISH$2?(flush_block_only(t,!0),t.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):t.last_lit&&(flush_block_only(t,!1),t.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function deflate_huff(t,E){for(var r;;){if(t.lookahead===0&&(fill_window(t),t.lookahead===0)){if(E===Z_NO_FLUSH$1)return BS_NEED_MORE;break}if(t.match_length=0,r=trees._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(flush_block_only(t,!1),t.strm.avail_out===0))return BS_NEED_MORE}return t.insert=0,E===Z_FINISH$2?(flush_block_only(t,!0),t.strm.avail_out===0?BS_FINISH_STARTED:BS_FINISH_DONE):t.last_lit&&(flush_block_only(t,!1),t.strm.avail_out===0)?BS_NEED_MORE:BS_BLOCK_DONE}function Config(t,E,r,v,T){this.good_length=t,this.max_lazy=E,this.nice_length=r,this.max_chain=v,this.func=T}var configuration_table;configuration_table=[new Config(0,0,0,0,deflate_stored),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)];function lm_init(t){t.window_size=2*t.w_size,zero(t.head),t.max_lazy_match=configuration_table[t.level].max_lazy,t.good_match=configuration_table[t.level].good_length,t.nice_match=configuration_table[t.level].nice_length,t.max_chain_length=configuration_table[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=MIN_MATCH-1,t.match_available=0,t.ins_h=0}function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Z_DEFLATED$2,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new utils$i.Buf16(HEAP_SIZE*2),this.dyn_dtree=new utils$i.Buf16((2*D_CODES+1)*2),this.bl_tree=new utils$i.Buf16((2*BL_CODES+1)*2),zero(this.dyn_ltree),zero(this.dyn_dtree),zero(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new utils$i.Buf16(MAX_BITS+1),this.heap=new utils$i.Buf16(2*L_CODES+1),zero(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new utils$i.Buf16(2*L_CODES+1),zero(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function deflateResetKeep(t){var E;return!t||!t.state?err(t,Z_STREAM_ERROR$1):(t.total_in=t.total_out=0,t.data_type=Z_UNKNOWN,E=t.state,E.pending=0,E.pending_out=0,E.wrap<0&&(E.wrap=-E.wrap),E.status=E.wrap?INIT_STATE:BUSY_STATE,t.adler=E.wrap===2?0:1,E.last_flush=Z_NO_FLUSH$1,trees._tr_init(E),Z_OK$2)}function deflateReset(t){var E=deflateResetKeep(t);return E===Z_OK$2&&lm_init(t.state),E}function deflateSetHeader(t,E){return!t||!t.state||t.state.wrap!==2?Z_STREAM_ERROR$1:(t.state.gzhead=E,Z_OK$2)}function deflateInit2(t,E,r,v,T,N){if(!t)return Z_STREAM_ERROR$1;var k=1;if(E===Z_DEFAULT_COMPRESSION$1&&(E=6),v<0?(k=0,v=-v):v>15&&(k=2,v-=16),T<1||T>MAX_MEM_LEVEL||r!==Z_DEFLATED$2||v<8||v>15||E<0||E>9||N<0||N>Z_FIXED)return err(t,Z_STREAM_ERROR$1);v===8&&(v=9);var x=new DeflateState;return t.state=x,x.strm=t,x.wrap=k,x.gzhead=null,x.w_bits=v,x.w_size=1<<x.w_bits,x.w_mask=x.w_size-1,x.hash_bits=T+7,x.hash_size=1<<x.hash_bits,x.hash_mask=x.hash_size-1,x.hash_shift=~~((x.hash_bits+MIN_MATCH-1)/MIN_MATCH),x.window=new utils$i.Buf8(x.w_size*2),x.head=new utils$i.Buf16(x.hash_size),x.prev=new utils$i.Buf16(x.w_size),x.lit_bufsize=1<<T+6,x.pending_buf_size=x.lit_bufsize*4,x.pending_buf=new utils$i.Buf8(x.pending_buf_size),x.d_buf=1*x.lit_bufsize,x.l_buf=3*x.lit_bufsize,x.level=E,x.strategy=N,x.method=r,deflateReset(t)}function deflateInit(t,E){return deflateInit2(t,E,Z_DEFLATED$2,MAX_WBITS$1,DEF_MEM_LEVEL,Z_DEFAULT_STRATEGY$1)}function deflate$2(t,E){var r,v,T,N;if(!t||!t.state||E>Z_BLOCK$1||E<0)return t?err(t,Z_STREAM_ERROR$1):Z_STREAM_ERROR$1;if(v=t.state,!t.output||!t.input&&t.avail_in!==0||v.status===FINISH_STATE&&E!==Z_FINISH$2)return err(t,t.avail_out===0?Z_BUF_ERROR$1:Z_STREAM_ERROR$1);if(v.strm=t,r=v.last_flush,v.last_flush=E,v.status===INIT_STATE)if(v.wrap===2)t.adler=0,put_byte(v,31),put_byte(v,139),put_byte(v,8),v.gzhead?(put_byte(v,(v.gzhead.text?1:0)+(v.gzhead.hcrc?2:0)+(v.gzhead.extra?4:0)+(v.gzhead.name?8:0)+(v.gzhead.comment?16:0)),put_byte(v,v.gzhead.time&255),put_byte(v,v.gzhead.time>>8&255),put_byte(v,v.gzhead.time>>16&255),put_byte(v,v.gzhead.time>>24&255),put_byte(v,v.level===9?2:v.strategy>=Z_HUFFMAN_ONLY||v.level<2?4:0),put_byte(v,v.gzhead.os&255),v.gzhead.extra&&v.gzhead.extra.length&&(put_byte(v,v.gzhead.extra.length&255),put_byte(v,v.gzhead.extra.length>>8&255)),v.gzhead.hcrc&&(t.adler=crc32$2(t.adler,v.pending_buf,v.pending,0)),v.gzindex=0,v.status=EXTRA_STATE):(put_byte(v,0),put_byte(v,0),put_byte(v,0),put_byte(v,0),put_byte(v,0),put_byte(v,v.level===9?2:v.strategy>=Z_HUFFMAN_ONLY||v.level<2?4:0),put_byte(v,OS_CODE),v.status=BUSY_STATE);else{var k=Z_DEFLATED$2+(v.w_bits-8<<4)<<8,x=-1;v.strategy>=Z_HUFFMAN_ONLY||v.level<2?x=0:v.level<6?x=1:v.level===6?x=2:x=3,k|=x<<6,v.strstart!==0&&(k|=PRESET_DICT),k+=31-k%31,v.status=BUSY_STATE,putShortMSB(v,k),v.strstart!==0&&(putShortMSB(v,t.adler>>>16),putShortMSB(v,t.adler&65535)),t.adler=1}if(v.status===EXTRA_STATE)if(v.gzhead.extra){for(T=v.pending;v.gzindex<(v.gzhead.extra.length&65535)&&!(v.pending===v.pending_buf_size&&(v.gzhead.hcrc&&v.pending>T&&(t.adler=crc32$2(t.adler,v.pending_buf,v.pending-T,T)),flush_pending(t),T=v.pending,v.pending===v.pending_buf_size));)put_byte(v,v.gzhead.extra[v.gzindex]&255),v.gzindex++;v.gzhead.hcrc&&v.pending>T&&(t.adler=crc32$2(t.adler,v.pending_buf,v.pending-T,T)),v.gzindex===v.gzhead.extra.length&&(v.gzindex=0,v.status=NAME_STATE)}else v.status=NAME_STATE;if(v.status===NAME_STATE)if(v.gzhead.name){T=v.pending;do{if(v.pending===v.pending_buf_size&&(v.gzhead.hcrc&&v.pending>T&&(t.adler=crc32$2(t.adler,v.pending_buf,v.pending-T,T)),flush_pending(t),T=v.pending,v.pending===v.pending_buf_size)){N=1;break}v.gzindex<v.gzhead.name.length?N=v.gzhead.name.charCodeAt(v.gzindex++)&255:N=0,put_byte(v,N)}while(N!==0);v.gzhead.hcrc&&v.pending>T&&(t.adler=crc32$2(t.adler,v.pending_buf,v.pending-T,T)),N===0&&(v.gzindex=0,v.status=COMMENT_STATE)}else v.status=COMMENT_STATE;if(v.status===COMMENT_STATE)if(v.gzhead.comment){T=v.pending;do{if(v.pending===v.pending_buf_size&&(v.gzhead.hcrc&&v.pending>T&&(t.adler=crc32$2(t.adler,v.pending_buf,v.pending-T,T)),flush_pending(t),T=v.pending,v.pending===v.pending_buf_size)){N=1;break}v.gzindex<v.gzhead.comment.length?N=v.gzhead.comment.charCodeAt(v.gzindex++)&255:N=0,put_byte(v,N)}while(N!==0);v.gzhead.hcrc&&v.pending>T&&(t.adler=crc32$2(t.adler,v.pending_buf,v.pending-T,T)),N===0&&(v.status=HCRC_STATE)}else v.status=HCRC_STATE;if(v.status===HCRC_STATE&&(v.gzhead.hcrc?(v.pending+2>v.pending_buf_size&&flush_pending(t),v.pending+2<=v.pending_buf_size&&(put_byte(v,t.adler&255),put_byte(v,t.adler>>8&255),t.adler=0,v.status=BUSY_STATE)):v.status=BUSY_STATE),v.pending!==0){if(flush_pending(t),t.avail_out===0)return v.last_flush=-1,Z_OK$2}else if(t.avail_in===0&&rank(E)<=rank(r)&&E!==Z_FINISH$2)return err(t,Z_BUF_ERROR$1);if(v.status===FINISH_STATE&&t.avail_in!==0)return err(t,Z_BUF_ERROR$1);if(t.avail_in!==0||v.lookahead!==0||E!==Z_NO_FLUSH$1&&v.status!==FINISH_STATE){var ce=v.strategy===Z_HUFFMAN_ONLY?deflate_huff(v,E):v.strategy===Z_RLE?deflate_rle(v,E):configuration_table[v.level].func(v,E);if((ce===BS_FINISH_STARTED||ce===BS_FINISH_DONE)&&(v.status=FINISH_STATE),ce===BS_NEED_MORE||ce===BS_FINISH_STARTED)return t.avail_out===0&&(v.last_flush=-1),Z_OK$2;if(ce===BS_BLOCK_DONE&&(E===Z_PARTIAL_FLUSH?trees._tr_align(v):E!==Z_BLOCK$1&&(trees._tr_stored_block(v,0,0,!1),E===Z_FULL_FLUSH&&(zero(v.head),v.lookahead===0&&(v.strstart=0,v.block_start=0,v.insert=0))),flush_pending(t),t.avail_out===0))return v.last_flush=-1,Z_OK$2}return E!==Z_FINISH$2?Z_OK$2:v.wrap<=0?Z_STREAM_END$2:(v.wrap===2?(put_byte(v,t.adler&255),put_byte(v,t.adler>>8&255),put_byte(v,t.adler>>16&255),put_byte(v,t.adler>>24&255),put_byte(v,t.total_in&255),put_byte(v,t.total_in>>8&255),put_byte(v,t.total_in>>16&255),put_byte(v,t.total_in>>24&255)):(putShortMSB(v,t.adler>>>16),putShortMSB(v,t.adler&65535)),flush_pending(t),v.wrap>0&&(v.wrap=-v.wrap),v.pending!==0?Z_OK$2:Z_STREAM_END$2)}function deflateEnd(t){var E;return!t||!t.state?Z_STREAM_ERROR$1:(E=t.state.status,E!==INIT_STATE&&E!==EXTRA_STATE&&E!==NAME_STATE&&E!==COMMENT_STATE&&E!==HCRC_STATE&&E!==BUSY_STATE&&E!==FINISH_STATE?err(t,Z_STREAM_ERROR$1):(t.state=null,E===BUSY_STATE?err(t,Z_DATA_ERROR$1):Z_OK$2))}function deflateSetDictionary(t,E){var r=E.length,v,T,N,k,x,ce,ue,Z;if(!t||!t.state||(v=t.state,k=v.wrap,k===2||k===1&&v.status!==INIT_STATE||v.lookahead))return Z_STREAM_ERROR$1;for(k===1&&(t.adler=adler32$1(t.adler,E,r,0)),v.wrap=0,r>=v.w_size&&(k===0&&(zero(v.head),v.strstart=0,v.block_start=0,v.insert=0),Z=new utils$i.Buf8(v.w_size),utils$i.arraySet(Z,E,r-v.w_size,v.w_size,0),E=Z,r=v.w_size),x=t.avail_in,ce=t.next_in,ue=t.input,t.avail_in=r,t.next_in=0,t.input=E,fill_window(v);v.lookahead>=MIN_MATCH;){T=v.strstart,N=v.lookahead-(MIN_MATCH-1);do v.ins_h=(v.ins_h<<v.hash_shift^v.window[T+MIN_MATCH-1])&v.hash_mask,v.prev[T&v.w_mask]=v.head[v.ins_h],v.head[v.ins_h]=T,T++;while(--N);v.strstart=T,v.lookahead=MIN_MATCH-1,fill_window(v)}return v.strstart+=v.lookahead,v.block_start=v.strstart,v.insert=v.lookahead,v.lookahead=0,v.match_length=v.prev_length=MIN_MATCH-1,v.match_available=0,t.next_in=ce,t.input=ue,t.avail_in=x,v.wrap=k,Z_OK$2}deflate$3.deflateInit=deflateInit,deflate$3.deflateInit2=deflateInit2,deflate$3.deflateReset=deflateReset,deflate$3.deflateResetKeep=deflateResetKeep,deflate$3.deflateSetHeader=deflateSetHeader,deflate$3.deflate=deflate$2,deflate$3.deflateEnd=deflateEnd,deflate$3.deflateSetDictionary=deflateSetDictionary,deflate$3.deflateInfo="pako deflate (from Nodeca project)";var strings$2={},utils$h=common,STR_APPLY_OK=!0,STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,[0])}catch(t){STR_APPLY_OK=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){STR_APPLY_UIA_OK=!1}for(var _utf8len=new utils$h.Buf8(256),q=0;q<256;q++)_utf8len[q]=q>=252?6:q>=248?5:q>=240?4:q>=224?3:q>=192?2:1;_utf8len[254]=_utf8len[254]=1,strings$2.string2buf=function(t){var E,r,v,T,N,k=t.length,x=0;for(T=0;T<k;T++)r=t.charCodeAt(T),(r&64512)===55296&&T+1<k&&(v=t.charCodeAt(T+1),(v&64512)===56320&&(r=65536+(r-55296<<10)+(v-56320),T++)),x+=r<128?1:r<2048?2:r<65536?3:4;for(E=new utils$h.Buf8(x),N=0,T=0;N<x;T++)r=t.charCodeAt(T),(r&64512)===55296&&T+1<k&&(v=t.charCodeAt(T+1),(v&64512)===56320&&(r=65536+(r-55296<<10)+(v-56320),T++)),r<128?E[N++]=r:r<2048?(E[N++]=192|r>>>6,E[N++]=128|r&63):r<65536?(E[N++]=224|r>>>12,E[N++]=128|r>>>6&63,E[N++]=128|r&63):(E[N++]=240|r>>>18,E[N++]=128|r>>>12&63,E[N++]=128|r>>>6&63,E[N++]=128|r&63);return E};function buf2binstring(t,E){if(E<65534&&(t.subarray&&STR_APPLY_UIA_OK||!t.subarray&&STR_APPLY_OK))return String.fromCharCode.apply(null,utils$h.shrinkBuf(t,E));for(var r="",v=0;v<E;v++)r+=String.fromCharCode(t[v]);return r}strings$2.buf2binstring=function(t){return buf2binstring(t,t.length)},strings$2.binstring2buf=function(t){for(var E=new utils$h.Buf8(t.length),r=0,v=E.length;r<v;r++)E[r]=t.charCodeAt(r);return E},strings$2.buf2string=function(t,E){var r,v,T,N,k=E||t.length,x=new Array(k*2);for(v=0,r=0;r<k;){if(T=t[r++],T<128){x[v++]=T;continue}if(N=_utf8len[T],N>4){x[v++]=65533,r+=N-1;continue}for(T&=N===2?31:N===3?15:7;N>1&&r<k;)T=T<<6|t[r++]&63,N--;if(N>1){x[v++]=65533;continue}T<65536?x[v++]=T:(T-=65536,x[v++]=55296|T>>10&1023,x[v++]=56320|T&1023)}return buf2binstring(x,v)},strings$2.utf8border=function(t,E){var r;for(E=E||t.length,E>t.length&&(E=t.length),r=E-1;r>=0&&(t[r]&192)===128;)r--;return r<0||r===0?E:r+_utf8len[t[r]]>E?r:E};function ZStream$2(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zstream=ZStream$2,zlib_deflate=deflate$3,utils$g=common,strings$1=strings$2,msg$1=messages,ZStream$1=zstream,toString$1=Object.prototype.toString,Z_NO_FLUSH=0,Z_FINISH$1=4,Z_OK$1=0,Z_STREAM_END$1=1,Z_SYNC_FLUSH=2,Z_DEFAULT_COMPRESSION=-1,Z_DEFAULT_STRATEGY=0,Z_DEFLATED$1=8;function Deflate(t){if(!(this instanceof Deflate))return new Deflate(t);this.options=utils$g.assign({level:Z_DEFAULT_COMPRESSION,method:Z_DEFLATED$1,chunkSize:16384,windowBits:15,memLevel:8,strategy:Z_DEFAULT_STRATEGY,to:""},t||{});var E=this.options;E.raw&&E.windowBits>0?E.windowBits=-E.windowBits:E.gzip&&E.windowBits>0&&E.windowBits<16&&(E.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZStream$1,this.strm.avail_out=0;var r=zlib_deflate.deflateInit2(this.strm,E.level,E.method,E.windowBits,E.memLevel,E.strategy);if(r!==Z_OK$1)throw new Error(msg$1[r]);if(E.header&&zlib_deflate.deflateSetHeader(this.strm,E.header),E.dictionary){var v;if(typeof E.dictionary=="string"?v=strings$1.string2buf(E.dictionary):toString$1.call(E.dictionary)==="[object ArrayBuffer]"?v=new Uint8Array(E.dictionary):v=E.dictionary,r=zlib_deflate.deflateSetDictionary(this.strm,v),r!==Z_OK$1)throw new Error(msg$1[r]);this._dict_set=!0}}Deflate.prototype.push=function(t,E){var r=this.strm,v=this.options.chunkSize,T,N;if(this.ended)return!1;N=E===~~E?E:E===!0?Z_FINISH$1:Z_NO_FLUSH,typeof t=="string"?r.input=strings$1.string2buf(t):toString$1.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;do{if(r.avail_out===0&&(r.output=new utils$g.Buf8(v),r.next_out=0,r.avail_out=v),T=zlib_deflate.deflate(r,N),T!==Z_STREAM_END$1&&T!==Z_OK$1)return this.onEnd(T),this.ended=!0,!1;(r.avail_out===0||r.avail_in===0&&(N===Z_FINISH$1||N===Z_SYNC_FLUSH))&&(this.options.to==="string"?this.onData(strings$1.buf2binstring(utils$g.shrinkBuf(r.output,r.next_out))):this.onData(utils$g.shrinkBuf(r.output,r.next_out)))}while((r.avail_in>0||r.avail_out===0)&&T!==Z_STREAM_END$1);return N===Z_FINISH$1?(T=zlib_deflate.deflateEnd(this.strm),this.onEnd(T),this.ended=!0,T===Z_OK$1):(N===Z_SYNC_FLUSH&&(this.onEnd(Z_OK$1),r.avail_out=0),!0)},Deflate.prototype.onData=function(t){this.chunks.push(t)},Deflate.prototype.onEnd=function(t){t===Z_OK$1&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=utils$g.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function deflate$1(t,E){var r=new Deflate(E);if(r.push(t,!0),r.err)throw r.msg||msg$1[r.err];return r.result}function deflateRaw(t,E){return E=E||{},E.raw=!0,deflate$1(t,E)}function gzip(t,E){return E=E||{},E.gzip=!0,deflate$1(t,E)}deflate$4.Deflate=Deflate,deflate$4.deflate=deflate$1,deflate$4.deflateRaw=deflateRaw,deflate$4.gzip=gzip;var inflate$4={},inflate$3={},BAD$1=30,TYPE$1=12,inffast=function(E,r){var v,T,N,k,x,ce,ue,Z,$e,Ee,ge,ye,Te,Se,Ie,Ae,Re,ke,De,Le,Be,Fe,ve,Ze,Oe;v=E.state,T=E.next_in,Ze=E.input,N=T+(E.avail_in-5),k=E.next_out,Oe=E.output,x=k-(r-E.avail_out),ce=k+(E.avail_out-257),ue=v.dmax,Z=v.wsize,$e=v.whave,Ee=v.wnext,ge=v.window,ye=v.hold,Te=v.bits,Se=v.lencode,Ie=v.distcode,Ae=(1<<v.lenbits)-1,Re=(1<<v.distbits)-1;e:do{Te<15&&(ye+=Ze[T++]<<Te,Te+=8,ye+=Ze[T++]<<Te,Te+=8),ke=Se[ye&Ae];t:for(;;){if(De=ke>>>24,ye>>>=De,Te-=De,De=ke>>>16&255,De===0)Oe[k++]=ke&65535;else if(De&16){Le=ke&65535,De&=15,De&&(Te<De&&(ye+=Ze[T++]<<Te,Te+=8),Le+=ye&(1<<De)-1,ye>>>=De,Te-=De),Te<15&&(ye+=Ze[T++]<<Te,Te+=8,ye+=Ze[T++]<<Te,Te+=8),ke=Ie[ye&Re];r:for(;;){if(De=ke>>>24,ye>>>=De,Te-=De,De=ke>>>16&255,De&16){if(Be=ke&65535,De&=15,Te<De&&(ye+=Ze[T++]<<Te,Te+=8,Te<De&&(ye+=Ze[T++]<<Te,Te+=8)),Be+=ye&(1<<De)-1,Be>ue){E.msg="invalid distance too far back",v.mode=BAD$1;break e}if(ye>>>=De,Te-=De,De=k-x,Be>De){if(De=Be-De,De>$e&&v.sane){E.msg="invalid distance too far back",v.mode=BAD$1;break e}if(Fe=0,ve=ge,Ee===0){if(Fe+=Z-De,De<Le){Le-=De;do Oe[k++]=ge[Fe++];while(--De);Fe=k-Be,ve=Oe}}else if(Ee<De){if(Fe+=Z+Ee-De,De-=Ee,De<Le){Le-=De;do Oe[k++]=ge[Fe++];while(--De);if(Fe=0,Ee<Le){De=Ee,Le-=De;do Oe[k++]=ge[Fe++];while(--De);Fe=k-Be,ve=Oe}}}else if(Fe+=Ee-De,De<Le){Le-=De;do Oe[k++]=ge[Fe++];while(--De);Fe=k-Be,ve=Oe}for(;Le>2;)Oe[k++]=ve[Fe++],Oe[k++]=ve[Fe++],Oe[k++]=ve[Fe++],Le-=3;Le&&(Oe[k++]=ve[Fe++],Le>1&&(Oe[k++]=ve[Fe++]))}else{Fe=k-Be;do Oe[k++]=Oe[Fe++],Oe[k++]=Oe[Fe++],Oe[k++]=Oe[Fe++],Le-=3;while(Le>2);Le&&(Oe[k++]=Oe[Fe++],Le>1&&(Oe[k++]=Oe[Fe++]))}}else if((De&64)===0){ke=Ie[(ke&65535)+(ye&(1<<De)-1)];continue r}else{E.msg="invalid distance code",v.mode=BAD$1;break e}break}}else if((De&64)===0){ke=Se[(ke&65535)+(ye&(1<<De)-1)];continue t}else if(De&32){v.mode=TYPE$1;break e}else{E.msg="invalid literal/length code",v.mode=BAD$1;break e}break}}while(T<N&&k<ce);Le=Te>>3,T-=Le,Te-=Le<<3,ye&=(1<<Te)-1,E.next_in=T,E.next_out=k,E.avail_in=T<N?5+(N-T):5-(T-N),E.avail_out=k<ce?257+(ce-k):257-(k-ce),v.hold=ye,v.bits=Te},utils$f=common,MAXBITS=15,ENOUGH_LENS$1=852,ENOUGH_DISTS$1=592,CODES$1=0,LENS$1=1,DISTS$1=2,lbase=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],lext=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],dbase=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],dext=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64],inftrees=function(E,r,v,T,N,k,x,ce){var ue=ce.bits,Z=0,$e=0,Ee=0,ge=0,ye=0,Te=0,Se=0,Ie=0,Ae=0,Re=0,ke,De,Le,Be,Fe,ve=null,Ze=0,Oe,Me=new utils$f.Buf16(MAXBITS+1),Je=new utils$f.Buf16(MAXBITS+1),et=null,rt=0,ot,Ue,at;for(Z=0;Z<=MAXBITS;Z++)Me[Z]=0;for($e=0;$e<T;$e++)Me[r[v+$e]]++;for(ye=ue,ge=MAXBITS;ge>=1&&Me[ge]===0;ge--);if(ye>ge&&(ye=ge),ge===0)return N[k++]=1<<24|64<<16|0,N[k++]=1<<24|64<<16|0,ce.bits=1,0;for(Ee=1;Ee<ge&&Me[Ee]===0;Ee++);for(ye<Ee&&(ye=Ee),Ie=1,Z=1;Z<=MAXBITS;Z++)if(Ie<<=1,Ie-=Me[Z],Ie<0)return-1;if(Ie>0&&(E===CODES$1||ge!==1))return-1;for(Je[1]=0,Z=1;Z<MAXBITS;Z++)Je[Z+1]=Je[Z]+Me[Z];for($e=0;$e<T;$e++)r[v+$e]!==0&&(x[Je[r[v+$e]]++]=$e);if(E===CODES$1?(ve=et=x,Oe=19):E===LENS$1?(ve=lbase,Ze-=257,et=lext,rt-=257,Oe=256):(ve=dbase,et=dext,Oe=-1),Re=0,$e=0,Z=Ee,Fe=k,Te=ye,Se=0,Le=-1,Ae=1<<ye,Be=Ae-1,E===LENS$1&&Ae>ENOUGH_LENS$1||E===DISTS$1&&Ae>ENOUGH_DISTS$1)return 1;for(;;){ot=Z-Se,x[$e]<Oe?(Ue=0,at=x[$e]):x[$e]>Oe?(Ue=et[rt+x[$e]],at=ve[Ze+x[$e]]):(Ue=96,at=0),ke=1<<Z-Se,De=1<<Te,Ee=De;do De-=ke,N[Fe+(Re>>Se)+De]=ot<<24|Ue<<16|at|0;while(De!==0);for(ke=1<<Z-1;Re&ke;)ke>>=1;if(ke!==0?(Re&=ke-1,Re+=ke):Re=0,$e++,--Me[Z]===0){if(Z===ge)break;Z=r[v+x[$e]]}if(Z>ye&&(Re&Be)!==Le){for(Se===0&&(Se=ye),Fe+=Ee,Te=Z-Se,Ie=1<<Te;Te+Se<ge&&(Ie-=Me[Te+Se],!(Ie<=0));)Te++,Ie<<=1;if(Ae+=1<<Te,E===LENS$1&&Ae>ENOUGH_LENS$1||E===DISTS$1&&Ae>ENOUGH_DISTS$1)return 1;Le=Re&Be,N[Le]=ye<<24|Te<<16|Fe-k|0}}return Re!==0&&(N[Fe+Re]=Z-Se<<24|64<<16|0),ce.bits=ye,0},utils$e=common,adler32=adler32_1,crc32$1=crc32_1,inflate_fast=inffast,inflate_table=inftrees,CODES=0,LENS=1,DISTS=2,Z_FINISH=4,Z_BLOCK=5,Z_TREES=6,Z_OK=0,Z_STREAM_END=1,Z_NEED_DICT=2,Z_STREAM_ERROR=-2,Z_DATA_ERROR=-3,Z_MEM_ERROR=-4,Z_BUF_ERROR=-5,Z_DEFLATED=8,HEAD=1,FLAGS=2,TIME=3,OS=4,EXLEN=5,EXTRA=6,NAME=7,COMMENT=8,HCRC=9,DICTID=10,DICT=11,TYPE=12,TYPEDO=13,STORED=14,COPY_=15,COPY=16,TABLE=17,LENLENS=18,CODELENS=19,LEN_=20,LEN=21,LENEXT=22,DIST=23,DISTEXT=24,MATCH=25,LIT=26,CHECK=27,LENGTH=28,DONE=29,BAD=30,MEM=31,SYNC=32,ENOUGH_LENS=852,ENOUGH_DISTS=592,MAX_WBITS=15,DEF_WBITS=MAX_WBITS;function zswap32(t){return(t>>>24&255)+(t>>>8&65280)+((t&65280)<<8)+((t&255)<<24)}function InflateState(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new utils$e.Buf16(320),this.work=new utils$e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function inflateResetKeep(t){var E;return!t||!t.state?Z_STREAM_ERROR:(E=t.state,t.total_in=t.total_out=E.total=0,t.msg="",E.wrap&&(t.adler=E.wrap&1),E.mode=HEAD,E.last=0,E.havedict=0,E.dmax=32768,E.head=null,E.hold=0,E.bits=0,E.lencode=E.lendyn=new utils$e.Buf32(ENOUGH_LENS),E.distcode=E.distdyn=new utils$e.Buf32(ENOUGH_DISTS),E.sane=1,E.back=-1,Z_OK)}function inflateReset(t){var E;return!t||!t.state?Z_STREAM_ERROR:(E=t.state,E.wsize=0,E.whave=0,E.wnext=0,inflateResetKeep(t))}function inflateReset2(t,E){var r,v;return!t||!t.state||(v=t.state,E<0?(r=0,E=-E):(r=(E>>4)+1,E<48&&(E&=15)),E&&(E<8||E>15))?Z_STREAM_ERROR:(v.window!==null&&v.wbits!==E&&(v.window=null),v.wrap=r,v.wbits=E,inflateReset(t))}function inflateInit2(t,E){var r,v;return t?(v=new InflateState,t.state=v,v.window=null,r=inflateReset2(t,E),r!==Z_OK&&(t.state=null),r):Z_STREAM_ERROR}function inflateInit(t){return inflateInit2(t,DEF_WBITS)}var virgin=!0,lenfix,distfix;function fixedtables(t){if(virgin){var E;for(lenfix=new utils$e.Buf32(512),distfix=new utils$e.Buf32(32),E=0;E<144;)t.lens[E++]=8;for(;E<256;)t.lens[E++]=9;for(;E<280;)t.lens[E++]=7;for(;E<288;)t.lens[E++]=8;for(inflate_table(LENS,t.lens,0,288,lenfix,0,t.work,{bits:9}),E=0;E<32;)t.lens[E++]=5;inflate_table(DISTS,t.lens,0,32,distfix,0,t.work,{bits:5}),virgin=!1}t.lencode=lenfix,t.lenbits=9,t.distcode=distfix,t.distbits=5}function updatewindow(t,E,r,v){var T,N=t.state;return N.window===null&&(N.wsize=1<<N.wbits,N.wnext=0,N.whave=0,N.window=new utils$e.Buf8(N.wsize)),v>=N.wsize?(utils$e.arraySet(N.window,E,r-N.wsize,N.wsize,0),N.wnext=0,N.whave=N.wsize):(T=N.wsize-N.wnext,T>v&&(T=v),utils$e.arraySet(N.window,E,r-v,T,N.wnext),v-=T,v?(utils$e.arraySet(N.window,E,r-v,v,0),N.wnext=v,N.whave=N.wsize):(N.wnext+=T,N.wnext===N.wsize&&(N.wnext=0),N.whave<N.wsize&&(N.whave+=T))),0}function inflate$2(t,E){var r,v,T,N,k,x,ce,ue,Z,$e,Ee,ge,ye,Te,Se=0,Ie,Ae,Re,ke,De,Le,Be,Fe,ve=new utils$e.Buf8(4),Ze,Oe,Me=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&t.avail_in!==0)return Z_STREAM_ERROR;r=t.state,r.mode===TYPE&&(r.mode=TYPEDO),k=t.next_out,T=t.output,ce=t.avail_out,N=t.next_in,v=t.input,x=t.avail_in,ue=r.hold,Z=r.bits,$e=x,Ee=ce,Fe=Z_OK;e:for(;;)switch(r.mode){case HEAD:if(r.wrap===0){r.mode=TYPEDO;break}for(;Z<16;){if(x===0)break e;x--,ue+=v[N++]<<Z,Z+=8}if(r.wrap&2&&ue===35615){r.check=0,ve[0]=ue&255,ve[1]=ue>>>8&255,r.check=crc32$1(r.check,ve,2,0),ue=0,Z=0,r.mode=FLAGS;break}if(r.flags=0,r.head&&(r.head.done=!1),!(r.wrap&1)||(((ue&255)<<8)+(ue>>8))%31){t.msg="incorrect header check",r.mode=BAD;break}if((ue&15)!==Z_DEFLATED){t.msg="unknown compression method",r.mode=BAD;break}if(ue>>>=4,Z-=4,Be=(ue&15)+8,r.wbits===0)r.wbits=Be;else if(Be>r.wbits){t.msg="invalid window size",r.mode=BAD;break}r.dmax=1<<Be,t.adler=r.check=1,r.mode=ue&512?DICTID:TYPE,ue=0,Z=0;break;case FLAGS:for(;Z<16;){if(x===0)break e;x--,ue+=v[N++]<<Z,Z+=8}if(r.flags=ue,(r.flags&255)!==Z_DEFLATED){t.msg="unknown compression method",r.mode=BAD;break}if(r.flags&57344){t.msg="unknown header flags set",r.mode=BAD;break}r.head&&(r.head.text=ue>>8&1),r.flags&512&&(ve[0]=ue&255,ve[1]=ue>>>8&255,r.check=crc32$1(r.check,ve,2,0)),ue=0,Z=0,r.mode=TIME;case TIME:for(;Z<32;){if(x===0)break e;x--,ue+=v[N++]<<Z,Z+=8}r.head&&(r.head.time=ue),r.flags&512&&(ve[0]=ue&255,ve[1]=ue>>>8&255,ve[2]=ue>>>16&255,ve[3]=ue>>>24&255,r.check=crc32$1(r.check,ve,4,0)),ue=0,Z=0,r.mode=OS;case OS:for(;Z<16;){if(x===0)break e;x--,ue+=v[N++]<<Z,Z+=8}r.head&&(r.head.xflags=ue&255,r.head.os=ue>>8),r.flags&512&&(ve[0]=ue&255,ve[1]=ue>>>8&255,r.check=crc32$1(r.check,ve,2,0)),ue=0,Z=0,r.mode=EXLEN;case EXLEN:if(r.flags&1024){for(;Z<16;){if(x===0)break e;x--,ue+=v[N++]<<Z,Z+=8}r.length=ue,r.head&&(r.head.extra_len=ue),r.flags&512&&(ve[0]=ue&255,ve[1]=ue>>>8&255,r.check=crc32$1(r.check,ve,2,0)),ue=0,Z=0}else r.head&&(r.head.extra=null);r.mode=EXTRA;case EXTRA:if(r.flags&1024&&(ge=r.length,ge>x&&(ge=x),ge&&(r.head&&(Be=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),utils$e.arraySet(r.head.extra,v,N,ge,Be)),r.flags&512&&(r.check=crc32$1(r.check,v,ge,N)),x-=ge,N+=ge,r.length-=ge),r.length))break e;r.length=0,r.mode=NAME;case NAME:if(r.flags&2048){if(x===0)break e;ge=0;do Be=v[N+ge++],r.head&&Be&&r.length<65536&&(r.head.name+=String.fromCharCode(Be));while(Be&&ge<x);if(r.flags&512&&(r.check=crc32$1(r.check,v,ge,N)),x-=ge,N+=ge,Be)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=COMMENT;case COMMENT:if(r.flags&4096){if(x===0)break e;ge=0;do Be=v[N+ge++],r.head&&Be&&r.length<65536&&(r.head.comment+=String.fromCharCode(Be));while(Be&&ge<x);if(r.flags&512&&(r.check=crc32$1(r.check,v,ge,N)),x-=ge,N+=ge,Be)break e}else r.head&&(r.head.comment=null);r.mode=HCRC;case HCRC:if(r.flags&512){for(;Z<16;){if(x===0)break e;x--,ue+=v[N++]<<Z,Z+=8}if(ue!==(r.check&65535)){t.msg="header crc mismatch",r.mode=BAD;break}ue=0,Z=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=TYPE;break;case DICTID:for(;Z<32;){if(x===0)break e;x--,ue+=v[N++]<<Z,Z+=8}t.adler=r.check=zswap32(ue),ue=0,Z=0,r.mode=DICT;case DICT:if(r.havedict===0)return t.next_out=k,t.avail_out=ce,t.next_in=N,t.avail_in=x,r.hold=ue,r.bits=Z,Z_NEED_DICT;t.adler=r.check=1,r.mode=TYPE;case TYPE:if(E===Z_BLOCK||E===Z_TREES)break e;case TYPEDO:if(r.last){ue>>>=Z&7,Z-=Z&7,r.mode=CHECK;break}for(;Z<3;){if(x===0)break e;x--,ue+=v[N++]<<Z,Z+=8}switch(r.last=ue&1,ue>>>=1,Z-=1,ue&3){case 0:r.mode=STORED;break;case 1:if(fixedtables(r),r.mode=LEN_,E===Z_TREES){ue>>>=2,Z-=2;break e}break;case 2:r.mode=TABLE;break;case 3:t.msg="invalid block type",r.mode=BAD}ue>>>=2,Z-=2;break;case STORED:for(ue>>>=Z&7,Z-=Z&7;Z<32;){if(x===0)break e;x--,ue+=v[N++]<<Z,Z+=8}if((ue&65535)!==(ue>>>16^65535)){t.msg="invalid stored block lengths",r.mode=BAD;break}if(r.length=ue&65535,ue=0,Z=0,r.mode=COPY_,E===Z_TREES)break e;case COPY_:r.mode=COPY;case COPY:if(ge=r.length,ge){if(ge>x&&(ge=x),ge>ce&&(ge=ce),ge===0)break e;utils$e.arraySet(T,v,N,ge,k),x-=ge,N+=ge,ce-=ge,k+=ge,r.length-=ge;break}r.mode=TYPE;break;case TABLE:for(;Z<14;){if(x===0)break e;x--,ue+=v[N++]<<Z,Z+=8}if(r.nlen=(ue&31)+257,ue>>>=5,Z-=5,r.ndist=(ue&31)+1,ue>>>=5,Z-=5,r.ncode=(ue&15)+4,ue>>>=4,Z-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=BAD;break}r.have=0,r.mode=LENLENS;case LENLENS:for(;r.have<r.ncode;){for(;Z<3;){if(x===0)break e;x--,ue+=v[N++]<<Z,Z+=8}r.lens[Me[r.have++]]=ue&7,ue>>>=3,Z-=3}for(;r.have<19;)r.lens[Me[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,Ze={bits:r.lenbits},Fe=inflate_table(CODES,r.lens,0,19,r.lencode,0,r.work,Ze),r.lenbits=Ze.bits,Fe){t.msg="invalid code lengths set",r.mode=BAD;break}r.have=0,r.mode=CODELENS;case CODELENS:for(;r.have<r.nlen+r.ndist;){for(;Se=r.lencode[ue&(1<<r.lenbits)-1],Ie=Se>>>24,Ae=Se>>>16&255,Re=Se&65535,!(Ie<=Z);){if(x===0)break e;x--,ue+=v[N++]<<Z,Z+=8}if(Re<16)ue>>>=Ie,Z-=Ie,r.lens[r.have++]=Re;else{if(Re===16){for(Oe=Ie+2;Z<Oe;){if(x===0)break e;x--,ue+=v[N++]<<Z,Z+=8}if(ue>>>=Ie,Z-=Ie,r.have===0){t.msg="invalid bit length repeat",r.mode=BAD;break}Be=r.lens[r.have-1],ge=3+(ue&3),ue>>>=2,Z-=2}else if(Re===17){for(Oe=Ie+3;Z<Oe;){if(x===0)break e;x--,ue+=v[N++]<<Z,Z+=8}ue>>>=Ie,Z-=Ie,Be=0,ge=3+(ue&7),ue>>>=3,Z-=3}else{for(Oe=Ie+7;Z<Oe;){if(x===0)break e;x--,ue+=v[N++]<<Z,Z+=8}ue>>>=Ie,Z-=Ie,Be=0,ge=11+(ue&127),ue>>>=7,Z-=7}if(r.have+ge>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=BAD;break}for(;ge--;)r.lens[r.have++]=Be}}if(r.mode===BAD)break;if(r.lens[256]===0){t.msg="invalid code -- missing end-of-block",r.mode=BAD;break}if(r.lenbits=9,Ze={bits:r.lenbits},Fe=inflate_table(LENS,r.lens,0,r.nlen,r.lencode,0,r.work,Ze),r.lenbits=Ze.bits,Fe){t.msg="invalid literal/lengths set",r.mode=BAD;break}if(r.distbits=6,r.distcode=r.distdyn,Ze={bits:r.distbits},Fe=inflate_table(DISTS,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,Ze),r.distbits=Ze.bits,Fe){t.msg="invalid distances set",r.mode=BAD;break}if(r.mode=LEN_,E===Z_TREES)break e;case LEN_:r.mode=LEN;case LEN:if(x>=6&&ce>=258){t.next_out=k,t.avail_out=ce,t.next_in=N,t.avail_in=x,r.hold=ue,r.bits=Z,inflate_fast(t,Ee),k=t.next_out,T=t.output,ce=t.avail_out,N=t.next_in,v=t.input,x=t.avail_in,ue=r.hold,Z=r.bits,r.mode===TYPE&&(r.back=-1);break}for(r.back=0;Se=r.lencode[ue&(1<<r.lenbits)-1],Ie=Se>>>24,Ae=Se>>>16&255,Re=Se&65535,!(Ie<=Z);){if(x===0)break e;x--,ue+=v[N++]<<Z,Z+=8}if(Ae&&(Ae&240)===0){for(ke=Ie,De=Ae,Le=Re;Se=r.lencode[Le+((ue&(1<<ke+De)-1)>>ke)],Ie=Se>>>24,Ae=Se>>>16&255,Re=Se&65535,!(ke+Ie<=Z);){if(x===0)break e;x--,ue+=v[N++]<<Z,Z+=8}ue>>>=ke,Z-=ke,r.back+=ke}if(ue>>>=Ie,Z-=Ie,r.back+=Ie,r.length=Re,Ae===0){r.mode=LIT;break}if(Ae&32){r.back=-1,r.mode=TYPE;break}if(Ae&64){t.msg="invalid literal/length code",r.mode=BAD;break}r.extra=Ae&15,r.mode=LENEXT;case LENEXT:if(r.extra){for(Oe=r.extra;Z<Oe;){if(x===0)break e;x--,ue+=v[N++]<<Z,Z+=8}r.length+=ue&(1<<r.extra)-1,ue>>>=r.extra,Z-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=DIST;case DIST:for(;Se=r.distcode[ue&(1<<r.distbits)-1],Ie=Se>>>24,Ae=Se>>>16&255,Re=Se&65535,!(Ie<=Z);){if(x===0)break e;x--,ue+=v[N++]<<Z,Z+=8}if((Ae&240)===0){for(ke=Ie,De=Ae,Le=Re;Se=r.distcode[Le+((ue&(1<<ke+De)-1)>>ke)],Ie=Se>>>24,Ae=Se>>>16&255,Re=Se&65535,!(ke+Ie<=Z);){if(x===0)break e;x--,ue+=v[N++]<<Z,Z+=8}ue>>>=ke,Z-=ke,r.back+=ke}if(ue>>>=Ie,Z-=Ie,r.back+=Ie,Ae&64){t.msg="invalid distance code",r.mode=BAD;break}r.offset=Re,r.extra=Ae&15,r.mode=DISTEXT;case DISTEXT:if(r.extra){for(Oe=r.extra;Z<Oe;){if(x===0)break e;x--,ue+=v[N++]<<Z,Z+=8}r.offset+=ue&(1<<r.extra)-1,ue>>>=r.extra,Z-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=BAD;break}r.mode=MATCH;case MATCH:if(ce===0)break e;if(ge=Ee-ce,r.offset>ge){if(ge=r.offset-ge,ge>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=BAD;break}ge>r.wnext?(ge-=r.wnext,ye=r.wsize-ge):ye=r.wnext-ge,ge>r.length&&(ge=r.length),Te=r.window}else Te=T,ye=k-r.offset,ge=r.length;ge>ce&&(ge=ce),ce-=ge,r.length-=ge;do T[k++]=Te[ye++];while(--ge);r.length===0&&(r.mode=LEN);break;case LIT:if(ce===0)break e;T[k++]=r.length,ce--,r.mode=LEN;break;case CHECK:if(r.wrap){for(;Z<32;){if(x===0)break e;x--,ue|=v[N++]<<Z,Z+=8}if(Ee-=ce,t.total_out+=Ee,r.total+=Ee,Ee&&(t.adler=r.check=r.flags?crc32$1(r.check,T,Ee,k-Ee):adler32(r.check,T,Ee,k-Ee)),Ee=ce,(r.flags?ue:zswap32(ue))!==r.check){t.msg="incorrect data check",r.mode=BAD;break}ue=0,Z=0}r.mode=LENGTH;case LENGTH:if(r.wrap&&r.flags){for(;Z<32;){if(x===0)break e;x--,ue+=v[N++]<<Z,Z+=8}if(ue!==(r.total&4294967295)){t.msg="incorrect length check",r.mode=BAD;break}ue=0,Z=0}r.mode=DONE;case DONE:Fe=Z_STREAM_END;break e;case BAD:Fe=Z_DATA_ERROR;break e;case MEM:return Z_MEM_ERROR;case SYNC:default:return Z_STREAM_ERROR}return t.next_out=k,t.avail_out=ce,t.next_in=N,t.avail_in=x,r.hold=ue,r.bits=Z,(r.wsize||Ee!==t.avail_out&&r.mode<BAD&&(r.mode<CHECK||E!==Z_FINISH))&&updatewindow(t,t.output,t.next_out,Ee-t.avail_out),$e-=t.avail_in,Ee-=t.avail_out,t.total_in+=$e,t.total_out+=Ee,r.total+=Ee,r.wrap&&Ee&&(t.adler=r.check=r.flags?crc32$1(r.check,T,Ee,t.next_out-Ee):adler32(r.check,T,Ee,t.next_out-Ee)),t.data_type=r.bits+(r.last?64:0)+(r.mode===TYPE?128:0)+(r.mode===LEN_||r.mode===COPY_?256:0),($e===0&&Ee===0||E===Z_FINISH)&&Fe===Z_OK&&(Fe=Z_BUF_ERROR),Fe}function inflateEnd(t){if(!t||!t.state)return Z_STREAM_ERROR;var E=t.state;return E.window&&(E.window=null),t.state=null,Z_OK}function inflateGetHeader(t,E){var r;return!t||!t.state||(r=t.state,(r.wrap&2)===0)?Z_STREAM_ERROR:(r.head=E,E.done=!1,Z_OK)}function inflateSetDictionary(t,E){var r=E.length,v,T,N;return!t||!t.state||(v=t.state,v.wrap!==0&&v.mode!==DICT)?Z_STREAM_ERROR:v.mode===DICT&&(T=1,T=adler32(T,E,r,0),T!==v.check)?Z_DATA_ERROR:(N=updatewindow(t,E,r,r),N?(v.mode=MEM,Z_MEM_ERROR):(v.havedict=1,Z_OK))}inflate$3.inflateReset=inflateReset,inflate$3.inflateReset2=inflateReset2,inflate$3.inflateResetKeep=inflateResetKeep,inflate$3.inflateInit=inflateInit,inflate$3.inflateInit2=inflateInit2,inflate$3.inflate=inflate$2,inflate$3.inflateEnd=inflateEnd,inflate$3.inflateGetHeader=inflateGetHeader,inflate$3.inflateSetDictionary=inflateSetDictionary,inflate$3.inflateInfo="pako inflate (from Nodeca project)";var constants$1={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};function GZheader$1(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gzheader=GZheader$1,zlib_inflate=inflate$3,utils$d=common,strings=strings$2,c$3=constants$1,msg=messages,ZStream=zstream,GZheader=gzheader,toString=Object.prototype.toString;function Inflate(t){if(!(this instanceof Inflate))return new Inflate(t);this.options=utils$d.assign({chunkSize:16384,windowBits:0,to:""},t||{});var E=this.options;E.raw&&E.windowBits>=0&&E.windowBits<16&&(E.windowBits=-E.windowBits,E.windowBits===0&&(E.windowBits=-15)),E.windowBits>=0&&E.windowBits<16&&!(t&&t.windowBits)&&(E.windowBits+=32),E.windowBits>15&&E.windowBits<48&&(E.windowBits&15)===0&&(E.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new ZStream,this.strm.avail_out=0;var r=zlib_inflate.inflateInit2(this.strm,E.windowBits);if(r!==c$3.Z_OK)throw new Error(msg[r]);if(this.header=new GZheader,zlib_inflate.inflateGetHeader(this.strm,this.header),E.dictionary&&(typeof E.dictionary=="string"?E.dictionary=strings.string2buf(E.dictionary):toString.call(E.dictionary)==="[object ArrayBuffer]"&&(E.dictionary=new Uint8Array(E.dictionary)),E.raw&&(r=zlib_inflate.inflateSetDictionary(this.strm,E.dictionary),r!==c$3.Z_OK)))throw new Error(msg[r])}Inflate.prototype.push=function(t,E){var r=this.strm,v=this.options.chunkSize,T=this.options.dictionary,N,k,x,ce,ue,Z=!1;if(this.ended)return!1;k=E===~~E?E:E===!0?c$3.Z_FINISH:c$3.Z_NO_FLUSH,typeof t=="string"?r.input=strings.binstring2buf(t):toString.call(t)==="[object ArrayBuffer]"?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;do{if(r.avail_out===0&&(r.output=new utils$d.Buf8(v),r.next_out=0,r.avail_out=v),N=zlib_inflate.inflate(r,c$3.Z_NO_FLUSH),N===c$3.Z_NEED_DICT&&T&&(N=zlib_inflate.inflateSetDictionary(this.strm,T)),N===c$3.Z_BUF_ERROR&&Z===!0&&(N=c$3.Z_OK,Z=!1),N!==c$3.Z_STREAM_END&&N!==c$3.Z_OK)return this.onEnd(N),this.ended=!0,!1;r.next_out&&(r.avail_out===0||N===c$3.Z_STREAM_END||r.avail_in===0&&(k===c$3.Z_FINISH||k===c$3.Z_SYNC_FLUSH))&&(this.options.to==="string"?(x=strings.utf8border(r.output,r.next_out),ce=r.next_out-x,ue=strings.buf2string(r.output,x),r.next_out=ce,r.avail_out=v-ce,ce&&utils$d.arraySet(r.output,r.output,x,ce,0),this.onData(ue)):this.onData(utils$d.shrinkBuf(r.output,r.next_out))),r.avail_in===0&&r.avail_out===0&&(Z=!0)}while((r.avail_in>0||r.avail_out===0)&&N!==c$3.Z_STREAM_END);return N===c$3.Z_STREAM_END&&(k=c$3.Z_FINISH),k===c$3.Z_FINISH?(N=zlib_inflate.inflateEnd(this.strm),this.onEnd(N),this.ended=!0,N===c$3.Z_OK):(k===c$3.Z_SYNC_FLUSH&&(this.onEnd(c$3.Z_OK),r.avail_out=0),!0)},Inflate.prototype.onData=function(t){this.chunks.push(t)},Inflate.prototype.onEnd=function(t){t===c$3.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=utils$d.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};function inflate$1(t,E){var r=new Inflate(E);if(r.push(t,!0),r.err)throw r.msg||msg[r.err];return r.result}function inflateRaw(t,E){return E=E||{},E.raw=!0,inflate$1(t,E)}inflate$4.Inflate=Inflate,inflate$4.inflate=inflate$1,inflate$4.inflateRaw=inflateRaw,inflate$4.ungzip=inflate$1;var assign=common.assign,deflate=deflate$4,inflate=inflate$4,constants=constants$1,pako$1={};assign(pako$1,deflate,inflate,constants);var pako_1=pako$1,USE_TYPEDARRAY=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Uint32Array!="undefined",pako=pako_1,utils$c=utils$r,GenericWorker$4=GenericWorker_1,ARRAY_TYPE=USE_TYPEDARRAY?"uint8array":"array";flate.magic="\b\0";function FlateWorker(t,E){GenericWorker$4.call(this,"FlateWorker/"+t),this._pako=null,this._pakoAction=t,this._pakoOptions=E,this.meta={}}utils$c.inherits(FlateWorker,GenericWorker$4),FlateWorker.prototype.processChunk=function(t){this.meta=t.meta,this._pako===null&&this._createPako(),this._pako.push(utils$c.transformTo(ARRAY_TYPE,t.data),!1)},FlateWorker.prototype.flush=function(){GenericWorker$4.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},FlateWorker.prototype.cleanUp=function(){GenericWorker$4.prototype.cleanUp.call(this),this._pako=null},FlateWorker.prototype._createPako=function(){this._pako=new pako[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var t=this;this._pako.onData=function(E){t.push({data:E,meta:t.meta})}},flate.compressWorker=function(t){return new FlateWorker("Deflate",t)},flate.uncompressWorker=function(){return new FlateWorker("Inflate",{})};var GenericWorker$3=GenericWorker_1;compressions$2.STORE={magic:"\0\0",compressWorker:function(){return new GenericWorker$3("STORE compression")},uncompressWorker:function(){return new GenericWorker$3("STORE decompression")}},compressions$2.DEFLATE=flate;var signature$1={};signature$1.LOCAL_FILE_HEADER="PK",signature$1.CENTRAL_FILE_HEADER="PK",signature$1.CENTRAL_DIRECTORY_END="PK",signature$1.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",signature$1.ZIP64_CENTRAL_DIRECTORY_END="PK",signature$1.DATA_DESCRIPTOR="PK\x07\b";var utils$b=utils$r,GenericWorker$2=GenericWorker_1,utf8$3=utf8$5,crc32=crc32_1$1,signature=signature$1,decToHex=function(t,E){var r="",v;for(v=0;v<E;v++)r+=String.fromCharCode(t&255),t=t>>>8;return r},generateUnixExternalFileAttr=function(t,E){var r=t;return t||(r=E?16893:33204),(r&65535)<<16},generateDosExternalFileAttr=function(t){return(t||0)&63},generateZipParts=function(t,E,r,v,T,N){var k=t.file,x=t.compression,ce=N!==utf8$3.utf8encode,ue=utils$b.transformTo("string",N(k.name)),Z=utils$b.transformTo("string",utf8$3.utf8encode(k.name)),$e=k.comment,Ee=utils$b.transformTo("string",N($e)),ge=utils$b.transformTo("string",utf8$3.utf8encode($e)),ye=Z.length!==k.name.length,Te=ge.length!==$e.length,Se,Ie,Ae="",Re="",ke="",De=k.dir,Le=k.date,Be={crc32:0,compressedSize:0,uncompressedSize:0};(!E||r)&&(Be.crc32=t.crc32,Be.compressedSize=t.compressedSize,Be.uncompressedSize=t.uncompressedSize);var Fe=0;E&&(Fe|=8),!ce&&(ye||Te)&&(Fe|=2048);var ve=0,Ze=0;De&&(ve|=16),T==="UNIX"?(Ze=798,ve|=generateUnixExternalFileAttr(k.unixPermissions,De)):(Ze=20,ve|=generateDosExternalFileAttr(k.dosPermissions)),Se=Le.getUTCHours(),Se=Se<<6,Se=Se|Le.getUTCMinutes(),Se=Se<<5,Se=Se|Le.getUTCSeconds()/2,Ie=Le.getUTCFullYear()-1980,Ie=Ie<<4,Ie=Ie|Le.getUTCMonth()+1,Ie=Ie<<5,Ie=Ie|Le.getUTCDate(),ye&&(Re=decToHex(1,1)+decToHex(crc32(ue),4)+Z,Ae+="up"+decToHex(Re.length,2)+Re),Te&&(ke=decToHex(1,1)+decToHex(crc32(Ee),4)+ge,Ae+="uc"+decToHex(ke.length,2)+ke);var Oe="";Oe+=`
\0`,Oe+=decToHex(Fe,2),Oe+=x.magic,Oe+=decToHex(Se,2),Oe+=decToHex(Ie,2),Oe+=decToHex(Be.crc32,4),Oe+=decToHex(Be.compressedSize,4),Oe+=decToHex(Be.uncompressedSize,4),Oe+=decToHex(ue.length,2),Oe+=decToHex(Ae.length,2);var Me=signature.LOCAL_FILE_HEADER+Oe+ue+Ae,Je=signature.CENTRAL_FILE_HEADER+decToHex(Ze,2)+Oe+decToHex(Ee.length,2)+"\0\0\0\0"+decToHex(ve,4)+decToHex(v,4)+ue+Ae+Ee;return{fileRecord:Me,dirRecord:Je}},generateCentralDirectoryEnd=function(t,E,r,v,T){var N="",k=utils$b.transformTo("string",T(v));return N=signature.CENTRAL_DIRECTORY_END+"\0\0\0\0"+decToHex(t,2)+decToHex(t,2)+decToHex(E,4)+decToHex(r,4)+decToHex(k.length,2)+k,N},generateDataDescriptors=function(t){var E="";return E=signature.DATA_DESCRIPTOR+decToHex(t.crc32,4)+decToHex(t.compressedSize,4)+decToHex(t.uncompressedSize,4),E};function ZipFileWorker$1(t,E,r,v){GenericWorker$2.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=E,this.zipPlatform=r,this.encodeFileName=v,this.streamFiles=t,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}utils$b.inherits(ZipFileWorker$1,GenericWorker$2),ZipFileWorker$1.prototype.push=function(t){var E=t.meta.percent||0,r=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(t):(this.bytesWritten+=t.data.length,GenericWorker$2.prototype.push.call(this,{data:t.data,meta:{currentFile:this.currentFile,percent:r?(E+100*(r-v-1))/r:100}}))},ZipFileWorker$1.prototype.openedSource=function(t){this.currentSourceOffset=this.bytesWritten,this.currentFile=t.file.name;var E=this.streamFiles&&!t.file.dir;if(E){var r=generateZipParts(t,E,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0},ZipFileWorker$1.prototype.closedSource=function(t){this.accumulate=!1;var E=this.streamFiles&&!t.file.dir,r=generateZipParts(t,E,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),E)this.push({data:generateDataDescriptors(t),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},ZipFileWorker$1.prototype.flush=function(){for(var t=this.bytesWritten,E=0;E<this.dirRecords.length;E++)this.push({data:this.dirRecords[E],meta:{percent:100}});var r=this.bytesWritten-t,v=generateCentralDirectoryEnd(this.dirRecords.length,r,t,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},ZipFileWorker$1.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},ZipFileWorker$1.prototype.registerPrevious=function(t){this._sources.push(t);var E=this;return t.on("data",function(r){E.processChunk(r)}),t.on("end",function(){E.closedSource(E.previous.streamInfo),E._sources.length?E.prepareNextSource():E.end()}),t.on("error",function(r){E.error(r)}),this},ZipFileWorker$1.prototype.resume=function(){if(!GenericWorker$2.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0},ZipFileWorker$1.prototype.error=function(t){var E=this._sources;if(!GenericWorker$2.prototype.error.call(this,t))return!1;for(var r=0;r<E.length;r++)try{E[r].error(t)}catch(v){}return!0},ZipFileWorker$1.prototype.lock=function(){GenericWorker$2.prototype.lock.call(this);for(var t=this._sources,E=0;E<t.length;E++)t[E].lock()};var ZipFileWorker_1=ZipFileWorker$1,compressions$1=compressions$2,ZipFileWorker=ZipFileWorker_1,getCompression=function(t,E){var r=t||E,v=compressions$1[r];if(!v)throw new Error(r+" is not a valid compression method !");return v};generate$1.generateWorker=function(t,E,r){var v=new ZipFileWorker(E.streamFiles,r,E.platform,E.encodeFileName),T=0;try{t.forEach(function(N,k){T++;var x=getCompression(k.options.compression,E.compression),ce=k.options.compressionOptions||E.compressionOptions||{},ue=k.dir,Z=k.date;k._compressWorker(x,ce).withStreamInfo("file",{name:N,dir:ue,date:Z,comment:k.comment||"",unixPermissions:k.unixPermissions,dosPermissions:k.dosPermissions}).pipe(v)}),v.entriesCount=T}catch(N){v.error(N)}return v};var utils$a=utils$r,GenericWorker$1=GenericWorker_1;function NodejsStreamInputAdapter$1(t,E){GenericWorker$1.call(this,"Nodejs stream input adapter for "+t),this._upstreamEnded=!1,this._bindStream(E)}utils$a.inherits(NodejsStreamInputAdapter$1,GenericWorker$1),NodejsStreamInputAdapter$1.prototype._bindStream=function(t){var E=this;this._stream=t,t.pause(),t.on("data",function(r){E.push({data:r,meta:{percent:0}})}).on("error",function(r){E.isPaused?this.generatedError=r:E.error(r)}).on("end",function(){E.isPaused?E._upstreamEnded=!0:E.end()})},NodejsStreamInputAdapter$1.prototype.pause=function(){return GenericWorker$1.prototype.pause.call(this)?(this._stream.pause(),!0):!1},NodejsStreamInputAdapter$1.prototype.resume=function(){return GenericWorker$1.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1};var NodejsStreamInputAdapter_1=NodejsStreamInputAdapter$1,utf8$2=utf8$5,utils$9=utils$r,GenericWorker=GenericWorker_1,StreamHelper=StreamHelper_1,defaults=defaults$1,CompressedObject$1=compressedObject,ZipObject=zipObject,generate=generate$1,nodejsUtils$1=nodejsUtils$2,NodejsStreamInputAdapter=NodejsStreamInputAdapter_1,fileAdd=function(t,E,r){var v=utils$9.getTypeOf(E),T,N=utils$9.extend(r||{},defaults);N.date=N.date||new Date,N.compression!==null&&(N.compression=N.compression.toUpperCase()),typeof N.unixPermissions=="string"&&(N.unixPermissions=parseInt(N.unixPermissions,8)),N.unixPermissions&&N.unixPermissions&16384&&(N.dir=!0),N.dosPermissions&&N.dosPermissions&16&&(N.dir=!0),N.dir&&(t=forceTrailingSlash(t)),N.createFolders&&(T=parentFolder(t))&&folderAdd.call(this,T,!0);var k=v==="string"&&N.binary===!1&&N.base64===!1;(!r||typeof r.binary=="undefined")&&(N.binary=!k);var x=E instanceof CompressedObject$1&&E.uncompressedSize===0;(x||N.dir||!E||E.length===0)&&(N.base64=!1,N.binary=!0,E="",N.compression="STORE",v="string");var ce=null;E instanceof CompressedObject$1||E instanceof GenericWorker?ce=E:nodejsUtils$1.isNode&&nodejsUtils$1.isStream(E)?ce=new NodejsStreamInputAdapter(t,E):ce=utils$9.prepareContent(t,E,N.binary,N.optimizedBinaryString,N.base64);var ue=new ZipObject(t,ce,N);this.files[t]=ue},parentFolder=function(t){t.slice(-1)==="/"&&(t=t.substring(0,t.length-1));var E=t.lastIndexOf("/");return E>0?t.substring(0,E):""},forceTrailingSlash=function(t){return t.slice(-1)!=="/"&&(t+="/"),t},folderAdd=function(t,E){return E=typeof E!="undefined"?E:defaults.createFolders,t=forceTrailingSlash(t),this.files[t]||fileAdd.call(this,t,null,{dir:!0,createFolders:E}),this.files[t]};function isRegExp(t){return Object.prototype.toString.call(t)==="[object RegExp]"}var out={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(t){var E,r,v;for(E in this.files)v=this.files[E],r=E.slice(this.root.length,E.length),r&&E.slice(0,this.root.length)===this.root&&t(r,v)},filter:function(t){var E=[];return this.forEach(function(r,v){t(r,v)&&E.push(v)}),E},file:function(t,E,r){if(arguments.length===1)if(isRegExp(t)){var v=t;return this.filter(function(N,k){return!k.dir&&v.test(N)})}else{var T=this.files[this.root+t];return T&&!T.dir?T:null}else t=this.root+t,fileAdd.call(this,t,E,r);return this},folder:function(t){if(!t)return this;if(isRegExp(t))return this.filter(function(T,N){return N.dir&&t.test(T)});var E=this.root+t,r=folderAdd.call(this,E),v=this.clone();return v.root=r.name,v},remove:function(t){t=this.root+t;var E=this.files[t];if(E||(t.slice(-1)!=="/"&&(t+="/"),E=this.files[t]),E&&!E.dir)delete this.files[t];else for(var r=this.filter(function(T,N){return N.name.slice(0,t.length)===t}),v=0;v<r.length;v++)delete this.files[r[v].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(t){var E,r={};try{if(r=utils$9.extend(t||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:utf8$2.utf8encode}),r.type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),r.type==="binarystring"&&(r.type="string"),!r.type)throw new Error("No output type specified.");utils$9.checkSupport(r.type),(r.platform==="darwin"||r.platform==="freebsd"||r.platform==="linux"||r.platform==="sunos")&&(r.platform="UNIX"),r.platform==="win32"&&(r.platform="DOS");var v=r.comment||this.comment||"";E=generate.generateWorker(this,r,v)}catch(T){E=new GenericWorker("error"),E.error(T)}return new StreamHelper(E,r.type||"string",r.mimeType)},generateAsync:function(t,E){return this.generateInternalStream(t).accumulate(E)},generateNodeStream:function(t,E){return t=t||{},t.type||(t.type="nodebuffer"),this.generateInternalStream(t).toNodejsStream(E)}},object=out,utils$8=utils$r;function DataReader$2(t){this.data=t,this.length=t.length,this.index=0,this.zero=0}DataReader$2.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(){},readInt:function(t){var E=0,r;for(this.checkOffset(t),r=this.index+t-1;r>=this.index;r--)E=(E<<8)+this.byteAt(r);return this.index+=t,E},readString:function(t){return utils$8.transformTo("string",this.readData(t))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var t=this.readInt(4);return new Date(Date.UTC((t>>25&127)+1980,(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(t&31)<<1))}};var DataReader_1=DataReader$2,DataReader$1=DataReader_1,utils$7=utils$r;function ArrayReader$2(t){DataReader$1.call(this,t);for(var E=0;E<this.data.length;E++)t[E]=t[E]&255}utils$7.inherits(ArrayReader$2,DataReader$1),ArrayReader$2.prototype.byteAt=function(t){return this.data[this.zero+t]},ArrayReader$2.prototype.lastIndexOfSignature=function(t){for(var E=t.charCodeAt(0),r=t.charCodeAt(1),v=t.charCodeAt(2),T=t.charCodeAt(3),N=this.length-4;N>=0;--N)if(this.data[N]===E&&this.data[N+1]===r&&this.data[N+2]===v&&this.data[N+3]===T)return N-this.zero;return-1},ArrayReader$2.prototype.readAndCheckSignature=function(t){var E=t.charCodeAt(0),r=t.charCodeAt(1),v=t.charCodeAt(2),T=t.charCodeAt(3),N=this.readData(4);return E===N[0]&&r===N[1]&&v===N[2]&&T===N[3]},ArrayReader$2.prototype.readData=function(t){if(this.checkOffset(t),t===0)return[];var E=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,E};var ArrayReader_1=ArrayReader$2,DataReader=DataReader_1,utils$6=utils$r;function StringReader$1(t){DataReader.call(this,t)}utils$6.inherits(StringReader$1,DataReader),StringReader$1.prototype.byteAt=function(t){return this.data.charCodeAt(this.zero+t)},StringReader$1.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)-this.zero},StringReader$1.prototype.readAndCheckSignature=function(t){var E=this.readData(4);return t===E},StringReader$1.prototype.readData=function(t){this.checkOffset(t);var E=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,E};var StringReader_1=StringReader$1,ArrayReader$1=ArrayReader_1,utils$5=utils$r;function Uint8ArrayReader$2(t){ArrayReader$1.call(this,t)}utils$5.inherits(Uint8ArrayReader$2,ArrayReader$1),Uint8ArrayReader$2.prototype.readData=function(t){if(this.checkOffset(t),t===0)return new Uint8Array(0);var E=this.data.subarray(this.zero+this.index,this.zero+this.index+t);return this.index+=t,E};var Uint8ArrayReader_1=Uint8ArrayReader$2,Uint8ArrayReader$1=Uint8ArrayReader_1,utils$4=utils$r;function NodeBufferReader$1(t){Uint8ArrayReader$1.call(this,t)}utils$4.inherits(NodeBufferReader$1,Uint8ArrayReader$1),NodeBufferReader$1.prototype.readData=function(t){this.checkOffset(t);var E=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,E};var NodeBufferReader_1=NodeBufferReader$1,utils$3=utils$r,support$2=support$5,ArrayReader=ArrayReader_1,StringReader=StringReader_1,NodeBufferReader=NodeBufferReader_1,Uint8ArrayReader=Uint8ArrayReader_1,readerFor$2=function(t){var E=utils$3.getTypeOf(t);return utils$3.checkSupport(E),E==="string"&&!support$2.uint8array?new StringReader(t):E==="nodebuffer"?new NodeBufferReader(t):support$2.uint8array?new Uint8ArrayReader(utils$3.transformTo("uint8array",t)):new ArrayReader(utils$3.transformTo("array",t))},readerFor$1=readerFor$2,utils$2=utils$r,CompressedObject=compressedObject,crc32fn=crc32_1$1,utf8$1=utf8$5,compressions=compressions$2,support$1=support$5,MADE_BY_DOS=0,MADE_BY_UNIX=3,findCompression=function(t){for(var E in compressions)if(Object.prototype.hasOwnProperty.call(compressions,E)&&compressions[E].magic===t)return compressions[E];return null};function ZipEntry$1(t,E){this.options=t,this.loadOptions=E}ZipEntry$1.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(t){var E,r;if(t.skip(22),this.fileNameLength=t.readInt(2),r=t.readInt(2),this.fileName=t.readData(this.fileNameLength),t.skip(r),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(E=findCompression(this.compressionMethod),E===null)throw new Error("Corrupted zip : compression "+utils$2.pretty(this.compressionMethod)+" unknown (inner file : "+utils$2.transformTo("string",this.fileName)+")");this.decompressed=new CompressedObject(this.compressedSize,this.uncompressedSize,this.crc32,E,t.readData(this.compressedSize))},readCentralPart:function(t){this.versionMadeBy=t.readInt(2),t.skip(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4);var E=t.readInt(2);if(this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");t.skip(E),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),t===MADE_BY_DOS&&(this.dosPermissions=this.externalFileAttributes&63),t===MADE_BY_UNIX&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var t=readerFor$1(this.extraFields[1].value);this.uncompressedSize===utils$2.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===utils$2.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===utils$2.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===utils$2.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(t){var E=t.index+this.extraFieldsLength,r,v,T;for(this.extraFields||(this.extraFields={});t.index+4<E;)r=t.readInt(2),v=t.readInt(2),T=t.readData(v),this.extraFields[r]={id:r,length:v,value:T};t.setIndex(E)},handleUTF8:function(){var t=support$1.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=utf8$1.utf8decode(this.fileName),this.fileCommentStr=utf8$1.utf8decode(this.fileComment);else{var E=this.findExtraFieldUnicodePath();if(E!==null)this.fileNameStr=E;else{var r=utils$2.transformTo(t,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var T=utils$2.transformTo(t,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(T)}}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var E=readerFor$1(t.value);return E.readInt(1)!==1||crc32fn(this.fileName)!==E.readInt(4)?null:utf8$1.utf8decode(E.readData(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var E=readerFor$1(t.value);return E.readInt(1)!==1||crc32fn(this.fileComment)!==E.readInt(4)?null:utf8$1.utf8decode(E.readData(t.length-5))}return null}};var zipEntry=ZipEntry$1,readerFor=readerFor$2,utils$1=utils$r,sig=signature$1,ZipEntry=zipEntry,support=support$5;function ZipEntries$1(t){this.files=[],this.loadOptions=t}ZipEntries$1.prototype={checkSignature:function(t){if(!this.reader.readAndCheckSignature(t)){this.reader.index-=4;var E=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+utils$1.pretty(E)+", expected "+utils$1.pretty(t)+")")}},isSignature:function(t,E){var r=this.reader.index;this.reader.setIndex(t);var v=this.reader.readString(4),T=v===E;return this.reader.setIndex(r),T},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var t=this.reader.readData(this.zipCommentLength),E=support.uint8array?"uint8array":"array",r=utils$1.transformTo(E,t);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t=this.zip64EndOfCentralSize-44,E=0,r,v,T;E<t;)r=this.reader.readInt(2),v=this.reader.readInt(4),T=this.reader.readData(v),this.zip64ExtensibleData[r]={id:r,length:v,value:T}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,E;for(t=0;t<this.files.length;t++)E=this.files[t],this.reader.setIndex(E.localHeaderOffset),this.checkSignature(sig.LOCAL_FILE_HEADER),E.readLocalPart(this.reader),E.handleUTF8(),E.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(sig.CENTRAL_FILE_HEADER);)t=new ZipEntry({zip64:this.zip64},this.loadOptions),t.readCentralPart(this.reader),this.files.push(t);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(sig.CENTRAL_DIRECTORY_END);if(t<0){var E=!this.isSignature(0,sig.LOCAL_FILE_HEADER);throw E?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(t);var r=t;if(this.checkSignature(sig.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===utils$1.MAX_VALUE_16BITS||this.diskWithCentralDirStart===utils$1.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===utils$1.MAX_VALUE_16BITS||this.centralDirRecords===utils$1.MAX_VALUE_16BITS||this.centralDirSize===utils$1.MAX_VALUE_32BITS||this.centralDirOffset===utils$1.MAX_VALUE_32BITS){if(this.zip64=!0,t=this.reader.lastIndexOfSignature(sig.ZIP64_CENTRAL_DIRECTORY_LOCATOR),t<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(t),this.checkSignature(sig.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,sig.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(sig.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(sig.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var v=this.centralDirOffset+this.centralDirSize;this.zip64&&(v+=20,v+=12+this.zip64EndOfCentralSize);var T=r-v;if(T>0)this.isSignature(r,sig.CENTRAL_FILE_HEADER)||(this.reader.zero=T);else if(T<0)throw new Error("Corrupted zip: missing "+Math.abs(T)+" bytes.")},prepareReader:function(t){this.reader=readerFor(t)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}};var zipEntries=ZipEntries$1,utils=utils$r,external=external$3,utf8=utf8$5,ZipEntries=zipEntries,Crc32Probe=Crc32Probe_1,nodejsUtils=nodejsUtils$2;function checkEntryCRC32(t){return new external.Promise(function(E,r){var v=t.decompressed.getContentWorker().pipe(new Crc32Probe);v.on("error",function(T){r(T)}).on("end",function(){v.streamInfo.crc32!==t.decompressed.crc32?r(new Error("Corrupted zip : CRC32 mismatch")):E()}).resume()})}var load=function(t,E){var r=this;return E=utils.extend(E||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:utf8.utf8decode}),nodejsUtils.isNode&&nodejsUtils.isStream(t)?external.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):utils.prepareContent("the loaded zip file",t,!0,E.optimizedBinaryString,E.base64).then(function(v){var T=new ZipEntries(E);return T.load(v),T}).then(function(T){var N=[external.Promise.resolve(T)],k=T.files;if(E.checkCRC32)for(var x=0;x<k.length;x++)N.push(checkEntryCRC32(k[x]));return external.Promise.all(N)}).then(function(T){for(var N=T.shift(),k=N.files,x=0;x<k.length;x++){var ce=k[x],ue=ce.fileNameStr,Z=utils.resolve(ce.fileNameStr);r.file(Z,ce.decompressed,{binary:!0,optimizedBinaryString:!0,date:ce.date,dir:ce.dir,comment:ce.fileCommentStr.length?ce.fileCommentStr:null,unixPermissions:ce.unixPermissions,dosPermissions:ce.dosPermissions,createFolders:E.createFolders}),ce.dir||(r.file(Z).unsafeOriginalName=ue)}return N.zipComment.length&&(r.comment=N.zipComment),r})};function JSZip(){if(!(this instanceof JSZip))return new JSZip;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var t=new JSZip;for(var E in this)typeof this[E]!="function"&&(t[E]=this[E]);return t}}JSZip.prototype=object,JSZip.prototype.loadAsync=load,JSZip.support=support$5,JSZip.defaults=defaults$1,JSZip.version="3.10.1",JSZip.loadAsync=function(t,E){return new JSZip().loadAsync(t,E)},JSZip.external=external$3;var lib=JSZip;const n$1=t=>lib.loadAsync(t),s$1=(t,E)=>{const r=t.file(E);return r?r.async("text"):null},o=(t,E,r)=>t.file(E,r,{binary:!1}),p$1=t=>t.generateAsync({type:"uint8array",compression:"DEFLATE",compressionOptions:{level:1}});var sax={},string_decoder={},safeBuffer={exports:{}};(function(t,E){var r=buffer$1,v=r.Buffer;function T(k,x){for(var ce in k)x[ce]=k[ce]}v.from&&v.alloc&&v.allocUnsafe&&v.allocUnsafeSlow?t.exports=r:(T(r,E),E.Buffer=N);function N(k,x,ce){return v(k,x,ce)}T(v,N),N.from=function(k,x,ce){if(typeof k=="number")throw new TypeError("Argument must not be a number");return v(k,x,ce)},N.alloc=function(k,x,ce){if(typeof k!="number")throw new TypeError("Argument must be a number");var ue=v(k);return x!==void 0?typeof ce=="string"?ue.fill(x,ce):ue.fill(x):ue.fill(0),ue},N.allocUnsafe=function(k){if(typeof k!="number")throw new TypeError("Argument must be a number");return v(k)},N.allocUnsafeSlow=function(k){if(typeof k!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(k)}})(safeBuffer,safeBuffer.exports);var Buffer$1=safeBuffer.exports.Buffer,isEncoding=Buffer$1.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function _normalizeEncoding(t){if(!t)return"utf8";for(var E;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(E)return;t=(""+t).toLowerCase(),E=!0}}function normalizeEncoding(t){var E=_normalizeEncoding(t);if(typeof E!="string"&&(Buffer$1.isEncoding===isEncoding||!isEncoding(t)))throw new Error("Unknown encoding: "+t);return E||t}string_decoder.StringDecoder=StringDecoder;function StringDecoder(t){this.encoding=normalizeEncoding(t);var E;switch(this.encoding){case"utf16le":this.text=utf16Text,this.end=utf16End,E=4;break;case"utf8":this.fillLast=utf8FillLast,E=4;break;case"base64":this.text=base64Text,this.end=base64End,E=3;break;default:this.write=simpleWrite,this.end=simpleEnd;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=Buffer$1.allocUnsafe(E)}StringDecoder.prototype.write=function(t){if(t.length===0)return"";var E,r;if(this.lastNeed){if(E=this.fillLast(t),E===void 0)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?E?E+this.text(t,r):this.text(t,r):E||""},StringDecoder.prototype.end=utf8End,StringDecoder.prototype.text=utf8Text,StringDecoder.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function utf8CheckByte(t){return t<=127?0:t>>5===6?2:t>>4===14?3:t>>3===30?4:t>>6===2?-1:-2}function utf8CheckIncomplete(t,E,r){var v=E.length-1;if(v<r)return 0;var T=utf8CheckByte(E[v]);return T>=0?(T>0&&(t.lastNeed=T-1),T):--v<r||T===-2?0:(T=utf8CheckByte(E[v]),T>=0?(T>0&&(t.lastNeed=T-2),T):--v<r||T===-2?0:(T=utf8CheckByte(E[v]),T>=0?(T>0&&(T===2?T=0:t.lastNeed=T-3),T):0))}function utf8CheckExtraBytes(t,E,r){if((E[0]&192)!==128)return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&E.length>1){if((E[1]&192)!==128)return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&E.length>2&&(E[2]&192)!==128)return t.lastNeed=2,"\uFFFD"}}function utf8FillLast(t){var E=this.lastTotal-this.lastNeed,r=utf8CheckExtraBytes(this,t);if(r!==void 0)return r;if(this.lastNeed<=t.length)return t.copy(this.lastChar,E,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,E,0,t.length),this.lastNeed-=t.length}function utf8Text(t,E){var r=utf8CheckIncomplete(this,t,E);if(!this.lastNeed)return t.toString("utf8",E);this.lastTotal=r;var v=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,v),t.toString("utf8",E,v)}function utf8End(t){var E=t&&t.length?this.write(t):"";return this.lastNeed?E+"\uFFFD":E}function utf16Text(t,E){if((t.length-E)%2===0){var r=t.toString("utf16le",E);if(r){var v=r.charCodeAt(r.length-1);if(v>=55296&&v<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",E,t.length-1)}function utf16End(t){var E=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return E+this.lastChar.toString("utf16le",0,r)}return E}function base64Text(t,E){var r=(t.length-E)%3;return r===0?t.toString("base64",E):(this.lastNeed=3-r,this.lastTotal=3,r===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",E,t.length-r))}function base64End(t){var E=t&&t.length?this.write(t):"";return this.lastNeed?E+this.lastChar.toString("base64",0,3-this.lastNeed):E}function simpleWrite(t){return t.toString(this.encoding)}function simpleEnd(t){return t&&t.length?this.write(t):""}(function(t){(function(E){E.parser=function(he,O){return new v(he,O)},E.SAXParser=v,E.SAXStream=Z,E.createStream=ue,E.MAX_BUFFER_LENGTH=64*1024;var r=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];E.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function v(he,O){if(!(this instanceof v))return new v(he,O);var Ce=this;N(Ce),Ce.q=Ce.c="",Ce.bufferCheckPosition=E.MAX_BUFFER_LENGTH,Ce.opt=O||{},Ce.opt.lowercase=Ce.opt.lowercase||Ce.opt.lowercasetags,Ce.looseCase=Ce.opt.lowercase?"toLowerCase":"toUpperCase",Ce.tags=[],Ce.closed=Ce.closedRoot=Ce.sawRoot=!1,Ce.tag=Ce.error=null,Ce.strict=!!he,Ce.noscript=!!(he||Ce.opt.noscript),Ce.state=ve.BEGIN,Ce.strictEntities=Ce.opt.strictEntities,Ce.ENTITIES=Ce.strictEntities?Object.create(E.XML_ENTITIES):Object.create(E.ENTITIES),Ce.attribList=[],Ce.opt.xmlns&&(Ce.ns=Object.create(Te)),Ce.trackPosition=Ce.opt.position!==!1,Ce.trackPosition&&(Ce.position=Ce.line=Ce.column=0),Oe(Ce,"onready")}Object.create||(Object.create=function(he){function O(){}O.prototype=he;var Ce=new O;return Ce}),Object.keys||(Object.keys=function(he){var O=[];for(var Ce in he)he.hasOwnProperty(Ce)&&O.push(Ce);return O});function T(he){for(var O=Math.max(E.MAX_BUFFER_LENGTH,10),Ce=0,xe=0,ze=r.length;xe<ze;xe++){var Ye=he[r[xe]].length;if(Ye>O)switch(r[xe]){case"textNode":Je(he);break;case"cdata":Me(he,"oncdata",he.cdata),he.cdata="";break;case"script":Me(he,"onscript",he.script),he.script="";break;default:rt(he,"Max buffer length exceeded: "+r[xe])}Ce=Math.max(Ce,Ye)}var We=E.MAX_BUFFER_LENGTH-Ce;he.bufferCheckPosition=We+he.position}function N(he){for(var O=0,Ce=r.length;O<Ce;O++)he[r[O]]=""}function k(he){Je(he),he.cdata!==""&&(Me(he,"oncdata",he.cdata),he.cdata=""),he.script!==""&&(Me(he,"onscript",he.script),he.script="")}v.prototype={end:function(){ot(this)},write:mt,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){k(this)}};var x;try{x=require("stream").Stream}catch(he){x=function(){}}x||(x=function(){});var ce=E.EVENTS.filter(function(he){return he!=="error"&&he!=="end"});function ue(he,O){return new Z(he,O)}function Z(he,O){if(!(this instanceof Z))return new Z(he,O);x.apply(this),this._parser=new v(he,O),this.writable=!0,this.readable=!0;var Ce=this;this._parser.onend=function(){Ce.emit("end")},this._parser.onerror=function(xe){Ce.emit("error",xe),Ce._parser.error=null},this._decoder=null,ce.forEach(function(xe){Object.defineProperty(Ce,"on"+xe,{get:function(){return Ce._parser["on"+xe]},set:function(ze){if(!ze)return Ce.removeAllListeners(xe),Ce._parser["on"+xe]=ze,ze;Ce.on(xe,ze)},enumerable:!0,configurable:!1})})}Z.prototype=Object.create(x.prototype,{constructor:{value:Z}}),Z.prototype.write=function(he){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(he)){if(!this._decoder){var O=string_decoder.StringDecoder;this._decoder=new O("utf8")}he=this._decoder.write(he)}return this._parser.write(he.toString()),this.emit("data",he),!0},Z.prototype.end=function(he){return he&&he.length&&this.write(he),this._parser.end(),!0},Z.prototype.on=function(he,O){var Ce=this;return!Ce._parser["on"+he]&&ce.indexOf(he)!==-1&&(Ce._parser["on"+he]=function(){var xe=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);xe.splice(0,0,he),Ce.emit.apply(Ce,xe)}),x.prototype.on.call(Ce,he,O)};var $e="[CDATA[",Ee="DOCTYPE",ge="http://www.w3.org/XML/1998/namespace",ye="http://www.w3.org/2000/xmlns/",Te={xml:ge,xmlns:ye},Se=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Ie=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,Ae=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,Re=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function ke(he){return he===" "||he===`
`||he==="\r"||he==="	"}function De(he){return he==='"'||he==="'"}function Le(he){return he===">"||ke(he)}function Be(he,O){return he.test(O)}function Fe(he,O){return!Be(he,O)}var ve=0;E.STATE={BEGIN:ve++,BEGIN_WHITESPACE:ve++,TEXT:ve++,TEXT_ENTITY:ve++,OPEN_WAKA:ve++,SGML_DECL:ve++,SGML_DECL_QUOTED:ve++,DOCTYPE:ve++,DOCTYPE_QUOTED:ve++,DOCTYPE_DTD:ve++,DOCTYPE_DTD_QUOTED:ve++,COMMENT_STARTING:ve++,COMMENT:ve++,COMMENT_ENDING:ve++,COMMENT_ENDED:ve++,CDATA:ve++,CDATA_ENDING:ve++,CDATA_ENDING_2:ve++,PROC_INST:ve++,PROC_INST_BODY:ve++,PROC_INST_ENDING:ve++,OPEN_TAG:ve++,OPEN_TAG_SLASH:ve++,ATTRIB:ve++,ATTRIB_NAME:ve++,ATTRIB_NAME_SAW_WHITE:ve++,ATTRIB_VALUE:ve++,ATTRIB_VALUE_QUOTED:ve++,ATTRIB_VALUE_CLOSED:ve++,ATTRIB_VALUE_UNQUOTED:ve++,ATTRIB_VALUE_ENTITY_Q:ve++,ATTRIB_VALUE_ENTITY_U:ve++,CLOSE_TAG:ve++,CLOSE_TAG_SAW_WHITE:ve++,SCRIPT:ve++,SCRIPT_ENDING:ve++},E.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},E.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(E.ENTITIES).forEach(function(he){var O=E.ENTITIES[he],Ce=typeof O=="number"?String.fromCharCode(O):O;E.ENTITIES[he]=Ce});for(var Ze in E.STATE)E.STATE[E.STATE[Ze]]=Ze;ve=E.STATE;function Oe(he,O,Ce){he[O]&&he[O](Ce)}function Me(he,O,Ce){he.textNode&&Je(he),Oe(he,O,Ce)}function Je(he){he.textNode=et(he.opt,he.textNode),he.textNode&&Oe(he,"ontext",he.textNode),he.textNode=""}function et(he,O){return he.trim&&(O=O.trim()),he.normalize&&(O=O.replace(/\s+/g," ")),O}function rt(he,O){return Je(he),he.trackPosition&&(O+=`
Line: `+he.line+`
Column: `+he.column+`
Char: `+he.c),O=new Error(O),he.error=O,Oe(he,"onerror",O),he}function ot(he){return he.sawRoot&&!he.closedRoot&&Ue(he,"Unclosed root tag"),he.state!==ve.BEGIN&&he.state!==ve.BEGIN_WHITESPACE&&he.state!==ve.TEXT&&rt(he,"Unexpected end"),Je(he),he.c="",he.closed=!0,Oe(he,"onend"),v.call(he,he.strict,he.opt),he}function Ue(he,O){if(typeof he!="object"||!(he instanceof v))throw new Error("bad call to strictFail");he.strict&&rt(he,O)}function at(he){he.strict||(he.tagName=he.tagName[he.looseCase]());var O=he.tags[he.tags.length-1]||he,Ce=he.tag={name:he.tagName,attributes:{}};he.opt.xmlns&&(Ce.ns=O.ns),he.attribList.length=0,Me(he,"onopentagstart",Ce)}function ut(he,O){var Ce=he.indexOf(":"),xe=Ce<0?["",he]:he.split(":"),ze=xe[0],Ye=xe[1];return O&&he==="xmlns"&&(ze="xmlns",Ye=""),{prefix:ze,local:Ye}}function ct(he){if(he.strict||(he.attribName=he.attribName[he.looseCase]()),he.attribList.indexOf(he.attribName)!==-1||he.tag.attributes.hasOwnProperty(he.attribName)){he.attribName=he.attribValue="";return}if(he.opt.xmlns){var O=ut(he.attribName,!0),Ce=O.prefix,xe=O.local;if(Ce==="xmlns")if(xe==="xml"&&he.attribValue!==ge)Ue(he,"xml: prefix must be bound to "+ge+`
Actual: `+he.attribValue);else if(xe==="xmlns"&&he.attribValue!==ye)Ue(he,"xmlns: prefix must be bound to "+ye+`
Actual: `+he.attribValue);else{var ze=he.tag,Ye=he.tags[he.tags.length-1]||he;ze.ns===Ye.ns&&(ze.ns=Object.create(Ye.ns)),ze.ns[xe]=he.attribValue}he.attribList.push([he.attribName,he.attribValue])}else he.tag.attributes[he.attribName]=he.attribValue,Me(he,"onattribute",{name:he.attribName,value:he.attribValue});he.attribName=he.attribValue=""}function je(he,O){if(he.opt.xmlns){var Ce=he.tag,xe=ut(he.tagName);Ce.prefix=xe.prefix,Ce.local=xe.local,Ce.uri=Ce.ns[xe.prefix]||"",Ce.prefix&&!Ce.uri&&(Ue(he,"Unbound namespace prefix: "+JSON.stringify(he.tagName)),Ce.uri=xe.prefix);var ze=he.tags[he.tags.length-1]||he;Ce.ns&&ze.ns!==Ce.ns&&Object.keys(Ce.ns).forEach(function(it){Me(he,"onopennamespace",{prefix:it,uri:Ce.ns[it]})});for(var Ye=0,We=he.attribList.length;Ye<We;Ye++){var qe=he.attribList[Ye],tt=qe[0],st=qe[1],Ve=ut(tt,!0),nt=Ve.prefix,gt=Ve.local,pt=nt===""?"":Ce.ns[nt]||"",lt={name:tt,value:st,prefix:nt,local:gt,uri:pt};nt&&nt!=="xmlns"&&!pt&&(Ue(he,"Unbound namespace prefix: "+JSON.stringify(nt)),lt.uri=nt),he.tag.attributes[tt]=lt,Me(he,"onattribute",lt)}he.attribList.length=0}he.tag.isSelfClosing=!!O,he.sawRoot=!0,he.tags.push(he.tag),Me(he,"onopentag",he.tag),O||(!he.noscript&&he.tagName.toLowerCase()==="script"?he.state=ve.SCRIPT:he.state=ve.TEXT,he.tag=null,he.tagName=""),he.attribName=he.attribValue="",he.attribList.length=0}function Qe(he){if(!he.tagName){Ue(he,"Weird empty close tag."),he.textNode+="</>",he.state=ve.TEXT;return}if(he.script){if(he.tagName!=="script"){he.script+="</"+he.tagName+">",he.tagName="",he.state=ve.SCRIPT;return}Me(he,"onscript",he.script),he.script=""}var O=he.tags.length,Ce=he.tagName;he.strict||(Ce=Ce[he.looseCase]());for(var xe=Ce;O--;){var ze=he.tags[O];if(ze.name!==xe)Ue(he,"Unexpected close tag");else break}if(O<0){Ue(he,"Unmatched closing tag: "+he.tagName),he.textNode+="</"+he.tagName+">",he.state=ve.TEXT;return}he.tagName=Ce;for(var Ye=he.tags.length;Ye-- >O;){var We=he.tag=he.tags.pop();he.tagName=he.tag.name,Me(he,"onclosetag",he.tagName);var qe={};for(var tt in We.ns)qe[tt]=We.ns[tt];var st=he.tags[he.tags.length-1]||he;he.opt.xmlns&&We.ns!==st.ns&&Object.keys(We.ns).forEach(function(Ve){var nt=We.ns[Ve];Me(he,"onclosenamespace",{prefix:Ve,uri:nt})})}O===0&&(he.closedRoot=!0),he.tagName=he.attribValue=he.attribName="",he.attribList.length=0,he.state=ve.TEXT}function ht(he){var O=he.entity,Ce=O.toLowerCase(),xe,ze="";return he.ENTITIES[O]?he.ENTITIES[O]:he.ENTITIES[Ce]?he.ENTITIES[Ce]:(O=Ce,O.charAt(0)==="#"&&(O.charAt(1)==="x"?(O=O.slice(2),xe=parseInt(O,16),ze=xe.toString(16)):(O=O.slice(1),xe=parseInt(O,10),ze=xe.toString(10))),O=O.replace(/^0+/,""),isNaN(xe)||ze.toLowerCase()!==O?(Ue(he,"Invalid character entity"),"&"+he.entity+";"):String.fromCodePoint(xe))}function dt(he,O){O==="<"?(he.state=ve.OPEN_WAKA,he.startTagPosition=he.position):ke(O)||(Ue(he,"Non-whitespace before first tag."),he.textNode=O,he.state=ve.TEXT)}function _t(he,O){var Ce="";return O<he.length&&(Ce=he.charAt(O)),Ce}function mt(he){var O=this;if(this.error)throw this.error;if(O.closed)return rt(O,"Cannot write after close. Assign an onready handler.");if(he===null)return ot(O);typeof he=="object"&&(he=he.toString());for(var Ce=0,xe="";xe=_t(he,Ce++),O.c=xe,!!xe;)switch(O.trackPosition&&(O.position++,xe===`
`?(O.line++,O.column=0):O.column++),O.state){case ve.BEGIN:if(O.state=ve.BEGIN_WHITESPACE,xe==="\uFEFF")continue;dt(O,xe);continue;case ve.BEGIN_WHITESPACE:dt(O,xe);continue;case ve.TEXT:if(O.sawRoot&&!O.closedRoot){for(var ze=Ce-1;xe&&xe!=="<"&&xe!=="&";)xe=_t(he,Ce++),xe&&O.trackPosition&&(O.position++,xe===`
`?(O.line++,O.column=0):O.column++);O.textNode+=he.substring(ze,Ce-1)}xe==="<"&&!(O.sawRoot&&O.closedRoot&&!O.strict)?(O.state=ve.OPEN_WAKA,O.startTagPosition=O.position):(!ke(xe)&&(!O.sawRoot||O.closedRoot)&&Ue(O,"Text data outside of root node."),xe==="&"?O.state=ve.TEXT_ENTITY:O.textNode+=xe);continue;case ve.SCRIPT:xe==="<"?O.state=ve.SCRIPT_ENDING:O.script+=xe;continue;case ve.SCRIPT_ENDING:xe==="/"?O.state=ve.CLOSE_TAG:(O.script+="<"+xe,O.state=ve.SCRIPT);continue;case ve.OPEN_WAKA:if(xe==="!")O.state=ve.SGML_DECL,O.sgmlDecl="";else if(!ke(xe))if(Be(Se,xe))O.state=ve.OPEN_TAG,O.tagName=xe;else if(xe==="/")O.state=ve.CLOSE_TAG,O.tagName="";else if(xe==="?")O.state=ve.PROC_INST,O.procInstName=O.procInstBody="";else{if(Ue(O,"Unencoded <"),O.startTagPosition+1<O.position){var Ye=O.position-O.startTagPosition;xe=new Array(Ye).join(" ")+xe}O.textNode+="<"+xe,O.state=ve.TEXT}continue;case ve.SGML_DECL:(O.sgmlDecl+xe).toUpperCase()===$e?(Me(O,"onopencdata"),O.state=ve.CDATA,O.sgmlDecl="",O.cdata=""):O.sgmlDecl+xe==="--"?(O.state=ve.COMMENT,O.comment="",O.sgmlDecl=""):(O.sgmlDecl+xe).toUpperCase()===Ee?(O.state=ve.DOCTYPE,(O.doctype||O.sawRoot)&&Ue(O,"Inappropriately located doctype declaration"),O.doctype="",O.sgmlDecl=""):xe===">"?(Me(O,"onsgmldeclaration",O.sgmlDecl),O.sgmlDecl="",O.state=ve.TEXT):(De(xe)&&(O.state=ve.SGML_DECL_QUOTED),O.sgmlDecl+=xe);continue;case ve.SGML_DECL_QUOTED:xe===O.q&&(O.state=ve.SGML_DECL,O.q=""),O.sgmlDecl+=xe;continue;case ve.DOCTYPE:xe===">"?(O.state=ve.TEXT,Me(O,"ondoctype",O.doctype),O.doctype=!0):(O.doctype+=xe,xe==="["?O.state=ve.DOCTYPE_DTD:De(xe)&&(O.state=ve.DOCTYPE_QUOTED,O.q=xe));continue;case ve.DOCTYPE_QUOTED:O.doctype+=xe,xe===O.q&&(O.q="",O.state=ve.DOCTYPE);continue;case ve.DOCTYPE_DTD:O.doctype+=xe,xe==="]"?O.state=ve.DOCTYPE:De(xe)&&(O.state=ve.DOCTYPE_DTD_QUOTED,O.q=xe);continue;case ve.DOCTYPE_DTD_QUOTED:O.doctype+=xe,xe===O.q&&(O.state=ve.DOCTYPE_DTD,O.q="");continue;case ve.COMMENT:xe==="-"?O.state=ve.COMMENT_ENDING:O.comment+=xe;continue;case ve.COMMENT_ENDING:xe==="-"?(O.state=ve.COMMENT_ENDED,O.comment=et(O.opt,O.comment),O.comment&&Me(O,"oncomment",O.comment),O.comment=""):(O.comment+="-"+xe,O.state=ve.COMMENT);continue;case ve.COMMENT_ENDED:xe!==">"?(Ue(O,"Malformed comment"),O.comment+="--"+xe,O.state=ve.COMMENT):O.state=ve.TEXT;continue;case ve.CDATA:xe==="]"?O.state=ve.CDATA_ENDING:O.cdata+=xe;continue;case ve.CDATA_ENDING:xe==="]"?O.state=ve.CDATA_ENDING_2:(O.cdata+="]"+xe,O.state=ve.CDATA);continue;case ve.CDATA_ENDING_2:xe===">"?(O.cdata&&Me(O,"oncdata",O.cdata),Me(O,"onclosecdata"),O.cdata="",O.state=ve.TEXT):xe==="]"?O.cdata+="]":(O.cdata+="]]"+xe,O.state=ve.CDATA);continue;case ve.PROC_INST:xe==="?"?O.state=ve.PROC_INST_ENDING:ke(xe)?O.state=ve.PROC_INST_BODY:O.procInstName+=xe;continue;case ve.PROC_INST_BODY:if(!O.procInstBody&&ke(xe))continue;xe==="?"?O.state=ve.PROC_INST_ENDING:O.procInstBody+=xe;continue;case ve.PROC_INST_ENDING:xe===">"?(Me(O,"onprocessinginstruction",{name:O.procInstName,body:O.procInstBody}),O.procInstName=O.procInstBody="",O.state=ve.TEXT):(O.procInstBody+="?"+xe,O.state=ve.PROC_INST_BODY);continue;case ve.OPEN_TAG:Be(Ie,xe)?O.tagName+=xe:(at(O),xe===">"?je(O):xe==="/"?O.state=ve.OPEN_TAG_SLASH:(ke(xe)||Ue(O,"Invalid character in tag name"),O.state=ve.ATTRIB));continue;case ve.OPEN_TAG_SLASH:xe===">"?(je(O,!0),Qe(O)):(Ue(O,"Forward-slash in opening tag not followed by >"),O.state=ve.ATTRIB);continue;case ve.ATTRIB:if(ke(xe))continue;xe===">"?je(O):xe==="/"?O.state=ve.OPEN_TAG_SLASH:Be(Se,xe)?(O.attribName=xe,O.attribValue="",O.state=ve.ATTRIB_NAME):Ue(O,"Invalid attribute name");continue;case ve.ATTRIB_NAME:xe==="="?O.state=ve.ATTRIB_VALUE:xe===">"?(Ue(O,"Attribute without value"),O.attribValue=O.attribName,ct(O),je(O)):ke(xe)?O.state=ve.ATTRIB_NAME_SAW_WHITE:Be(Ie,xe)?O.attribName+=xe:Ue(O,"Invalid attribute name");continue;case ve.ATTRIB_NAME_SAW_WHITE:if(xe==="=")O.state=ve.ATTRIB_VALUE;else{if(ke(xe))continue;Ue(O,"Attribute without value"),O.tag.attributes[O.attribName]="",O.attribValue="",Me(O,"onattribute",{name:O.attribName,value:""}),O.attribName="",xe===">"?je(O):Be(Se,xe)?(O.attribName=xe,O.state=ve.ATTRIB_NAME):(Ue(O,"Invalid attribute name"),O.state=ve.ATTRIB)}continue;case ve.ATTRIB_VALUE:if(ke(xe))continue;De(xe)?(O.q=xe,O.state=ve.ATTRIB_VALUE_QUOTED):(Ue(O,"Unquoted attribute value"),O.state=ve.ATTRIB_VALUE_UNQUOTED,O.attribValue=xe);continue;case ve.ATTRIB_VALUE_QUOTED:if(xe!==O.q){xe==="&"?O.state=ve.ATTRIB_VALUE_ENTITY_Q:O.attribValue+=xe;continue}ct(O),O.q="",O.state=ve.ATTRIB_VALUE_CLOSED;continue;case ve.ATTRIB_VALUE_CLOSED:ke(xe)?O.state=ve.ATTRIB:xe===">"?je(O):xe==="/"?O.state=ve.OPEN_TAG_SLASH:Be(Se,xe)?(Ue(O,"No whitespace between attributes"),O.attribName=xe,O.attribValue="",O.state=ve.ATTRIB_NAME):Ue(O,"Invalid attribute name");continue;case ve.ATTRIB_VALUE_UNQUOTED:if(!Le(xe)){xe==="&"?O.state=ve.ATTRIB_VALUE_ENTITY_U:O.attribValue+=xe;continue}ct(O),xe===">"?je(O):O.state=ve.ATTRIB;continue;case ve.CLOSE_TAG:if(O.tagName)xe===">"?Qe(O):Be(Ie,xe)?O.tagName+=xe:O.script?(O.script+="</"+O.tagName,O.tagName="",O.state=ve.SCRIPT):(ke(xe)||Ue(O,"Invalid tagname in closing tag"),O.state=ve.CLOSE_TAG_SAW_WHITE);else{if(ke(xe))continue;Fe(Se,xe)?O.script?(O.script+="</"+xe,O.state=ve.SCRIPT):Ue(O,"Invalid tagname in closing tag."):O.tagName=xe}continue;case ve.CLOSE_TAG_SAW_WHITE:if(ke(xe))continue;xe===">"?Qe(O):Ue(O,"Invalid characters in closing tag");continue;case ve.TEXT_ENTITY:case ve.ATTRIB_VALUE_ENTITY_Q:case ve.ATTRIB_VALUE_ENTITY_U:var We,qe;switch(O.state){case ve.TEXT_ENTITY:We=ve.TEXT,qe="textNode";break;case ve.ATTRIB_VALUE_ENTITY_Q:We=ve.ATTRIB_VALUE_QUOTED,qe="attribValue";break;case ve.ATTRIB_VALUE_ENTITY_U:We=ve.ATTRIB_VALUE_UNQUOTED,qe="attribValue";break}if(xe===";")if(O.opt.unparsedEntities){var tt=ht(O);O.entity="",O.state=We,O.write(tt)}else O[qe]+=ht(O),O.entity="",O.state=We;else Be(O.entity.length?Re:Ae,xe)?O.entity+=xe:(Ue(O,"Invalid character in entity name"),O[qe]+="&"+O.entity+xe,O.entity="",O.state=We);continue;default:throw new Error(O,"Unknown state: "+O.state)}return O.position>=O.bufferCheckPosition&&T(O),O}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var he=String.fromCharCode,O=Math.floor,Ce=function(){var xe=16384,ze=[],Ye,We,qe=-1,tt=arguments.length;if(!tt)return"";for(var st="";++qe<tt;){var Ve=Number(arguments[qe]);if(!isFinite(Ve)||Ve<0||Ve>1114111||O(Ve)!==Ve)throw RangeError("Invalid code point: "+Ve);Ve<=65535?ze.push(Ve):(Ve-=65536,Ye=(Ve>>10)+55296,We=Ve%1024+56320,ze.push(Ye,We)),(qe+1===tt||ze.length>xe)&&(st+=he.apply(null,ze),ze.length=0)}return st};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:Ce,configurable:!0,writable:!0}):String.fromCodePoint=Ce}()})(t)})(sax);const logger={debug:()=>{}},g$2=t=>{const E=sax.parser(!0,{trim:!1,normalize:!1});let r,v=null;return new Promise((T,N)=>{E.onopentag=k=>{const x={_parent:v||void 0,_children:[],_fTextNode:!1,_tag:k.name,_attrs:k.attributes};v!=null?v._children.push(x):r=x,v=x},E.onclosetag=()=>{v=v!=null?v._parent:null},E.ontext=k=>{v!=null&&v._children.push({_parent:v,_children:[],_fTextNode:!0,_text:k})},E.onend=()=>{T(r)},E.onerror=k=>{N(k)},E.write(t),E.end()})};function m(t,E,r=""){const v=r.length?"":'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>',T=[Buffer.from(v,"utf-8")];if(t._fTextNode)T.push(Buffer.from(d(t._text,E)));else{let N="";const k=t._attrs;Object.keys(k).forEach(Z=>{N+=` ${Z}="${_$2(k[Z])}"`});const x=t._children.length>0,ce=x?"":"/";T.push(Buffer.from(`
${r}<${t._tag}${N}${ce}>`));let ue=!1;if(t._children.forEach(Z=>{T.push(m(Z,E,`${r}  `)),ue=!Z._fTextNode}),x){const Z=ue?`
${r}`:"";T.push(Buffer.from(`${Z}</${t._tag}>`))}}return Buffer.concat(T)}const d=(t,E)=>{let r="";const v=t.split(E.literalXmlDelimiter);let T=!1;for(let N=0;N<v.length;N++){let k=v[N];T||(k=k.replace(/&/g,"&amp;"),k=k.replace(/</g,"&lt;"),k=k.replace(/>/g,"&gt;")),r+=k,T=!T}return r},_$2=t=>{let E=typeof t=="string"?t:t.value;return E=E.replace(/&/g,"&amp;"),E=E.replace(/</g,"&lt;"),E=E.replace(/>/g,"&gt;"),E=E.replace(/'/g,"&apos;"),E=E.replace(/"/g,"&quot;"),E};var n=Object.defineProperty,c$2=(t,E,r)=>E in t?n(t,E,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[E]=r,e=(t,E,r)=>c$2(t,typeof E!="symbol"?E+"":E,r);function isError(t){return t instanceof Error||typeof t=="object"&&!!t&&"name"in t&&"message"in t}class NullishCommandResultError extends Error{constructor(E){super(`Result of command ${E} is null or undefined and rejectNullish is set`),e(this,"command"),Object.setPrototypeOf(this,NullishCommandResultError.prototype),this.command=E}}class ObjectCommandResultError extends Error{constructor(E,r){super(`Result of command '${E}' is an object`),e(this,"command"),e(this,"result"),Object.setPrototypeOf(this,ObjectCommandResultError.prototype),this.command=E,this.result=r}}class CommandSyntaxError extends Error{constructor(E){super(`Invalid command syntax: ${E}`),e(this,"command"),Object.setPrototypeOf(this,CommandSyntaxError.prototype),this.command=E}}class InvalidCommandError extends Error{constructor(E,r){super(`${E}: ${r}`),e(this,"command"),Object.setPrototypeOf(this,InvalidCommandError.prototype),this.command=r}}class CommandExecutionError extends Error{constructor(E,r){super(`Error executing command '${r}': ${E.name}: ${E.message}`),e(this,"command"),e(this,"err"),Object.setPrototypeOf(this,CommandExecutionError.prototype),this.command=r,this.err=E}}class ImageError extends CommandExecutionError{}class InternalError extends Error{constructor(E){super(`INTERNAL ERROR: ${E}`)}}class TemplateParseError extends Error{}class IncompleteConditionalStatementError extends Error{constructor(){super("Incomplete IF/END-IF statement. Make sure each IF-statement has a corresponding END-IF command.")}}class UnterminatedForLoopError extends Error{constructor(E){super(`Unterminated FOR-loop ('FOR ${E.varName}'). Make sure each FOR loop has a corresponding END-FOR command.`)}}const i=t=>t._fTextNode?{_children:[],_fTextNode:!0,_text:t._text}:{_children:[],_fTextNode:!1,_tag:t._tag,_attrs:t._attrs},_$1=t=>{const E=t._parent;if(E==null)return null;const r=E._children,v=r.indexOf(t);return v<0||v>=r.length-1?null:r[v+1]},a$1=t=>{const E=t._parent;if(!(E&&!E._fTextNode&&E._tag==="w:t"))throw new TemplateParseError("Template syntax error: text node not within w:t");const r=E._parent;if(r==null)throw new TemplateParseError("Template syntax error: w:t node has no parent");const v=r._children.indexOf(E);if(v<0)throw new TemplateParseError("Template syntax error");const T=i(E);T._parent=r;const N={_parent:T,_children:[],_fTextNode:!0,_text:""};return T._children=[N],r._children.splice(v+1,0,T),N},c$1=(t,E={},r=[])=>{const v={_fTextNode:!1,_tag:t,_attrs:E,_children:r};return v._children.forEach(T=>{T._parent=v}),v},u=t=>({_children:[],_fTextNode:!0,_text:t}),p=(t,E)=>(t._children.push(E),E._parent=t,E),s=t=>t.loops.length?t.loops[t.loops.length-1]:null,f$1=t=>{const E=s(t);return E!=null&&E.idx<0},h$1=t=>{if(!t.length)return;const E=t.length-1,{varName:r,idx:v,loopOver:T,isIf:N}=t[E],k=v>=0?v+1:"EXPLORATION";logger.debug(`${N?"IF":"FOR"} loop on ${E}:${r}${k}/${T.length}`)},g$1=(t,E)=>{let r=t,v=!1,T=null,N=0;const k=`${E[0]}CMD_NODE${E[1]}`;for(;r!=null;){if(!r._fTextNode&&r._tag==="w:t"&&(r._attrs["xml:space"]="preserve"),!r._fTextNode&&r._tag==="w:p"&&T&&(T._text+=" "),r._fTextNode&&r._parent&&!r._parent._fTextNode&&r._parent._tag==="w:t"){T==null&&(T=r);const x=r._text;r._text="";for(let ce=0;ce<x.length;ce++){const ue=x[ce],Z=v?E[1]:E[0];if(ue===Z[N]){if(N+=1,N===Z.length){v=!v;const $e=r===T;v&&T._text.length&&(T=a$1(T),$e&&(r=T)),T._text+=Z,!v&&ce<x.length-1&&(T=a$1(T),$e&&(r=T)),N=0,v||(T=r)}}else N&&(T._text+=Z.slice(0,N),N=0,v||(T=r)),T._text+=ue}!v&&!N&&(T=null),x.length&&!r._text.length&&(r._text=k)}if(r._children.length)r=r._children[0];else{let x=!1;for(;r._parent!=null;){const ce=r._parent,ue=_$1(r);if(ue){x=!0,r=ue;break}r=ce}x||(r=null)}}return t};var vmBrowserify={};(function(exports){var indexOf=function(t,E){if(t.indexOf)return t.indexOf(E);for(var r=0;r<t.length;r++)if(t[r]===E)return r;return-1},Object_keys=function(t){if(Object.keys)return Object.keys(t);var E=[];for(var r in t)E.push(r);return E},forEach=function(t,E){if(t.forEach)return t.forEach(E);for(var r=0;r<t.length;r++)E(t[r],r,t)},defineProp=function(){try{return Object.defineProperty({},"_",{}),function(t,E,r){Object.defineProperty(t,E,{writable:!0,enumerable:!1,configurable:!0,value:r})}}catch(t){return function(E,r,v){E[r]=v}}}(),globals=["Array","Boolean","Date","Error","EvalError","Function","Infinity","JSON","Math","NaN","Number","Object","RangeError","ReferenceError","RegExp","String","SyntaxError","TypeError","URIError","decodeURI","decodeURIComponent","encodeURI","encodeURIComponent","escape","eval","isFinite","isNaN","parseFloat","parseInt","undefined","unescape"];function Context(){}Context.prototype={};var Script=exports.Script=function(E){if(!(this instanceof Script))return new Script(E);this.code=E};Script.prototype.runInContext=function(t){if(!(t instanceof Context))throw new TypeError("needs a 'context' argument.");var E=document.createElement("iframe");E.style||(E.style={}),E.style.display="none",document.body.appendChild(E);var r=E.contentWindow,v=r.eval,T=r.execScript;!v&&T&&(T.call(r,"null"),v=r.eval),forEach(Object_keys(t),function(x){r[x]=t[x]}),forEach(globals,function(x){t[x]&&(r[x]=t[x])});var N=Object_keys(r),k=v.call(r,this.code);return forEach(Object_keys(r),function(x){(x in t||indexOf(N,x)===-1)&&(t[x]=r[x])}),forEach(globals,function(x){x in t||defineProp(t,x,r[x])}),document.body.removeChild(E),k},Script.prototype.runInThisContext=function(){return eval(this.code)},Script.prototype.runInNewContext=function(t){var E=Script.createContext(t),r=this.runInContext(E);return t&&forEach(Object_keys(E),function(v){t[v]=E[v]}),r},forEach(Object_keys(Script.prototype),function(t){exports[t]=Script[t]=function(E){var r=Script(E);return r[t].apply(r,[].slice.call(arguments,1))}}),exports.isContext=function(t){return t instanceof Context},exports.createScript=function(t){return exports.Script(t)},exports.createContext=Script.createContext=function(t){var E=new Context;return typeof t=="object"&&forEach(Object_keys(t),function(r){E[r]=t[r]}),E}})(vmBrowserify);var w=Object.defineProperty,C=Object.defineProperties,c=Object.getOwnPropertyDescriptors,_=Object.getOwnPropertySymbols,h=Object.prototype.hasOwnProperty,b$1=Object.prototype.propertyIsEnumerable,f=(t,E,r)=>E in t?w(t,E,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[E]=r,a=(t,E)=>{for(var r in E||(E={}))h.call(E,r)&&f(t,r,E[r]);if(_)for(var r of _(E))b$1.call(E,r)&&f(t,r,E[r]);return t},l=(t,E)=>C(t,c(E));async function runUserJsAndGetRaw(t,E,r){var v;const T=a(a(l(a({},r.jsSandbox||{}),{__code__:E,__result__:void 0}),t),r.options.additionalJsContext),N=s(r);N&&!N.isIf&&(T.$idx=N.idx),Object.keys(r.vars).forEach(ce=>{T[`$${ce}`]=r.vars[ce]});let k,x;try{if(r.options.runJs){const ce=r.options.runJs({sandbox:T,ctx:r});k=ce.modifiedSandbox,x=await ce.result}else if(r.options.noSandbox)k=T,x=await new Function("with(this) { return eval(__code__); }").call(k);else{const ce=new vmBrowserify.Script((v=T.__code__)!=null?v:"");k=vmBrowserify.createContext(T),x=await ce.runInContext(k)}}catch(ce){const ue=isError(ce)?ce:new Error(`${ce}`);if(r.options.errorHandler!=null)k=T,x=await r.options.errorHandler(ue,E);else throw new CommandExecutionError(ue,E)}if(r.options.rejectNullish&&x==null){const ce=new NullishCommandResultError(E);if(r.options.errorHandler!=null)x=await r.options.errorHandler(ce,E);else throw ce}return r.jsSandbox=l(a({},k),{__code__:void 0,__result__:void 0}),x}const ImageExtensions=[".png",".gif",".jpg",".jpeg",".svg"],BUILT_IN_COMMANDS=["QUERY","CMD_NODE","ALIAS","FOR","END-FOR","IF","END-IF","INS","EXEC","IMAGE","LINK","HTML"];var Q=Object.defineProperty,j=Object.defineProperties,G=Object.getOwnPropertyDescriptors,S=Object.getOwnPropertySymbols,W=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable,L=(t,E,r)=>E in t?Q(t,E,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[E]=r,$=(t,E)=>{for(var r in E||(E={}))W.call(E,r)&&L(t,r,E[r]);if(S)for(var r of S(E))X.call(E,r)&&L(t,r,E[r]);return t},A=(t,E)=>j(t,G(E));function newContext(t,E=0){return{gCntIf:0,gCntEndIf:0,level:1,fCmd:!1,cmd:"",fSeekQuery:!1,buffers:{"w:p":{text:"",cmds:"",fInsertedText:!1},"w:tr":{text:"",cmds:"",fInsertedText:!1},"w:tc":{text:"",cmds:"",fInsertedText:!1}},imageAndShapeIdIncrement:E,images:{},linkId:0,links:{},htmlId:0,htmls:{},vars:{},loops:[],fJump:!1,shorthands:{},options:t,pIfCheckMap:new Map,trIfCheckMap:new Map}}async function extractQuery(t,E){const r=newContext(E);r.fSeekQuery=!0;let v=t;for(;;){if(v._children.length)v=v._children[0];else{let N=!1;for(;v._parent!=null;){const k=v._parent,x=_$1(v);if(x){v=x,N=!0;break}v=k}if(!N)break}if(!v)break;const T=v._parent;if(v._fTextNode&&T&&!T._fTextNode&&T._tag==="w:t"&&await U(null,v,r,H$1),r.query!=null)break}return r.query}async function produceJsReport(t,E,r){return walkTemplate(t,E,r,H$1)}function findHighestImgId(t){const E=[],r=v=>{for(const T of v._children){const N=T._fTextNode?null:T._tag;if(N!=null){if(N==="wp:docPr"){if(T._fTextNode)continue;const k=T._attrs.id;if(typeof k!="string")continue;const x=Number.parseInt(k,10);Number.isSafeInteger(x)&&E.push(x)}T._children.length>0&&r(T)}}};return r(t),E.length>0?Math.max(...E):0}const b=t=>JSON.stringify(t._fTextNode?{_ifName:t._ifName,_fTextNode:t._fTextNode,_text:t==null?void 0:t._text}:{_ifName:t._ifName,_fTextNode:t._fTextNode,_tag:t==null?void 0:t._tag,_attrs:t==null?void 0:t._attrs}),B$1=t=>{let E=t._parent,r=null;for(;E!=null&&r==null;){if((E._fTextNode?null:E._tag)==="w:p"){const v=E._parent!=null?E._parent._parent:null;v!=null&&!v._fTextNode&&v._tag==="w:tr"?r=v:r=E}E=E._parent}return r};async function walkTemplate(t,E,r,v){var T;const N=i(E);let k=E,x=N,ce,ue=0;const Z=[];let $e=0;const Ee=((T=r.options)==null?void 0:T.maximumWalkingDepth)||1e6;for(;;){const ge=s(r);let ye=null;if(r.fJump){if(!ge)throw new InternalError("jumping while curLoop is null");logger.debug(`Jumping to level ${ge.refNodeLevel}...`,b(ge.refNode)),ue=r.level-ge.refNodeLevel,k=ge.refNode,r.level=ge.refNodeLevel,r.fJump=!1,ce="JUMP"}else if(k._children.length&&ce!=="UP")k=k._children[0],r.level+=1,ce="DOWN";else if(ye=_$1(k))k=ye,ce="SIDE";else{const Te=k._parent;if(Te==null)break;if($e>Ee)throw logger.debug(`=== parent is still not null after ${$e} loops, something must be wrong ...`,b(Te)),new InternalError("infinite loop or massive dataset detected. Please review and try again");k=Te,r.level-=1,ce="UP"}if(logger.debug(`Next node [${ce}, level ${r.level}]`,b(k)),ce!=="DOWN"){const Te=x._fTextNode?null:x._tag;let Se=!1;if((Te==="w:p"||Te==="w:tbl"||Te==="w:tr"||Te==="w:tc")&&f$1(r))Se=!0;else if(Te==="w:p"||Te==="w:tr"||Te==="w:tc"){const Ie=r.buffers[Te];Se=Ie.text===""&&Ie.cmds!==""&&!Ie.fInsertedText,Te==="w:tr"&&Se&&(Se=k._children.filter(Ae=>!Ae._fTextNode&&Ae._tag==="w:tr").length!==1),Te==="w:tc"&&Se&&(Se=!(x._children.filter(Ae=>!Ae._fTextNode&&Ae._tag==="w:tbl").length>0))}Se&&x._parent!=null&&x._parent._children.pop()}if(ce==="UP"){f$1(r)&&ge&&k===ge.refNode._parent&&(ge.refNode=k,ge.refNodeLevel-=1,logger.debug(`Updated loop '${ge.varName}' refNode: `+b(k)));const Te=x._parent;if(Te==null)throw new InternalError("node parent is null");if(x=Te,r.pendingImageNode&&!x._fTextNode&&x._tag==="w:t"){const Se=r.pendingImageNode.image,Ie=r.pendingImageNode.caption,Ae=x._parent;Ae&&(Se._parent=Ae,Ae._children.pop(),Ae._children.push(Se),Ie&&Ae._children.push(...Ie),r.buffers["w:p"].fInsertedText=!0,r.buffers["w:tr"].fInsertedText=!0,r.buffers["w:tc"].fInsertedText=!0),delete r.pendingImageNode}if(r.pendingLinkNode&&!x._fTextNode&&x._tag==="w:r"){const Se=r.pendingLinkNode,Ie=x._parent;Ie&&(Se._parent=Ie,Ie._children.pop(),Ie._children.push(Se),r.buffers["w:p"].fInsertedText=!0,r.buffers["w:tr"].fInsertedText=!0,r.buffers["w:tc"].fInsertedText=!0),delete r.pendingLinkNode}if(r.pendingHtmlNode&&!x._fTextNode&&x._tag==="w:p"){const Se=r.pendingHtmlNode,Ie=x._parent;Ie&&(Se._parent=Ie,Ie._children.pop(),Ie._children.push(Se),r.buffers["w:p"].fInsertedText=!0,r.buffers["w:tr"].fInsertedText=!0,r.buffers["w:tc"].fInsertedText=!0),delete r.pendingHtmlNode}!x._fTextNode&&x._tag==="w:tc"&&!x._children.filter(Se=>!Se._fTextNode&&(Se._tag==="w:p"||Se._tag==="w:altChunk")).length&&x._children.push({_parent:x,_children:[],_fTextNode:!1,_tag:"w:p",_attrs:{}}),!x._fTextNode&&x._tag==="w:rPr"&&(r.textRunPropsNode=x),!k._fTextNode&&k._tag==="w:r"&&delete r.textRunPropsNode}if(ce==="DOWN"||ce==="SIDE"){if(ce==="SIDE"){if(x._parent==null)throw new InternalError("node parent is null");x=x._parent}const Te=k._fTextNode?null:k._tag;(Te==="w:p"||Te==="w:tr"||Te==="w:tc")&&(r.buffers[Te]={text:"",cmds:"",fInsertedText:!1});const Se=i(k);Se._parent=x,x._children.push(Se);const Ie=Se._tag;!f$1(r)&&(Ie==="wp:docPr"||Ie==="v:shape")&&(logger.debug("detected a - ",b(Se)),pe$1(Se,r));const Ae=k._parent;if(k._fTextNode&&Ae&&!Ae._fTextNode&&Ae._tag==="w:t"){const Re=await U(t,k,r,v);typeof Re=="string"?(Se._text=Re,logger.debug("Inserted command result string into node. Updated node: "+b(Se))):Z.push(...Re)}x=Se}if(ce==="JUMP")for(;ue>0;){if(x._parent==null)throw new InternalError("node parent is null");x=x._parent,ue-=1}$e++}if(r.gCntIf!==r.gCntEndIf){const ge=new IncompleteConditionalStatementError;if(r.options.failFast)throw ge;Z.push(ge)}if(r.loops.filter(ge=>!ge.isIf).length>0){const ge=r.loops[r.loops.length-1],ye=new UnterminatedForLoopError(ge);if(r.options.failFast)throw ye;Z.push(ye)}return Z.length>0?{status:"errors",errors:Z}:{status:"success",report:N,images:r.images,links:r.links,htmls:r.htmls}}const U=async(t,E,r,v)=>{const{cmdDelimiter:T,failFast:N}=r.options,k=E._text;if(k==null||k==="")return"";const x=k.split(T[0]).map(Z=>Z.split(T[1])).reduce((Z,$e)=>Z.concat($e));let ce="";const ue=[];for(let Z=0;Z<x.length;Z++){Z>0&&R(T[0],r,{fCmd:!0});const $e=x[Z];if(r.fCmd?r.cmd+=$e:f$1(r)||(ce+=$e),R($e,r,{fCmd:r.fCmd}),Z<x.length-1){if(r.fCmd){const Ee=await v(t,E,r);if(Ee!=null)if(typeof Ee=="string")ce+=Ee,R(Ee,r,{fCmd:!1,fInsertedText:!0});else{if(N)throw Ee;ue.push(Ee)}}r.fCmd=!r.fCmd}}return ue.length>0?ue:ce},H$1=async(t,E,r)=>{const v=getCommand(r.cmd,r.shorthands,r.options.fixSmartQuotes);r.cmd="";try{const{cmdName:T,cmdRest:N}=splitCommand(v);if(T!=="CMD_NODE"&&logger.debug(`Processing cmd: ${v}`),r.fSeekQuery){T==="QUERY"&&(r.query=N);return}if(!(T==="QUERY"||T==="CMD_NODE"))if(T==="ALIAS"){const k=/^(\S+)\s+(.+)/.exec(N);if(!k)throw new InvalidCommandError("Invalid ALIAS command",v);const x=k[1],ce=k[2];r.shorthands[x]=ce,logger.debug(`Defined alias '${x}' for: ${ce}`)}else if(T==="FOR"||T==="IF")await re(t,E,r,v,T,N);else if(T==="END-FOR"||T==="END-IF")oe(E,r,v,T,N);else if(T==="INS"){if(!f$1(r)){let k=await runUserJsAndGetRaw(t,N,r);if(k==null||r.options.objectToString&&typeof k=="object"&&!Array.isArray(k)&&typeof k.toString=="function"&&(k=k.toString(),k==null))return"";if(typeof k=="object"&&!Array.isArray(k)){const ce=new ObjectCommandResultError(N,k);if(r.options.errorHandler!=null)k=await r.options.errorHandler(ce,N);else throw ce}let x=String(k);if(r.options.processLineBreaks){const{literalXmlDelimiter:ce}=r.options;if(r.options.processLineBreaksAsNewText){const ue=x.split(`
`),Z=`${ce}<w:br/>${ce}`,$e=`${ce}</w:t>${ce}`,Ee=`${ce}<w:t xml:space="preserve">${ce}`;x=ue.join(`${$e}${Z}${Ee}`)}else x=x.replace(/\n/g,`${ce}<w:br/>${ce}`)}return x}}else if(T==="EXEC")f$1(r)||await runUserJsAndGetRaw(t,N,r);else if(T==="IMAGE"){if(!f$1(r)){const k=await runUserJsAndGetRaw(t,N,r);if(k!=null)try{se(r,k)}catch(x){throw isError(x)?new ImageError(x,v):x}}}else if(T==="LINK"){if(!f$1(r)){const k=await runUserJsAndGetRaw(t,N,r);k!=null&&await le(r,k)}}else if(T==="HTML"){if(!f$1(r)){const k=await runUserJsAndGetRaw(t,N,r);k!=null&&await fe(r,k)}}else throw new CommandSyntaxError(v);return}catch(T){if(!isError(T))throw T;return r.options.errorHandler!=null?r.options.errorHandler(T):T}},te$1=BUILT_IN_COMMANDS.map(t=>new RegExp(`^${t}\\b`)),ne=t=>!te$1.some(E=>E.test(t.toUpperCase()));function getCommand(t,E,r){let v=t.trim();if(v[0]==="*"){const T=v.slice(1).trim();if(!E[T])throw new InvalidCommandError("Unknown alias",v);v=E[T]}else v[0]==="="?v=`INS ${v.slice(1).trim()}`:v[0]==="!"?v=`EXEC ${v.slice(1).trim()}`:ne(v)&&(v=`INS ${v.trim()}`);return r&&(v=v.replace(/[\u201C\u201D\u201E]/g,'"').replace(/[\u2018\u2019\u201A]/g,"'")),v.trim()}function splitCommand(t){const E=/^(\S+)\s*/.exec(t);let r,v="";return E!=null&&(r=E[1].toUpperCase(),v=t.slice(r.length).trim()),{cmdName:r,cmdRest:v}}const re=async(t,E,r,v,T,N)=>{const k=T==="IF";let x=null,ce;if(k)E._ifName||(E._ifName=`__if_${r.gCntIf}`,r.gCntIf+=1),ce=E._ifName;else{if(x=/^(\S+)\s+IN\s+(.+)/i.exec(N),!x)throw new InvalidCommandError("Invalid FOR command",v);ce=x[1]}const ue=s(r);if(!(ue&&ue.varName===ce)){if(k){const ge=B$1(E),ye=ge!=null?ge._fTextNode?null:ge._tag:null;if(ge!=null){if(ye==="w:p"){if(r.pIfCheckMap.has(ge)&&r.pIfCheckMap.get(ge)!==v)throw new InvalidCommandError("Invalid IF command nested into another IF command on the same line",v);r.pIfCheckMap.set(ge,v)}else if(ye==="w:tr"){if(r.trIfCheckMap.has(ge)&&r.trIfCheckMap.get(ge)!==v)throw new InvalidCommandError("Invalid IF command nested into another IF command on the same table row",v);r.trIfCheckMap.set(ge,v)}}}const Z=r.loops.length-1,$e=Z>=0&&r.loops[Z].idx===-1;let Ee;if($e)Ee=[];else if(k)Ee=await runUserJsAndGetRaw(t,N,r)?[1]:[];else{if(!x)throw new InvalidCommandError("Invalid FOR command",v);if(Ee=await runUserJsAndGetRaw(t,x[2],r),!Array.isArray(Ee))throw new InvalidCommandError("Invalid FOR command (can only iterate over Array)",v)}r.loops.push({refNode:E,refNodeLevel:r.level,varName:ce,loopOver:Ee,isIf:k,idx:-1})}h$1(r.loops)},oe=(t,E,r,v,T)=>{const N=v==="END-IF",k=s(E);if(!k)throw new InvalidCommandError(`Unexpected ${v} outside of ${N?"IF statement":"FOR loop"} context`,r);const x=B$1(t),ce=x!=null?x._fTextNode?null:x._tag:null;ce==="w:p"?E.pIfCheckMap.delete(x):ce==="w:tr"&&E.trIfCheckMap.delete(x),N&&!t._ifName&&(t._ifName=k.varName,E.gCntEndIf+=1);const ue=N?t._ifName:T;if(k.varName!==ue){if(E.loops.find(Ee=>Ee.varName===ue)==null){logger.debug(`Ignoring ${r} (${ue}, but we're expecting ${k.varName})`);return}throw new InvalidCommandError("Invalid command",r)}const Z=k.idx+1,$e=k.loopOver[Z];$e!=null?(E.vars[ue]=$e,E.fJump=!0,k.idx=Z):E.loops.pop()},J=(t,E)=>{P(E),t.imageAndShapeIdIncrement+=1;const r=`img${String(t.imageAndShapeIdIncrement)}`;return t.images[r]=E,r};function P(t){if(!(t.data instanceof Uint8Array||t.data instanceof ArrayBuffer||typeof t.data=="string"))throw new Error("image .data property needs to be provided as Uint8Array (e.g. Buffer), ArrayBuffer, or as a base64-encoded string");if(!ImageExtensions.includes(t.extension))throw new Error(`An extension (one of ${ImageExtensions}) needs to be provided when providing an image or a thumbnail.`)}function ie(t){if(!Number.isFinite(t.width))throw new Error(`invalid image width: ${t.width} (in cm)`);if(!Number.isFinite(t.height))throw new Error(`invalid image height: ${t.height} (in cm)`);P(t),t.thumbnail&&P(t.thumbnail)}const se=(t,E)=>{var r;ie(E);const v=(E.width*36e4).toFixed(0),T=(E.height*36e4).toFixed(0);let N=J(t,ae(E));const k=String(t.imageAndShapeIdIncrement),x=E.alt||"desc",ce=c$1,ue=[];ue.push(ce("a:ext",{uri:"{28A0092B-C50C-407E-A947-70E740481C1C}"},[ce("a14:useLocalDpi",{"xmlns:a14":"http://schemas.microsoft.com/office/drawing/2010/main",val:"0"})]));const Z=E.rotation?(E.rotation*6e4).toString():void 0;if(t.images[N].extension===".svg"){const ge=(r=E.thumbnail)!=null?r:{data:"bm90aGluZwo=",extension:".png"},ye=J(t,ge);ue.push(ce("a:ext",{uri:"{96DAC541-7B7A-43D3-8B79-37D633B846F1}"},[ce("asvg:svgBlip",{"xmlns:asvg":"http://schemas.microsoft.com/office/drawing/2016/SVG/main","r:embed":N})])),N=ye}const $e=ce("pic:pic",{"xmlns:pic":"http://schemas.openxmlformats.org/drawingml/2006/picture"},[ce("pic:nvPicPr",{},[ce("pic:cNvPr",{id:"0",name:`Picture ${k}`,descr:x}),ce("pic:cNvPicPr",{},[ce("a:picLocks",{noChangeAspect:"1",noChangeArrowheads:"1"})])]),ce("pic:blipFill",{},[ce("a:blip",{"r:embed":N,cstate:"print"},[ce("a:extLst",{},ue)]),ce("a:srcRect"),ce("a:stretch",{},[ce("a:fillRect")])]),ce("pic:spPr",{bwMode:"auto"},[ce("a:xfrm",Z?{rot:Z}:{},[ce("a:off",{x:"0",y:"0"}),ce("a:ext",{cx:v,cy:T})]),ce("a:prstGeom",{prst:"rect"},[ce("a:avLst")]),ce("a:noFill"),ce("a:ln",{},[ce("a:noFill")])])]),Ee=ce("w:drawing",{},[ce("wp:inline",{distT:"0",distB:"0",distL:"0",distR:"0"},[ce("wp:extent",{cx:v,cy:T}),ce("wp:docPr",{id:k,name:`Picture ${k}`,descr:x}),ce("wp:cNvGraphicFramePr",{},[ce("a:graphicFrameLocks",{"xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main",noChangeAspect:"1"})]),ce("a:graphic",{"xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"},[ce("a:graphicData",{uri:"http://schemas.openxmlformats.org/drawingml/2006/picture"},[$e])])])]);t.pendingImageNode={image:Ee},E.caption&&(t.pendingImageNode.caption=[ce("w:br"),ce("w:t",{},[u(E.caption)])])};function ae(t){const{data:E,extension:r}=t;if(!r)throw new Error("If you return image `data`, make sure you return an extension as well!");return{extension:r,data:E}}const le=async(t,E)=>{const{url:r,label:v=r}=E;t.linkId+=1;const T=`link${String(t.linkId)}`;t.links[T]={url:r};const N=c$1,{textRunPropsNode:k}=t,x=N("w:hyperlink",{"r:id":T,"w:history":"1"},[N("w:r",{},[k||N("w:rPr",{},[N("w:u",{"w:val":"single"})]),N("w:t",{},[u(v)])])]);t.pendingLinkNode=x},fe=async(t,E)=>{t.htmlId+=1;const r=`html${String(t.htmlId)}`;t.htmls[r]=E;const v=c$1("w:altChunk",{"r:id":r});t.pendingHtmlNode=v},de=["w:p","w:tr","w:tc"],R=(t,E,r)=>{if(E.fSeekQuery)return;const{fCmd:v,fInsertedText:T}=r,N=v?"cmds":"text";de.forEach(k=>{const x=E.buffers[k];x[N]+=t,T&&(x.fInsertedText=!0)})};function pe$1(t,E){E.imageAndShapeIdIncrement+=1;const r=String(E.imageAndShapeIdIncrement);t._attrs=A($({},t._attrs),{id:`${r}`})}const z="+++",D="||",B="[Content_Types].xml",g="word",me=new RegExp(`${g}\\/[^\\/]+\\.xml`);async function parseTemplate(t){const E=await n$1(t),r=await readContentTypes(E),v=getMainDoc(r),T=`${g}/${v}`,N=await s$1(E,T);if(N==null)throw new TemplateParseError(`${v} could not be found`);logger.debug(`${T} file length: ${N.length}`),new Date().getTime();const k=await g$2(N);return new Date().getTime(),{jsTemplate:k,mainDocument:v,zip:E,contentTypes:r}}async function V(t,E,r){const v=[];t.forEach(async N=>{me.test(N)&&N!==`${g}/${E}`&&N.indexOf(`${g}/template`)!==0&&v.push(N)}),v.sort();const T=[];for(const N of v){const k=await s$1(t,N);if(k==null)throw new TemplateParseError(`${N} could not be read`);logger.debug(`${N} file length: ${k.length}`);const x=await g$2(k),ce=g$1(x,r.cmdDelimiter);T.push([ce,N])}return T}async function pe(t,E){const{template:r,data:v,queryVars:T}=t,N=t.literalXmlDelimiter||D,k={cmdDelimiter:te(t.cmdDelimiter),literalXmlDelimiter:N,processLineBreaks:t.processLineBreaks!=null?t.processLineBreaks:!0,noSandbox:t.noSandbox||!1,runJs:t.runJs,additionalJsContext:t.additionalJsContext||{},failFast:t.failFast==null?!0:t.failFast,rejectNullish:t.rejectNullish==null?!1:t.rejectNullish,objectToString:t.objectToString||!1,errorHandler:typeof t.errorHandler=="function"?t.errorHandler:null,fixSmartQuotes:t.fixSmartQuotes==null?!1:t.fixSmartQuotes,processLineBreaksAsNewText:t.processLineBreaksAsNewText==null?!1:t.processLineBreaksAsNewText,maximumWalkingDepth:t.maximumWalkingDepth},x={literalXmlDelimiter:N},{jsTemplate:ce,mainDocument:ue,zip:Z,contentTypes:$e}=await parseTemplate(r),Ee=g$1(ce,k.cmdDelimiter);let ge=null;if(typeof v=="function"){const ve=await extractQuery(Ee,k);ge=await v(ve,T)}else ge=v;const ye=await V(Z,ue,k),Te=Math.max(...ye.map(([ve,Ze])=>findHighestImgId(ve)),findHighestImgId(Ee));let Se=newContext(k,Te);const Ie=await produceJsReport(ge,Ee,Se);if(Ie.status==="errors")throw Ie.errors;const{report:Ae,images:Re,links:ke,htmls:De}=Ie;if(E==="JS")return Ae;const Le=m(Ae,x);if(E==="XML")return Le.toString("utf-8");o(Z,`${g}/${ue}`,Le);let Be=Object.keys(Re).length,Fe=Object.keys(De).length;await Y(Re,ue,Z),await K(ke,ue,Z),await ee(De,ue,Z);for(const[ve,Ze]of ye){Se=newContext(k,Se.imageAndShapeIdIncrement);const Oe=await produceJsReport(ge,ve,Se);if(Oe.status==="errors")throw Oe.errors;const{report:Me,images:Je,links:et,htmls:rt}=Oe,ot=m(Me,x);o(Z,Ze,ot),Be+=Object.keys(Je).length,Fe+=Object.keys(rt).length;const Ue=Ze.split("/"),at=Ue[Ue.length-1];await Y(Je,at,Z),await K(et,ue,Z),await ee(rt,ue,Z)}if(Be||Fe){const ve=(Oe,Me)=>{$e._children.filter(Je=>{var et;return!Je._fTextNode&&((et=Je._attrs.Extension)==null?void 0:et.toLowerCase())===(Oe==null?void 0:Oe.toLowerCase())}).length||p($e,c$1("Default",{Extension:Oe,ContentType:Me}))};Be&&(ve("png","image/png"),ve("jpg","image/jpeg"),ve("jpeg","image/jpeg"),ve("gif","image/gif"),ve("bmp","image/bmp"),ve("svg","image/svg+xml")),Fe&&ve("html","text/html");const Ze=m($e,x);o(Z,B,Ze)}return await p$1(Z)}async function listCommands(t,E){const r={cmdDelimiter:te(E),literalXmlDelimiter:D,processLineBreaks:!0,noSandbox:!1,additionalJsContext:{},failFast:!1,rejectNullish:!1,objectToString:!1,errorHandler:null,fixSmartQuotes:!1,processLineBreaksAsNewText:!1},{jsTemplate:v,mainDocument:T,zip:N}=await parseTemplate(t),k=await V(N,T,r),x=[v,...k.map(([ue,Z])=>ue)],ce=[];for(const ue of x){const Z=g$1(ue,r.cmdDelimiter),$e=newContext(r);await walkTemplate(void 0,Z,$e,async(Ee,ge,ye)=>{const Te=getCommand(ye.cmd,ye.shorthands,ye.options.fixSmartQuotes);ye.cmd="";const{cmdName:Se,cmdRest:Ie}=splitCommand(Te),Ae=Se;Ae!=null&&Ae!=="CMD_NODE"&&ce.push({raw:Te,type:Ae,code:Ie})})}return ce}async function getMetadata(t){const E="docProps/app.xml",r="docProps/core.xml",v=await n$1(t),T=await F(v,E),N=await F(v,r);function k(ue){if(ue._children.length===0)return;const Z=ue._children[0];if(Z._fTextNode)return Z._text;throw new Error("Not a text node")}function x(ue,Z){for(const $e of ue._children)if(!$e._fTextNode&&$e._tag===Z)return k($e)}const ce=ue=>{const Z=Number(ue);if(Number.isFinite(Z))return Z};return{pages:ce(x(T,"Pages")),words:ce(x(T,"Words")),characters:ce(x(T,"Characters")),lines:ce(x(T,"Lines")),paragraphs:ce(x(T,"Paragraphs")),company:x(T,"Company"),template:x(T,"Template"),title:x(N,"dc:title"),subject:x(N,"dc:subject"),creator:x(N,"dc:creator"),description:x(N,"dc:description"),lastModifiedBy:x(N,"cp:lastModifiedBy"),revision:x(N,"cp:revision"),lastPrinted:x(N,"cp:lastPrinted"),created:x(N,"dcterms:created"),modified:x(N,"dcterms:modified"),category:x(N,"cp:category")}}async function F(t,E){const r=await s$1(t,E);if(r==null)throw new TemplateParseError(`${E} could not be read`);const v=await g$2(r);if(v._fTextNode)throw new TemplateParseError(`${E} is a text node when parsed`);return v}async function readContentTypes(t){return await F(t,B)}function getMainDoc(t){const E=["application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","application/vnd.ms-word.document.macroEnabled.main+xml"];for(const r of t._children)if(!r._fTextNode&&r._attrs.ContentType!=null&&E.includes(r._attrs.ContentType)){const v=r._attrs.PartName;if(v)return v.replace("/word/","")}throw new TemplateParseError(`Could not find main document (e.g. document.xml) in ${B}`)}const Y=async(t,E,r)=>{const v=Object.keys(t);if(!v.length)return;const T=`${g}/_rels/${E}.rels`,N=await H(r,T);for(const x of v){const{extension:ce,data:ue}=t[x],Z=`template_${E}_${x}${ce}`,$e=`${g}/media/${Z}`;typeof ue=="string"?r.file($e,ue,{base64:!0}):r.file($e,ue,{binary:!0}),p(N,c$1("Relationship",{Id:x,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`media/${Z}`}))}const k=m(N,{literalXmlDelimiter:D});o(r,T,k)},K=async(t,E,r)=>{const v=Object.keys(t);if(v.length){const T=`${g}/_rels/${E}.rels`,N=await H(r,T);for(const x of v){const{url:ce}=t[x];p(N,c$1("Relationship",{Id:x,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Target:ce,TargetMode:"External"}))}const k=m(N,{literalXmlDelimiter:D});o(r,T,k)}},ee=async(t,E,r)=>{const v=Object.keys(t);if(v.length){const T=`${g}/_rels/${E}.rels`,N=await H(r,T);for(const x of v){const ce=t[x],ue=`template_${E.replace(/\./g,"_")}_${x}.html`,Z=`${g}/${ue}`;o(r,Z,Buffer.from(ce)),p(N,c$1("Relationship",{Id:x,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/aFChunk",Target:`${ue}`}))}const k=m(N,{literalXmlDelimiter:D});o(r,T,k)}},H=async(t,E)=>{let r=await s$1(t,E);return r||(r=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
        <Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">
        </Relationships>`),g$2(r)},te=t=>t?typeof t=="string"?[t,t]:t:[z,z];export{CommandExecutionError,CommandSyntaxError,ImageError,IncompleteConditionalStatementError,InternalError,InvalidCommandError,NullishCommandResultError,ObjectCommandResultError,TemplateParseError,UnterminatedForLoopError,pe as createReport,getMetadata,isError,listCommands};
//# sourceMappingURL=browser.js.map
